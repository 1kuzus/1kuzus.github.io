(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[982],{3512:function(e,t,n){Promise.resolve().then(n.bind(n,2623))},2623:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Blog}});var r=n(7437),A=n(2727);function Blog(e){let{title:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.Z.Title,{children:t}),(0,r.jsx)(A.Z.P,{children:"论文@A Closer Look at Spatiotemporal Convolutions for Action Recognition[https://arxiv.org/pdf/1711.11248.pdf]@讨论了几种用于行为识别的时空卷积网络。--- 文中提出了R(2+1)D网络，即将R3D网络中的3D卷积拆分成2D空间卷积+1D时间卷积。"}),(0,r.jsx)(A.Z.P,{children:"PyTorch版本复现代码来自于Github仓库 @Github: R2Plus1D-PyTorch[https://github.com/irhum/R2Plus1D-PyTorch]@"}),(0,r.jsx)(A.Z.H1,{children:"(2+1)D卷积"}),(0,r.jsx)(A.Z.P,{children:"普通3D卷积的核大小为$(C_i,C_o,K_t,K_w,K_h)$，$C_i,C_o$为输入通道数、$K_t,K_w,K_h$是3D卷积核的尺寸。\\n R(2+1)D网络最核心的改动就是将普通的`Conv3d`替换为`SpatioTemporalConv`卷积。"}),(0,r.jsx)(A.Z.Image,{src:n(9699),width:"100%",invertInDarkTheme:!0}),(0,r.jsx)(A.Z.P,{noMarginBottom:!0,children:"`SpatioTemporalConv`卷积从外部看与`Conv3d`相同，均有`5`个超参数，区别在于其内部的结构："}),(0,r.jsx)(A.Z.Uli,{children:"大小为$(C_i,C,1,K_w,K_h)$的`Conv3d`"}),(0,r.jsx)(A.Z.Uli,{children:"`BatchNorm`+`ReLU`"}),(0,r.jsx)(A.Z.Uli,{children:"大小为$(C,C_o,K_t,1,1)$的`Conv3d`"}),(0,r.jsx)(A.Z.P,{withMarginTop:!0,children:"如果二者作用于相同的输出，得到的结果`shape`是一样的："}),(0,r.jsx)(A.Z.CodeBlock,{language:"python",code:"\n                import torch\n                from r2plus1d.module import SpatioTemporalConv\n\n                video_3d=torch.rand(8,3,60,32,32) #(batch*channels*frames*w*h)\n                conv3d=torch.nn.Conv3d(in_channels=3,out_channels=16,kernel_size=[7,5,5])\n                spconv=SpatioTemporalConv(in_channels=3,out_channels=16,kernel_size=[7,5,5])\n\n                output1=conv3d(video_3d)\n                output2=spconv(video_3d)\n\n                print(output1.shape) #torch.Size([8, 16, 54, 28, 28])\n                print(output2.shape) #torch.Size([8, 16, 54, 28, 28])\n                "}),(0,r.jsx)(A.Z.P,{children:"注意到拆分成两次卷积后，会出现一个中间通道数$C$。论文中给出估计$C$值的公式是："}),(0,r.jsx)(A.Z.Formula,{text:"C=C_i C_oK_tK_wK_h/(C_iK_wK_h+C_oK_t)"}),(0,r.jsx)(A.Z.P,{noMarginBottom:!0,children:"这样做的目的是使得R(2+1)D卷积的参数量和R3D相近。也就是说，拆分时间和空间两次卷积并不是为了减少计算量。--- 文中给出了使用R(2+1)D卷积两个优点："}),(0,r.jsx)(A.Z.Oli,{children:"增加了网络非线性层的层数"}),(0,r.jsx)(A.Z.Oli,{children:"优化更容易（实验结果：R(2+1)D网络的训练和测试误差都更小）"}),(0,r.jsx)(A.Z.Image,{src:n(2616),width:"600",invertInDarkTheme:!0})]})}},9708:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return CodeBlock}});var r=n(7437),A=n(2265),i=n(2686),l=n.n(i);function CodeBlock(e){let t=(0,A.useRef)(),{language:n,code:i,highlightLines:o}=e,c=i.split("\n").map(e=>e.trimRight());c[0]||(c=c.slice(1));let a=c[0].length-c[0].trimStart().length;c=c.map(e=>e.slice(a));let s=o?o.split(",").map(e=>e.includes("-")?[e.split("-")[0]-1,+e.split("-")[1]]:[e-1,+e]):[],u="linear-gradient(180deg"+s.map(e=>{let[t,n]=e;return", transparent ".concat(24*t,"px, ")+"var(--bg-transparent-golden) ".concat(24*t,"px ").concat(24*n,"px, ")+"transparent ".concat(24*n,"px")}).join("")+")";return(0,A.useLayoutEffect)(()=>{l().highlightElement(t.current)},[i]),(0,r.jsx)("div",{className:"x-codeblock",children:(0,r.jsx)("pre",{style:{background:o?u:null},children:(0,r.jsx)("code",{className:n&&"lang-".concat(n),ref:t,children:c.join("\n")})})})}n(8978)},848:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Formula}});var r=n(7437),A=n(2265),i=n(3236);function Formula(e){let t=(0,A.useRef)(),{text:n=""}=e;return(0,A.useLayoutEffect)(()=>{i.Z.render(n,t.current,{output:"html",strict:!1})},[n]),(0,r.jsx)("div",{className:"x-formula",ref:t})}n(8704)},8411:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Image}});var r=n(7437);n(5612);var A=n(6691),i=n.n(A);function Image(e){let{invertInDarkTheme:t,src:n,width:A,...l}=e;return(0,r.jsx)("div",{className:"x-image-wrapper".concat(t?" x-image-invert":""),children:(0,r.jsx)(i(),{alt:"img",src:n,style:{width:A}})})}},8275:function(e,t,n){"use strict";n.r(t),n.d(t,{Oli:function(){return Oli},Uli:function(){return Uli}});var r=n(7437),A=n(9226),i=n(2229);function isStringOrStringArray(e){return"string"==typeof e||!!Array.isArray(e)&&e.every(e=>"string"==typeof e)}function Uli(e){let{children:t}=e;return(0,r.jsxs)("div",{className:"x-uli",children:[(0,r.jsx)("div",{className:"x-uli-marker",children:(0,r.jsx)("div",{className:"x-uli-marker-dot"})}),(0,r.jsx)("div",{className:"x-uli-content-wrapper",children:isStringOrStringArray(t)?(0,r.jsx)(i.Z,{children:t}):t})]})}function Oli(e){let{reset:t,children:n}=e,{addOliIndex:l,resetOliIndex:o}=(0,A.useGlobalContext)();return(0,r.jsxs)("div",{className:"x-oli",children:[(0,r.jsx)("div",{className:"x-oli-number",children:(void 0!==t?o(+t):l())+"."}),(0,r.jsx)("div",{className:"x-oli-content-wrapper",children:isStringOrStringArray(n)?(0,r.jsx)(i.Z,{children:n}):n})]})}n(340)},2229:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(7437),A=n(3236);function P(e){let{withMarginTop:t=!1,noMarginBottom:n=!1,children:i=""}=e,l=Array.isArray(i)?i.join(""):i;return l=l.replace(/--- /g,"").replace(/\\\\/g,"&#92;").replace(/\\`/g,"&#96;").replace(/\\\*/g,"&#42;").replace(/\\@/g,"&#64;").replace(/\\\$/g,"&#36;").replace(/\\n/g,"<br/>").replace(/`(.*?)`/g,'<code class="x-inline-highlight">$1</code>').replace(/\*(.*?)\*/g,'<span class="x-inline-strong">$1</span>').replace(/@(.*?)\[(.*?)\]@/g,'<a href="$2" target="_blank" rel="noreferrer" class="x-inline-link">$1</a>').replace(/\$(.*?)\$/g,(e,t)=>A.Z.renderToString(t,{output:"html",strict:!1})),(0,r.jsx)("p",{className:"x-p".concat(t?" with-margin-top":"").concat(n?" no-margin-bottom":""),dangerouslySetInnerHTML:{__html:l}})}n(7725)},4484:function(e,t,n){"use strict";n.r(t),n.d(t,{Br:function(){return Br},Divider:function(){return Divider},H1:function(){return H1},H2:function(){return H2},H3:function(){return H3},Title:function(){return Title}});var r=n(7437),A=n(2265),i=n(9226);function Title(e){let{children:t}=e;return(0,A.useLayoutEffect)(()=>{document.title=t},[t]),(0,r.jsx)("h1",{className:"x-title",children:t})}function H1(e){let{href:t,excludeFromContents:n,children:l}=e,o=(0,A.useRef)(),{setTitleNodeRefs:c,removeTitleNodeRefs:a}=(0,i.useGlobalContext)();return(0,A.useLayoutEffect)(()=>{if(!n)return c(e=>[...e,o]),()=>a(o)},[l,n]),(0,r.jsx)("h2",{className:"x-h1",ref:o,children:t?(0,r.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:l}):l})}function H2(e){let{href:t,excludeFromContents:n,children:l}=e,o=(0,A.useRef)(),{setTitleNodeRefs:c,removeTitleNodeRefs:a}=(0,i.useGlobalContext)();return(0,A.useLayoutEffect)(()=>{if(!n)return c(e=>[...e,o]),()=>a(o)},[l,n]),(0,r.jsx)("h3",{className:"x-h2",ref:o,children:t?(0,r.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:l}):l})}function H3(e){let{href:t,children:n}=e;return(0,r.jsx)("h4",{className:"x-h3",children:t?(0,r.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:n}):n})}function Br(){return(0,r.jsx)("div",{className:"x-br"})}function Divider(){return(0,r.jsx)("div",{className:"x-divider"})}n(5533)},2727:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(4484),A=n(9708),i=n(7437);n(8875);var l=n(848);n(6301);var o=n(8411),c=n(8275),a=n(2229);n(8046);let s={...r,CodeBlock:A.default,FlexRow:function(e){let{children:t,width:n,gap:r,justifyContent:A,alignItems:l,flex1:o}=e;return(0,i.jsx)("div",{className:"x-flexrow".concat(o?" flex1":""),style:{width:n,gap:r,justifyContent:A,alignItems:l},children:t})},Formula:l.default,HighlightBlock:function(e){let{children:t,bgcolor:n="golden"}=e;return(0,i.jsx)("div",{className:"x-highlightblock".concat(" highlight-background-"+n),children:t})},Image:o.default,Uli:c.Uli,Oli:c.Oli,P:a.Z,Table:function(e){let{fromText:t,children:n}=e;if(t){let e=t.trim().split("\n");return(0,i.jsx)("table",{className:"x-table",children:(0,i.jsx)("tbody",{children:e.map((e,t)=>(0,i.jsx)("tr",{children:e.trim().split("|").map((e,n)=>t?(0,i.jsx)("td",{children:e},n):(0,i.jsx)("th",{children:e},n))},t))})})}return(0,i.jsx)("table",{className:"x-table",children:(0,i.jsx)("tbody",{children:n})})}};var u=s},9226:function(e,t,n){"use strict";n.r(t),n.d(t,{GlobalProvider:function(){return GlobalProvider},useGlobalContext:function(){return useGlobalContext}});var r=n(7437),A=n(2265);let i=(0,A.createContext)(),useGlobalContext=()=>(0,A.useContext)(i),GlobalProvider=e=>{let{children:t}=e,[n,l]=(0,A.useState)(!1),[o,c]=(0,A.useState)([]),a=(0,A.useRef)(0),s={showSidebar:n,setShowSidebar:l,setTitleNodeRefs:c,removeTitleNodeRefs:e=>{c(t=>t.filter(t=>t!==e))},titleNodes:o.map(e=>e.current).sort((e,t)=>e.offsetTop-t.offsetTop),addOliIndex:()=>(a.current+=1,a.current),resetOliIndex:e=>(a.current=e,e)};return(0,r.jsx)(i.Provider,{value:s,children:t})}},8978:function(){},8875:function(){},8704:function(){},6301:function(){},5612:function(){},340:function(){},7725:function(){},8046:function(){},5533:function(){},9699:function(e,t,n){"use strict";n.r(t),t.default={src:"/_next/static/media/fig1.3f7641a7.jpg",height:461,width:1032,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAQACAMBIgACEQEDEQH/xAAnAAEBAAAAAAAAAAAAAAAAAAAABwEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAAsIP/xAAXEAADAQAAAAAAAAAAAAAAAAAAAkFy/9oACAEBAAE/AFmj/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAgEBPwB//8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAwEBPwB//9k=",blurWidth:8,blurHeight:4}},2616:function(e,t,n){"use strict";n.r(t),t.default={src:"/_next/static/media/fig2.58f94b58.jpg",height:306,width:710,blurDataURL:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAMACAMBIgACEQEDEQH/xAAnAAEBAAAAAAAAAAAAAAAAAAAABwEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAAroP/xAAYEAACAwAAAAAAAAAAAAAAAAAAAgEhcf/aAAgBAQABPwBli9P/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAECAQE/AH//xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDAQE/AH//2Q==",blurWidth:8,blurHeight:3}}},function(e){e.O(0,[954,202,971,472,744],function(){return e(e.s=3512)}),_N_E=e.O()}]);