<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><script async src="https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-45BYSZ6WPY")</script><title>铃木的网络日记</title><script defer="defer" src="/static/js/main.48aae67c.js"></script><link href="/static/css/main.39d68e71.css" rel="stylesheet"></head><body><noscript><div><h1>CSS实现auto高度的过渡动画</h1><h2>问题描述</h2><p>下面是一个常见的效果，当鼠标悬浮时展开显示内容，离开时自动收回。</p><div><div><h4>html</h4><div>[CODEBLOCK]</div></div><div><h4>css</h4><div>[CODEBLOCK]</div></div><div id="bpbmq-wrapper1"><h4>hover me!</h4><div id="bpbmq-content1"><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p></div></div></div><p>由于通常不知道content中具体内容所占的高度，因此常用height: auto;设置高度。上面的示例可以良好的实现要求，问题出现在当我们需要为这个高度的变化添加过渡动画时，会发现transition:height 200ms;不起作用，这是因为auto并不是一个具体的高度数值。</p><h2>使用 max-height 解决</h2><p>一个常见方案是使用max-height控制。这样确实可以实现过渡动画效果，但并不是一个“完美”的动画：<br/>当过高的估计了content容器的最大可能高度时，鼠标移入时的动画会的变快，而移出时动画会有延迟。这是因为有一部分时间花在了max-height数值在content容器的真实高度和设定值之间的过渡上，而这部分过渡时间不会影响页面元素的样式。</p><div><div><h4>html</h4><div>[CODEBLOCK]</div></div><div><h4>css</h4><div>[CODEBLOCK]</div></div><div id="bpbmq-wrapper2"><h4>hover me!</h4><div id="bpbmq-content2"><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p></div></div></div><h2>更好的方案：使用 grid</h2><p>一个更完美的解决方案是使用网格布局：</p><div><div><h4>html</h4><div>[CODEBLOCK]</div></div><div><h4>css</h4><div>[CODEBLOCK]</div></div><div id="bpbmq-wrapper3"><h4>hover me!</h4><div id="bpbmq-content3"><div><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p></div></div></div></div><p>注意在html结构中，要为content再添加一层子元素div，display:grid;和grid-template-rows属性仍然设置给content，但此时overflow:hidden;要设置给content的子元素。</p><h3>讨论</h3><p>grid-row: 1 / span 2;这行代码看起来有些费解，因为毕竟只有一行子元素。它的作用是使子元素动画与父元素保持一致。<br/>我们把动画放慢，并且给content带上灰色背景，给content &gt; div带上红色背景，观察一下使用和不使用这个属性的区别：</p><div><div><h4>不使用</h4><div id="bpbmq-wrapper4"><h4>hover me!</h4><div id="bpbmq-content4"><div><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p></div></div></div></div><div><h4>使用</h4><div id="bpbmq-wrapper5"><h4>hover me!</h4><div id="bpbmq-content5"><div><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p><p>Hello, World!</p></div></div></div></div><div id="bpbmq-flex-spacer" /></div><p>这个问题是否发生似乎与浏览器的行为有关：在我测试时，使用Google Chrome和MicrosoftEdge时二者表现是不同的，但在Firefox中是相同的，即使不写grid-row: 1 / span 2;也不会引起这个问题。</p></div></noscript><div id="root"></div></body></html>