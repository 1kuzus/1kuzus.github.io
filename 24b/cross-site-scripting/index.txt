2:I[4500,["2202","static/chunks/2202-efd885462b29519a.js","244","static/chunks/244-6a2e2440764e9631.js","9362","static/chunks/app/(blogs)/24b/cross-site-scripting/page-19607f26f5b99ebd.js"],""]
3:I[4365,["2202","static/chunks/2202-efd885462b29519a.js","244","static/chunks/244-6a2e2440764e9631.js","9362","static/chunks/app/(blogs)/24b/cross-site-scripting/page-19607f26f5b99ebd.js"],""]
4:I[5613,[],""]
5:I[1778,[],""]
6:I[9806,["8792","static/chunks/8792-72030bcaaad25c8d.js","9135","static/chunks/app/(blogs)/layout-a6b1fa6340beea16.js"],""]
7:I[3393,["8792","static/chunks/8792-72030bcaaad25c8d.js","9135","static/chunks/app/(blogs)/layout-a6b1fa6340beea16.js"],""]
8:I[5694,["8792","static/chunks/8792-72030bcaaad25c8d.js","3185","static/chunks/app/layout-909fcb115c40cba0.js"],"GlobalProvider"]
9:I[397,["8792","static/chunks/8792-72030bcaaad25c8d.js","3185","static/chunks/app/layout-909fcb115c40cba0.js"],""]
0:["iLd67OoiQ4H2u-H-CAXSy",[[["",{"children":["(blogs)",{"children":["24b",{"children":["cross-site-scripting",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["(blogs)",{"children":["24b",{"children":["cross-site-scripting",{"children":["__PAGE__",{},["$L1",[["$","h1",null,{"className":"x-title","children":"Learn XSS"}],["$","h2",null,{"className":"x-h1","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"概念、分类与威胁模型"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<span class=\"x-inline-strong\">跨站脚本攻击</span><code class=\"x-inline-highlight\">(Cross-site Scripting, XSS)</code>是一种常见的网络安全漏洞，攻击者通过在网页中插入恶意脚本，使得用户在浏览网页时执行这些脚本，从而达到攻击的目的。"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"XSS攻击分为三种：反射型、存储型、DOM型。反射型和存储型是服务器端的漏洞，DOM型是客户端的漏洞。"}}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"Reflected XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"反射型<code class=\"x-inline-highlight\">(Reflected XSS)</code>/非持久型<code class=\"x-inline-highlight\">(Non-Persistent XSS)</code>：服务器直接从HTTP请求中读取数据，并且返回到HTTP响应中。"}}],["$","$L3",null,{"src":"reflected.jpg","width":"800px"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"攻击者发现有漏洞的站点，并构造恶意URL，例如URL中包含<code class=\"x-inline-highlight\">script</code>标签；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"诱骗用户打开链接；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"3."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"服务器没有过滤URL中的输入，但也没有存储，而是直接反射到响应中；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"4."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"网站使用URL中的数据生成页面的某一部分内容，并返回；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"5."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">script</code>标签被用户浏览器渲染，并执行了其中的恶意代码，例如将用户的cookie发送给攻击者。"}}]}]]}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"Stored XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"存储型<code class=\"x-inline-highlight\">(Stored XSS)</code>/持久型<code class=\"x-inline-highlight\">(Persistent XSS)</code>：网站将未正确过滤的数据储存在数据库中，例如论坛发言、用户评论等等。"}}],["$","$L3",null,{"src":"stored.jpg","width":"800px"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"攻击者发现服务器会直接保存未过滤的用户输入，因此向服务器注入一段代码，例如留下一条包含<code class=\"x-inline-highlight\">script</code>标签的评论；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"服务器未经过滤就保存了攻击者的输入数据；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"3."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"用户完全正常的访问网站；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"4."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"网站将内容返回，例如返回评论列表；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"5."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"评论中的<code class=\"x-inline-highlight\">script</code>标签被渲染时执行。"}}]}]]}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"DOM-Based XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"DOM型<code class=\"x-inline-highlight\">(DOM-Based XSS)</code>：DOM型XSS和反射型XSS很像，但DOM型XSS是由客户端的JavaScript代码处理数据时造成的漏洞，而不是服务器端。"}}],["$","$L3",null,{"src":"dom-based.jpg","width":"800px"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"攻击者发现有漏洞的站点，并构造恶意URL；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"诱骗用户打开链接；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"3."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"服务器正常返回数据；"}}]}]]}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"4."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"对请求参数的处理在前端完成，例如在前端通过<code class=\"x-inline-highlight\">innerHTML</code>了操作DOM，由此导致恶意代码被执行。"}}]}]]}],["$","h2",null,{"className":"x-h1","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"练习"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"下文给出的PortSwigger靶场中有关XSS的Lab目标是使得网站调用<code class=\"x-inline-highlight\">alert()</code>函数。"}}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"Reflected XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">PortSwigger Lab: Reflected XSS into HTML context with nothing encoded</a>"}}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"随便搜索点什么，看到内容会反射到<code class=\"x-inline-highlight\">h1</code>标题中。"}}]}]]}],["$","$L3",null,{"src":"1-1.jpg","width":"100%"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"尝试注入，搜索<code class=\"x-inline-highlight\">&#60;script&#62;alert(\"hello\");&#60;/script&#62;</code>，完成。"}}]}]]}],["$","$L3",null,{"src":"1-2.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"Stored XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">PortSwigger Lab: Stored XSS into HTML context with nothing encoded</a>"}}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"网站有评论系统，直接留言<code class=\"x-inline-highlight\">&#60;script&#62;alert(\"hello\");&#60;/script&#62;</code>。"}}]}]]}],["$","$L3",null,{"src":"2-1.jpg","width":"100%"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"完成，可以看到再次加载页面时，评论内容未经过滤直接加载到HTML文档。"}}]}]]}],["$","$L3",null,{"src":"2-2.jpg","width":"100%"}],["$","div",null,{"className":"x-divider"}],["$","$L3",null,{"src":"2-3.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"DOM-Based XSS"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">PortSwigger Lab: DOM XSS in <code class=\"x-inline-highlight\">document.write</code> sink using source <code class=\"x-inline-highlight\">location.search</code></a>"}}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"1."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"同样的搜索框，搜索<code class=\"x-inline-highlight\">&#60;script&#62;alert(\"hello\");&#60;/script&#62;</code>，发现这次被转义了。"}}]}]]}],["$","$L3",null,{"src":"3-1.jpg","width":"100%"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"2."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"仔细看一下文档代码，发现一个<code class=\"x-inline-highlight\">script</code>标签，类似用来追踪用户搜索行为的埋点。"}}]}]]}],["$","$L3",null,{"src":"3-2.jpg","width":"100%"}],["$","div",null,{"className":"x-oli","children":[["$","div",null,{"className":"x-oli-number","children":"3."}],["$","div",null,{"className":"x-oli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"注意到URL参数中的<code class=\"x-inline-highlight\">search</code>被直接写入<code class=\"x-inline-highlight\">img</code>标签，因此这次搜索<code class=\"x-inline-highlight\">\"/&#62;&#60;script&#62;alert(\"hello\");&#60;/script&#62;</code>，载荷最前面的<code class=\"x-inline-highlight\">\"/&#62;</code>先让<code class=\"x-inline-highlight\">img</code>闭合即可。"}}]}]]}],["$","$L3",null,{"src":"3-3.jpg","width":"100%"}],["$","h2",null,{"className":"x-h1","children":["$","$L2",null,{"excludeFromContents":"$undefined","children":"参考资料"}]}],["$","p",null,{"className":"x-p no-margin-bottom","dangerouslySetInnerHTML":{"__html":"本文的插图来源于："}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://www.bilibili.com/video/BV1rg411v7B8\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">Bilibili - XSS网络攻击 - 原理，类型和实践</a>"}}]}]]}]],null]]},["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children","24b","children","cross-site-scripting","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/233b7667e3c12808.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children","24b","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","div",null,{"id":"blog-layout","children":[["$","div",null,{"id":"main","children":["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]}],["$","$L6",null,{}],["$","$L7",null,{}]]}],null]]},[null,["$","html",null,{"lang":"zh-CN","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}],["$","script",null,{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"}],["$","script",null,{"async":true,"src":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag() {\n    dataLayer.push(arguments);\n}\ngtag('js', new Date());\ngtag('config', 'G-45BYSZ6WPY');\n"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"const a=z=>h.getItem(z),b=(y,z)=>h.setItem(y,z),c=(y,z)=>document.documentElement.setAttribute(y,z),d='theme',e='dark',f='light',g='class',h=localStorage;a(d)!==e&&a(d)!==f&&b(d,f);a(d)===e?c(g,e):c(g,f);"}}]]}],["$","body",null,{"children":["$","$L8",null,{"children":[["$","$L9",null,{}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"id":"notfound","children":[["$","img",null,{"alt":"img","src":"/images/cry.gif"}],["$","div",null,{"id":"notfound-404","children":"404"}],["$","div",null,{"id":"notfound-text","children":"Page Not Found"}]]}],"notFoundStyles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/eccd2e7a1149e571.css","precedence":"next","crossOrigin":""}]],"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/391c9d793ecdcfc9.css","precedence":"next","crossOrigin":""}]]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/a0c81e8012055d49.css","precedence":"next","crossOrigin":""}]],"$La"]]]]
a:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Learn XSS - 铃木的网络日记"}],["$","link","3",{"rel":"canonical","href":"https://1kuzus.github.io/24b/cross-site-scripting/"}]]
1:null
