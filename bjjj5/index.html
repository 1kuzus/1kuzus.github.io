<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><script async src="https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-45BYSZ6WPY")</script><title>Blogs</title><script defer="defer" src="/static/js/main.996405ef.js"></script><link href="/static/css/main.3be0f9bd.css" rel="stylesheet"></head><body><noscript><div><h1>「模式识别」非参数估计</h1><p>本章讨论的是非参数估计。很多时候我们无法给出样本分布的函数形式，也就无法使用根据样本估计函数参数的思路。<br/>非参数估计的思想是，直接根据样本，用数值方法估计出整个分布函数。</p><h2>非参数估计的基本原理</h2><p>还记得用频率估计概率的经典思想吗！假设你掷了1000次硬币，发现有489次正面朝上，那么你估计掷这枚硬币正面朝上的概率是0.489，或者近似地，概率约为0.5。</p><p>现在我们来考虑更复杂一点的情况，要估计的不是某个概率数值，而是样本分布的概率密度函数。考虑概率密度的性质：概率密度函数在区间$[x,x+\Delta x]$下的面积即为样本落在区间$[x,x+\Delta x]$内的概率。<br/>表述的更抽象一点，我们要估样本出现在面积为$V$的一个小区域$R$中的概率，这里的$R$就相当于上面例子中的区间$[x,x+\Delta x]$，$V=\Delta x$。</p><p>总样本数为$n$，落到小区域$R$内的样本数为$k$时，如果区域面积$V$合适地小，我们就可以认为在$R$区域内的概率密度是一个常数：</p>\hat{P}(x) = \frac{k}{n} \cdot \frac{1}{V}<h2>直方图方法</h2><p>直方图方法非常简单，可以理解为近似的用直方图的形状取描述概率密度函数。</p><div>[IMAGE]</div><p>不过，在样本数量并非无限时，如果小舱（直方图组距）过大，那么最终估计出的密度函数就非常粗糙；如果过小，那么有的小舱内可能没有样本，估计出的概率密度函数很不连续。</p><div><div>[IMAGE]</div><div>[IMAGE]</div></div><div><p>小舱的选择应该与样本总数相适应。如果样本总数是$n$，小舱体积是$V_n$，在$x$附近落入小舱的样本个数是$k_n$，那么估计的概率密度$[backslash]hat{P}(x)$可以收敛于真实概率密度$P(x)$的条件是：</p>\lim_{n \to \infty} V_n=0, \quad \lim_{n \to \infty} k_n=\infty, \quad \lim_{n \to \infty} \frac{k_n}{n}=0<p>可以这样理解：小舱体积应该尽可能小，同时要保证小舱内有充分多的样本，但每个小舱内样本数又必须是总样本数中很小一部分。</p></div><h2>k近邻估计</h2><p>kNN的全称是k Nearest Neighbors，意思是K个最近的邻居。基本做法是：根据样本总数确定一个参数$k_n$，例如样本总数为$n$时，可以取</p>k_n=\sqrt{n}<p>在求$x$处的密度估计$[backslash]hat{P}(x)$时，通过调整包含$x$的小舱体积，直到小舱内恰好落入$k_n$个样本。此时有：</p>\hat{P}(x) = \frac{k_n}{n} \cdot \frac{1}{V}<p>使用kNN方法时，样本密度较高的地方小舱体积会比较小，而样本密度低的地方小舱体积自动增大。这样可以兼顾高密度区域的分辨率和低密度区域的连续性。</p><h2>Parzen窗法</h2><p>在这种方法中，我们会定义一个核函数（也称窗函数）$K(x,x_i)$，其含义是，一个观测样本$x_i$对在$x$处概率密度估计的贡献。概率密度估计就是在每一点上把所有观测样本的贡献进行平均，即：</p>\hat{P}(x) = \frac{1}{n} \sum_{i=1}^n K(x,x_i)<p>窗函数只需要本身满足概率密度函数的要求即可：</p>K(x,x_i) > 0 \; 且 \; \int K(x,x_i) dx = 1<p>下面列举几种常见的窗函数。上文中样本都简单地用$x$表示，下面仍然回到最一般的情况：<br/>假设样本有$d$个维度，记样本为$[backslash]bm{X}=[x_1, x_2, [backslash]dots, x_d]^T$。</p><div>方窗</div><p>方窗范围可以看作以$[backslash]bm{X}_i$为中心的超立方体，其代表窗口大小的参数是立方体棱长$h$。</p>K(\bm{X},\bm{X}_i)=\begin{cases}\frac{1}{h^d}，\quad |\Delta x_i| < \frac{h}{2}\\\\0，\quad 其他\end{cases}<div>高斯窗（正态窗）</div><p>高斯窗范围即以样本$[backslash]bm{X}_i$为均值，协方差矩阵为$[backslash]bm{[backslash]Sigma}=[backslash]rho^2[backslash]bm{Q}$的正态分布。</p>K(\bm{X},\bm{X}_i) = \frac{1}{\sqrt{(2 \pi)^d \rho^{2d}|\bm{Q}|}} \exp \{-\frac{1}{2} \cdot \frac{(\bm{X}-\bm{X}_i)^T \bm{Q}^{-1} (\bm{X}-\bm{X}_i)}{\rho^2}\}<p>一维情况下有：</p>K(x,x_i) = \frac{1}{\sqrt{2\pi}\sigma} \exp\{-\frac{1}{2} \cdot (\frac{x-x_i}{\sigma})^2\}<div>超球窗</div><p>超球窗范围可以看作以$[backslash]bm{X}_i$为中心的超球体，体积为$V$，半径为$r$。</p>K(\bm{X},\bm{X}_i)=\begin{cases}\frac{1}{V}，\quad \Vert \bm{X}-\bm{X}_i \Vert \leq {r}\\\\0，\quad 其他\end{cases}<div><p>这些窗函数中都有一个表示窗口宽度的参数（$h$/$\rho$/$r$），也称作平滑参数，它反映了一个样本可以对多大范围内的密度估计产生影响。</p></div><p>下面是在样本数和平滑参数不同时，使用方窗和高斯窗的估计结果：</p><div>方窗</div><div>[IMAGE]</div><div>高斯窗</div><div>[IMAGE]</div><div><p>你可能发现当平滑参数过大时，估计的效果并不理想。然而在窗函数及其参数满足一定的条件时，Parzen窗估计可以是渐进无偏的。其中对于小舱体积（也就是平滑参数决定的窗口宽度）的要求是，应随着样本数的增加而趋近于0，但是缩减速度不快于$1/n$。<br/>常取为$[backslash]frac{1}{[backslash]sqrt{n}}$的倍数。</p></div><p>下面是取$[backslash]sigma=[backslash]frac{32}{[backslash]sqrt{n}}$的高斯窗的估计结果：</p><div>[IMAGE]</div></div></noscript><div id="root"></div></body></html>