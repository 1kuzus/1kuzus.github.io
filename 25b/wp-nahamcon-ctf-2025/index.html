<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/cd6b648520195f61.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/251a603d14fca651.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/6504997437c32a9d.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-5c07804fc0ab347d.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-e278622fa62dc0bf.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-faab496ef6116e58.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-ed6799cd4e1df27b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/457b8330-b5c9cf3fcf214847.js" async=""></script><script src="/_next/static/chunks/d3ac728e-0c798b3b8aa3bf53.js" async=""></script><script src="/_next/static/chunks/250-0ef8476c0fa8ee24.js" async=""></script><script src="/_next/static/chunks/612-fa632c1349770315.js" async=""></script><script src="/_next/static/chunks/551-61def387671cd330.js" async=""></script><script src="/_next/static/chunks/742-b5fcd35c730adf6f.js" async=""></script><script src="/_next/static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js" async=""></script><script src="/_next/static/chunks/app/layout-adcd83bc3c8eff9d.js" async=""></script><script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"></script><title>NahamCon CTF 2025 Writeup - 铃木的网络日记</title><link rel="canonical" href="https://1kuzus.github.io/25b/wp-nahamcon-ctf-2025/"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><script>
window.dataLayer = window.dataLayer || [];
function gtag() {
    dataLayer.push(arguments);
}
gtag('js', new Date());
gtag('config', 'G-45BYSZ6WPY');
</script><script>const a=z=>h.getItem(z),b=(y,z)=>h.setItem(y,z),c=(y,z)=>document.documentElement.setAttribute(y,z),d='theme',e='dark',f='light',g='class',h=localStorage;a(d)!==e&&a(d)!==f&&b(d,f);a(d)===e?c(g,e):c(g,f);</script><script>
if (!Array.prototype.findLast) {
    Array.prototype.findLast = function (callback) {
        for (let i = this.length - 1; i >= 0; i--) {
            if (callback(this[i])) return this[i];
        }
        return undefined;
    };
}
if (!Array.prototype.findLastIndex) {
    Array.prototype.findLastIndex = function (callback) {
        for (let i = this.length - 1; i >= 0; i--) {
            if (callback(this[i])) return i;
        }
        return -1;
    };
}
</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div id="header"><div id="header-left-wrapper"><a href="/"><div id="header-logo-bg"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 1560 1560"><path fill="#00A8C4" d="M644 97h273l272 683H916z"></path><path fill="#30303C" d="M98 97h273l409 1024L1189 97h273L916 1462H644z"></path><path fill="#00F8FF" d="M98 1462 643 97h273L371 1462z"></path></svg></div></a></div><div id="header-right-wrapper"><button id="header-show-sidebar-button" class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024"><rect fill="#FCFCFC" x="100" y="148" width="824" height="128" rx="64"></rect><rect fill="#FCFCFC" x="100" y="448" width="824" height="128" rx="64"></rect><rect fill="#FCFCFC" x="100" y="748" width="824" height="128" rx="64"></rect></svg></button><button class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-dark-theme-icon"><path d="M525 939h-4a440 440 0 0 1-314-135 446 446 0 0 1-11-597A432 432 0 0 1 367 90a43 43 0 0 1 45 9 43 43 0 0 1 10 43 358 358 0 0 0 83 376 361 361 0 0 0 377 83 43 43 0 0 1 54 55 433 433 0 0 1-100 155 439 439 0 0 1-311 128z" fill="#FCFCFC"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-light-theme-icon"><path d="M512 61c13 0 25 8 30 20l28 68c11 29-5 62-36 73a66 66 0 0 1-22 3c-34 0-61-25-61-56 0-7 1-14 3-20l28-68c5-12 17-20 30-20zm0 902c-13 0-25-8-30-20l-28-68a53 53 0 0 1-3-20c0-31 27-56 61-56a66 66 0 0 1 22 3c31 11 47 44 36 73l-28 68c-5 12-17 20-30 20zm451-451c0 13-8 25-20 30l-68 28c-29 11-62-5-73-36a66 66 0 0 1-3-22c0-34 25-61 56-61 7 0 14 1 20 3l68 28c12 5 20 17 20 30zm-902 0c0-13 8-25 20-30l68-28a53 53 0 0 1 20-3c31 0 56 27 56 61a66 66 0 0 1-3 22 57 57 0 0 1-73 36l-68-28c-12-5-20-17-20-30zm132-319c10-9 24-12 35-7l68 28c29 13 41 47 26 77a66 66 0 0 1-13 18c-24 24-61 26-83 4a53 53 0 0 1-12-17l-28-68c-5-11-2-25 7-35zm638 638c-10 9-24 12-35 7l-68-28a53 53 0 0 1-17-12c-22-22-20-59 4-83a66 66 0 0 1 18-13c30-15 64-3 77 26l28 68c5 11 2 25-7 35zm0-638c9 10 12 24 7 35l-28 68a56 56 0 0 1-77 26 66 66 0 0 1-18-13c-24-24-26-61-4-83 5-5 11-9 17-12l68-28c11-5 25-2 35 7zM193 831c-9-10-12-24-7-35l28-68a53 53 0 0 1 12-17c22-22 59-20 83 4a66 66 0 0 1 13 18c15 30 3 64-26 77l-68 28c-11 5-25 2-35-7zm319-94a225 225 0 1 1 0-450 225 225 0 0 1 0 450z" fill="#FCFCFC"></path></svg></button><a href="https://github.com/1kuzus/1kuzus.github.io" target="_blank" rel="noreferrer"><div class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 1024 1024"><path d="M411 831c4-5 7-10 7-12v-70c-106 22-128-44-128-44-17-45-43-56-43-56-34-24 4-24 4-24 37 3 58 39 58 39 34 58 89 41 111 32 3-24 13-41 24-51-86-10-174-43-174-188 0-41 15-75 39-102-4-10-17-48 3-101 0 0 33-10 104 40 31-9 64-12 96-12s65 5 96 12c73-50 104-40 104-40 20 53 8 91 3 101 24 27 39 60 39 102 0 145-88 178-174 188 14 12 26 34 26 70v104c0 4 2 7 7 12 5 7 3 19-4 24-3 2-7 3-10 3H425c-10 0-17-6-17-17 0-5 2-8 3-10z" fill="#FCFCFC"></path></svg></div></a></div></div><div id="post-layout"><div id="main" class="center-wrapper"><h1 class="post-title">NahamCon CTF 2025 Writeup</h1><div class="post-meta"><code class="not-loaded">null likes<!-- --> · </code><code class="not-loaded">null views<!-- --> · </code><code>2025-05-27</code></div><!--$--><h2 class="x-h1">Web/Outcast</h2><p class="x-p">The challenge gives part of the source code in <code class="x-inline-highlight">/modules/apicaller.php.orig</code>:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">APICaller</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$url</span> <span class="token operator">=</span>  <span class="token string single-quoted-string">'http://localhost/api/'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$path_tmp</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/tmp/'</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$id</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token variable">$path_tmp</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/tmp/'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">path_tmp</span> <span class="token operator">=</span> <span class="token variable">$path_tmp</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$apiMethod</span><span class="token punctuation">,</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">url</span> <span class="token operator">.</span> <span class="token variable">$apiMethod</span><span class="token punctuation">;</span>
        <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span><span class="token punctuation">;</span>

        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$data</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=></span> <span class="token operator">&amp;</span><span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">str_starts_with</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'@'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">str_starts_with</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">path_tmp</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$v</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">is_object</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$v</span> <span class="token operator">=</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Call the API server using the given configuraions</span>
        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt_array</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
            <span class="token constant">CURLOPT_POST</span>           <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
            <span class="token constant">CURLOPT_POSTFIELDS</span>     <span class="token operator">=></span> <span class="token variable">$data</span><span class="token punctuation">,</span>
            <span class="token constant">CURLOPT_RETURNTRANSFER</span> <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
            <span class="token constant">CURLOPT_HTTPHEADER</span>     <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Accept: application/json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$error</span>  <span class="token operator">=</span> <span class="token function">curl_error</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p class="x-p">By appending an extra <code class="x-inline-highlight">\r&#92;n</code> to the <code class="x-inline-highlight">method</code> parameter, the server throws an error and responds with the error message. Note that the error message reflects the value of parameters.</p><img alt="img" loading="lazy" width="1215" height="666" decoding="async" data-nimg="1" class="x-image x-image-invert" style="color:transparent;width:100%;height:auto" src="/_next/static/media/1.50876c65.jpg"/><p class="x-p">This can also be used for file existence enumeration. (And found <code class="x-inline-highlight">/flag.txt</code> exists.)</p><img alt="img" loading="lazy" width="1215" height="666" decoding="async" data-nimg="1" class="x-image x-image-invert" style="color:transparent;width:100%;height:auto" src="/_next/static/media/2.badf4cf4.jpg"/><p class="x-p">According to <code class="x-inline-highlight">apicaller.php.orig</code>, parameters like <code class="x-inline-highlight">@/tmp/[file]</code> will be parsed as file contents, and there is a path traversal vulnerability in both <code class="x-inline-highlight">method</code> and <code class="x-inline-highlight">parameters</code>.</p><p class="x-p">Make a request to the <code class="x-inline-highlight">../test/</code> API again, set the <code class="x-inline-highlight">method</code> parameter to a value that causes the error, like <code class="x-inline-highlight">1\r&#92;n</code>, and set the <code class="x-inline-highlight">parameters</code> parameter to <code class="x-inline-highlight">@/tmp/../flag.txt</code>. The server will reflect the contents of the file, which is the flag.</p><img alt="img" loading="lazy" width="1215" height="666" decoding="async" data-nimg="1" class="x-image x-image-invert" style="color:transparent;width:100%;height:auto" src="/_next/static/media/3.b9a68272.jpg"/><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>FLAG{ch41ning_bug$_1s_W0nd3rful!}</code></pre></div><h2 class="x-h1">Rev/What&#x27;s a base amongst friends?</h2><p class="x-p">This is a custom Base32 encoding. After some dynamic debugging, the custom alphabet is <code class="x-inline-highlight">ybndrfg8ejkmcpqxot1uwisza345h769</code>, and the encoded flag is <code class="x-inline-highlight">m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu</code>.</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token comment"># findings</span>
<span class="token comment"># length: 5n -> 8n</span>
<span class="token comment"># custom base32 alphabet: ybndrfg8ejkmcpqxot1uwisza345h769</span>

<span class="token comment"># tests</span>
<span class="token comment"># 00000 -> gyadycbo</span>
<span class="token comment"># 00001 -> gyadycbt</span>
<span class="token comment"># 11111 -> grauncjt</span>
<span class="token comment"># aaaaa -> cfosnamb</span>

<span class="token comment"># target</span>
<span class="token comment"># ??? -> m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu</span>

<span class="token keyword">import</span> base64

b32_alphabet <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz234567"</span>
custom_base32_alphabet <span class="token operator">=</span> <span class="token string">"ybndrfg8ejkmcpqxot1uwisza345h769"</span>
table_enc <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>b32_alphabet<span class="token punctuation">,</span> custom_base32_alphabet<span class="token punctuation">)</span>
table_dec <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>maketrans<span class="token punctuation">(</span>custom_base32_alphabet<span class="token punctuation">,</span> b32_alphabet<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">custom_base32_encode</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> base64<span class="token punctuation">.</span>b32encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>table_enc<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">custom_base32_decode</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span>translate<span class="token punctuation">(</span>table_dec<span class="token punctuation">)</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b32decode<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">return</span> data


<span class="token keyword">print</span><span class="token punctuation">(</span>custom_base32_encode<span class="token punctuation">(</span><span class="token string">b"00000"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># gyadycbo</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>custom_base32_encode<span class="token punctuation">(</span><span class="token string">b"aaaaa"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># cfosnamb</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>custom_base32_decode<span class="token punctuation">(</span><span class="token string">"gyadycbo"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># b'00000'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>custom_base32_decode<span class="token punctuation">(</span><span class="token string">"cfosnamb"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># b'aaaaa'</span>

target <span class="token operator">=</span> <span class="token string">"m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>custom_base32_decode<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># __rust_begin_short_backtrace__rust_end_short_backtraces</span>

<span class="token comment"># Congratulations! flag{50768fcb270edc499750ea64dc45ee92}</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>flag{50768fcb270edc499750ea64dc45ee92}</code></pre></div><h2 class="x-h1">Rev/It&#x27;s Locked</h2><p class="x-p">The given <code class="x-inline-highlight">flag.sh</code> script contains a lot of unreadable binary or non-printable characters. But we can still barely recognize the following part:</p><img alt="img" loading="lazy" width="1377" height="41" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/4.6c318983.jpg"/><p class="x-p">Which is:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Bash</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>C perl <span class="token parameter variable">-pe</span> <span class="token string">"s/[^print:]//g"</span> <span class="token operator">|</span> openssl base64 <span class="token parameter variable">-A</span> <span class="token parameter variable">-d</span></code></pre></div><p class="x-p">And <code class="x-inline-highlight">s/[^print:]//g</code> means to remove all non-printable characters, which inspires us to extract the printable characters from the script. We use the following script:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.sh"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

simplified <span class="token operator">=</span> <span class="token string">b""</span>

<span class="token keyword">for</span> ch <span class="token keyword">in</span> content<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token number">32</span> <span class="token operator">&lt;=</span> ch <span class="token operator">&lt;=</span> <span class="token number">126</span><span class="token punctuation">:</span>
        simplified <span class="token operator">+=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>ch<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag_simplified.sh"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>simplified<span class="token punctuation">)</span>
</code></pre></div><p class="x-p">And get <code class="x-inline-highlight">flag_simplified.sh</code> which includes a long Base64 string. We can decode it into the following content:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>_bcl_verify_dec ()
{
    [ "TEST-VALUE-VERIFY" != "$(echo "$BCV" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "B-\${1}-\${UID}" -a -A 2> /dev/null)" ] &amp;&amp; return 255;
    echo "$1-\${UID}"
}
_bcl_verify() { _bcl_verify_dec "$@"; }
_bcl_get ()
{
    [ -z "$UID" ] &amp;&amp; UID="$(id -u 2> /dev/null)";
    [ -f "/etc/machine-id" ] &amp;&amp; _bcl_verify "$(cat "/etc/machine-id" 2> /dev/null)" &amp;&amp; return;
    command -v dmidecode > /dev/null &amp;&amp; _bcl_verify "$(dmidecode -t 1 2> /dev/null | LANG=C perl -ne '/UUID/ &amp;&amp; print &amp;&amp; exit')" &amp;&amp; return;
    _bcl_verify "$({ ip l sh dev "$(LANG=C ip route show match 1.1.1.1 | perl -ne 's/.*dev ([^ ]*) .*/\1/ &amp;&amp; print &amp;&amp; exit')" | LANG=C perl -ne 'print if /ether / &amp;&amp; s/.*ether ([^ ]*).*/\1/'; } 2> /dev/null)" &amp;&amp; return;
    _bcl_verify "$({ blkid -o export | LANG=C perl -ne '/^UUID/ &amp;&amp; s/[^[:alnum:]]//g &amp;&amp; print &amp;&amp; exit'; } 2> /dev/null)" &amp;&amp; return;
    _bcl_verify "$({ fdisk -l | LANG=C perl -ne '/identifier/i &amp;&amp; s/[^[:alnum:]]//g &amp;&amp; print &amp;&amp; exit'; } 2> /dev/null)" &amp;&amp; return;
}
_bcl_gen_p ()
{
    local _k;
    local str;
    [ -z "$BC_BCL_TEST_FAIL" ] &amp;&amp; _k="$(_bcl_get)" &amp;&amp; _P="$(echo "$1" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "$_k" -a -A 2> /dev/null)";
    [ -n "$_P" ] &amp;&amp; return 0;
    [ -n "$fn" ] &amp;&amp; {
        unset BCL BCV _P P S fn;
        unset -f _bcl_get _bcl_verify _bcl_verify_dec;
        return 255
    };
    BCL="$(echo "$BCL" | openssl base64 -d -A 2> /dev/null)";
    [ "$BCL" -eq "$BCL" ] 2> /dev/null &amp;&amp; exit "$BCL";
    str="$(echo "$BCL" | openssl base64 -d -A 2> /dev/null)";
    BCL="\${str:-$BCL}";
    exec /bin/sh -c "$BCL";
    exit 255
}
BCL='aWQgLXUK'
BCV='93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI='
P=llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q=
S='lRwuwaugBEhK488I'
C=3eOcpOICWx5iy2UuoJS9gQ==
for x in openssl perl gunzip; do
    command -v "$x" >/dev/null || { echo >&amp;2 "ERROR: Command not found: $x"; return 255; }
done
unset fn _err
if [ -n "$ZSH_VERSION" ]; then
    [ "$ZSH_EVAL_CONTEXT" != "\${ZSH_EVAL_CONTEXT%":file:"*}" ] &amp;&amp; fn="$0"
elif [ -n "$BASH_VERSION" ]; then
    (return 0 2>/dev/null) &amp;&amp; fn="\${BASH_SOURCE[0]}"
fi
fn="\${BC_FN:-$fn}"
XS="\${BASH_EXECUTION_STRING:-$ZSH_EXECUTION_STRING}"
[ -z "$XS" ] &amp;&amp; unset XS
[ -z "$fn" ] &amp;&amp; [ -z "$XS" ] &amp;&amp; [ ! -f "$0" ] &amp;&amp; {
    echo >&amp;2 'ERROR: Shell not supported. Try "BC_FN=FileName source FileName"'
    _err=1
}
_bc_dec() {
    _P="\${PASSWORD:-$BC_PASSWORD}"
    unset _ PASSWORD
    if [ -n "$P" ]; then
        if [ -n "$BCV" ] &amp;&amp; [ -n "$BCL" ]; then
            _bcl_gen_p "$P" || return
        else
            _P="$(echo "$P"|openssl base64 -A -d)"
        fi
    else
        [ -z "$_P" ] &amp;&amp; {
            echo >&amp;2 -n "Enter password: "
            read -r _P
        }
    fi
    [ -n "$C" ] &amp;&amp; {
        local str
        str="$(echo "$C" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "C-\${S}-\${_P}" -a -A 2>/dev/null)"
        unset C
        [ -z "$str" ] &amp;&amp; {
            [ -n "$BCL" ] &amp;&amp; echo >&amp;2 "ERROR: Decryption failed."
            return 255
        }
        eval "$str"
        unset str
    }
    [ -n "$XS" ] &amp;&amp; {
        exec bash -c "$(printf %s "$XS" |LANG=C perl -e '&lt;>;&lt;>;read(STDIN,$_,1);while(&lt;>){s/B3/\n/g;s/B1/\x00/g;s/B2/B/g;print}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "\${S}-\${_P}" 2>/dev/null|LANG=C perl -e "read(STDIN,\$_, \${R:-0});print(&lt;>)"|gunzip)"
    }
    [ -z "$fn" ] &amp;&amp; [ -f "$0" ] &amp;&amp; {
        zf='read(STDIN,\$_,1);while(&lt;>){s/B3/\n/g;s/B1/\\x00/g;s/B2/B/g;print}'
        prg="perl -e '&lt;>;&lt;>;$zf'&lt;'\${0}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k '\${S}-\${_P}' 2>/dev/null|perl -e 'read(STDIN,\\\$_, \${R:-0});print(&lt;>)'|gunzip"
        LANG=C exec perl '-e$^F=255;for(319,279,385,4314,4354){($f=syscall$_,$",0)>0&amp;&amp;last};open($o,">&amp;=".$f);open($i,"'"$prg"'|");print$o(&lt;$i>);close($i)||exit($?/256);$ENV{"LANG"}="'"$LANG"'";exec{"/proc/$$/fd/$f"}"'"\${0:-python3}"'",@ARGV' -- "$@"
    }
    [ -f "\${fn}" ] &amp;&amp; {
        unset -f _bcl_get _bcl_verify _bcl_verify_dec
        unset BCL BCV _ P _err
        eval "unset _P S R fn;$(LANG=C perl -e '&lt;>;&lt;>;read(STDIN,$_,1);while(&lt;>){s/B3/\n/g;s/B1/\x00/g;s/B2/B/g;print}'&lt;"\${fn}"|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "\${S}-\${_P}" 2>/dev/null|LANG=C perl -e "read(STDIN,\$_, \${R:-0});print(&lt;>)"|gunzip)"
        return
    }
    [ -z "$fn" ] &amp;&amp; return
    echo >&amp;2 "ERROR: File not found: $fn"
    _err=1
}
[ -z "$_err" ] &amp;&amp; _bc_dec "$@"
unset fn
unset -f _bc_dec
if [ -n "$_err" ]; then
    unset _err
    false
else
    true
fi
</code></pre></div><p class="x-p"><code class="x-inline-highlight">_bcl_get</code> function tries a series of machine-unique identifiers to generate a key, and then decrypts the <code class="x-inline-highlight">BCV</code> variable using the key. And this challenge gives us an important hint:</p><div class="x-highlightblock highlight-background-gray"><p class="x-p">All I know is that this came from a machine with a cryptic ID of just 'hello'.</p></div><p class="x-p">So we then try to brute force the <code class="x-inline-highlight">UID</code>:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">import</span> subprocess

BCV <span class="token operator">=</span> <span class="token string">"93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI="</span>

<span class="token keyword">for</span> uid <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cmd <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'echo "</span><span class="token interpolation"><span class="token punctuation">{</span>BCV<span class="token punctuation">}</span></span><span class="token string">" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "B-hello-</span><span class="token interpolation"><span class="token punctuation">{</span>uid<span class="token punctuation">}</span></span><span class="token string">" -a -A'</span></span>
    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> result<span class="token punctuation">.</span>returncode <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"UID </span><span class="token interpolation"><span class="token punctuation">{</span>uid<span class="token punctuation">}</span></span><span class="token string"> succeeded: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">.</span>stdout<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># UID 83 succeeded: b'B\x87\xe5\xb5\xa5\x1d\xc9\`Ww+3\x8d\xb8\xa9\x06\x7f\x0f\x1dY\xa3\xe5\xf3\x080I&amp;/\x98N\x01'</span>
<span class="token comment"># UID 1094 succeeded: b'\x10CU1\\\xe3E\xbf\x9e\x83\xa7\xbb\xf6\xda\xc6\x90\xb3\x17O\x9e\xf5\x1c\xbe\x92\xad\xbd}\xd1\x82\x84H'</span>
<span class="token comment"># UID 1338 succeeded: b'TEST-VALUE-VERIFY\n'</span>
<span class="token comment"># UID 1417 succeeded: b'\xe0b[\xc2.\x08W\xb5\x15\xc9?\xf0an0W4I\xa3+\xdbb\x0f\xa8\n"\xd2\'\x85yj'</span>
<span class="token comment"># ...</span>
</code></pre></div><p class="x-p">And get the first key: <code class="x-inline-highlight">"B-hello-1338"</code>.</p><p class="x-p"><code class="x-inline-highlight">_bcl_get</code> function returns the second key <code class="x-inline-highlight">"hello-1338"</code> by <code class="x-inline-highlight">echo</code>, which is <code class="x-inline-highlight">_k</code> used in:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>_k="$(_bcl_get)" &amp;&amp; _P="$(echo "$1" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "$_k" -a -A 2> /dev/null)";</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">import</span> subprocess

P <span class="token operator">=</span> <span class="token string">"llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q="</span>
_k <span class="token operator">=</span> <span class="token string">"hello-1338"</span>  <span class="token comment"># from dec-1.py</span>

cmd <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'echo "</span><span class="token interpolation"><span class="token punctuation">{</span>P<span class="token punctuation">}</span></span><span class="token string">" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "</span><span class="token interpolation"><span class="token punctuation">{</span>_k<span class="token punctuation">}</span></span><span class="token string">" -a -A'</span></span>
result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>  <span class="token comment"># b'QHh4K9JfgoACd2f4\n'</span>
</code></pre></div><p class="x-p">Then we can get the string <code class="x-inline-highlight">"QHh4K9JfgoACd2f4"</code> by running the above command, which is <code class="x-inline-highlight">_P</code> used in the third key:</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>str="$(echo "$C" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k "C-${S}-${_P}" -a -A 2>/dev/null)"</code></pre></div><p class="x-p">Here <code class="x-inline-highlight">str</code> turns out to be <code class="x-inline-highlight">"R=2105&#92;n&#92;n"</code>.</p><p class="x-p">...</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>flag{f2ea4caf879bde891f0174f528c20682}</code></pre></div><!--/$--><button class="like-button not-loaded"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 1024 896"><path d="M512 911l-62-56C230 655 85 524 85 363 85 231 189 128 320 128c74 0 145 35 192 89 47-55 118-89 192-89 131 0 235 103 235 235 0 161-145 293-365 492l-62 56z" fill="#FCFCFC"></path></svg></button></div><div id="sidebar"><div id="sidebar-width-wrapper"><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">网络杂识<!-- --> (<!-- -->8<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/23d/database-3nf/"><span>数据库设计三大范式</span></a></li><li><a class="link" href="/23d/github-linguist-vendored/"><span>不统计Github仓库某个目录下的语言</span></a></li><li><a class="link" href="/24a/deepl-shortcut-setting/"><span>解决：DeepL该快捷键已被使用</span></a></li><li><a class="link" href="/24a/git-merge-allow-unrelated-histories/"><span>记录：使用--allow-unrelated-histories</span></a></li><li><a class="link" href="/24b/injective-surjective-bijective/"><span>单射、满射、双射</span></a></li><li><a class="link" href="/25a/tai-e-a2-additional-case/"><span>南京大学程序分析Lab2（常量传播）易错样例补充</span></a></li><li><a class="link" href="/25a/tai-e-a3-solution/"><span>南京大学程序分析Lab3（死代码消除）思路</span></a></li><li><a class="link" href="/25b/debug-x86_64-program-in-arm64-system/"><span>使用QEMU在ARM64系统上调试x86_64程序</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">安全学习<!-- --> (<!-- -->15<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/longtime/wp-portswigger/"><span>PortSwigger Writeup</span></a></li><li><a class="link" href="/23d/hust-cas-login/"><span>Python登录华科统一身份认证接口</span></a></li><li><a class="link" href="/24b/learn-cwes/"><span>Learn CWEs &amp; Real-word Examples</span></a></li><li><a class="link" href="/24b/cross-site-scripting/"><span>Learn XSS</span></a></li><li><a class="link" href="/24b/cross-site-request-forgery/"><span>Learn CSRF</span></a></li><li><a class="link" href="/24d/wp-bluehens-2024/"><span>BlueHens CTF 2024 Writeup</span></a></li><li><a class="link" href="/24d/wp-1337uplive-2024/"><span>1337UP LIVE CTF 2024 Writeup</span></a></li><li><a class="link" href="/24d/wp-m0lecon-2025/"><span>m0leCon Beginner CTF 2025 Writeup</span></a></li><li><a class="link" href="/24d/wp-0xl4ugh-2024/"><span>0xl4ugh CTF 2024 Writeup</span></a></li><li><a class="link" href="/25a/wp-nullcon-hackim-2025/"><span>Nullcon HackIM CTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-picoctf-2025/"><span>picoCTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-cyber-apocalypse-ctf-2025/"><span>HTB Cyber Apocalypse CTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-swampctf-2025/"><span>SwampCTF 2025 Writeup</span></a></li><li><a class="link" href="/25b/wp-1753ctf-2025/"><span>1753CTF 2025 Writeup</span></a></li><li><a class="link" href="/25b/wp-nahamcon-ctf-2025/"><span>NahamCon CTF 2025 Writeup</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">安全研究<!-- --> (<!-- -->9<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/longtime/papers-sec/"><span>论文速记：安全</span></a></li><li><a class="link" href="/24b/papers-sec-240514-taintmini/"><span>论文阅读：TAINTMINI: Detecting Flow of Sensitive Data in Mini-Programs with Static Taint Analysis (ICSE 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240728-2fa-consistency/"><span>论文阅读：A Systematic Study of the Consistency of Two-Factor Authentication User Journeys on Top-Ranked Websites (NDSS 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240810-conquer/"><span>论文阅读：Do Not Give A Dog Bread Every Time He Wags His Tail: Stealing Passwords through Content Queries (CONQUER) Attack (NDSS 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240817-2fa-failures/"><span>论文阅读：Security and Privacy Failures in Popular 2FA Apps (Security 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240824-zxcvbn/"><span>论文阅读：zxcvbn: Low-Budget Password Strength Estimation (Security 2016)</span></a></li><li><a class="link" href="/24c/papers-sec-240902-pafa-authentication/"><span>论文阅读：Maginot Line: Assessing a New Cross-app Threat to PII-as-Factor Authentication in Chinese Mobile Apps (NDSS 2024)</span></a></li><li><a class="link" href="/24c/papers-sec-240922-pre-hijacked-accounts/"><span>论文阅读：Pre-hijacked accounts: An Empirical Study of Security Failures in User Account Creation on the Web (Security 2022)</span></a></li><li><a class="link" href="/24d/papers-sec-241207-aimie/"><span>论文阅读：Understanding and Detecting Abused Image Hosting Modules as Malicious Services (CCS 2023)</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">算法<!-- --> (<!-- -->26<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/24b/sorting-algorithm/"><span>排序算法总结与代码实现</span></a></li><li><a class="link" href="/24b/mst-and-sp/"><span>最小生成树与最短路算法</span></a></li><li><a class="link" href="/24a/csp-2016-04/"><span>CSP 201604 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2018-03/"><span>CSP 201803 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2020-06/"><span>CSP 202006 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2020-09/"><span>CSP 202009 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2020-12/"><span>CSP 202012 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2022-06/"><span>CSP 202206 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2023-05/"><span>CSP 202305 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2023-09/"><span>CSP 202309 T1-T4题解</span></a></li><li><a class="link" href="/24b/leetcode-4/"><span>LeetCode 4.寻找两个正序数组的中位数</span></a></li><li><a class="link" href="/24b/leetcode-30/"><span>LeetCode 30.串联所有单词的子串</span></a></li><li><a class="link" href="/24b/leetcode-37/"><span>LeetCode 37.解数独</span></a></li><li><a class="link" href="/24c/leetcode-42/"><span>LeetCode 42.接雨水</span></a></li><li><a class="link" href="/24c/leetcode-51/"><span>LeetCode 51.N皇后</span></a></li><li><a class="link" href="/24c/leetcode-52/"><span>LeetCode 52.N皇后 II</span></a></li><li><a class="link" href="/24b/leetcode-60/"><span>LeetCode 60.排列序列</span></a></li><li><a class="link" href="/24b/leetcode-65/"><span>LeetCode 65.有效数字</span></a></li><li><a class="link" href="/24c/leetcode-68/"><span>LeetCode 68.文本左右对齐</span></a></li><li><a class="link" href="/24b/leetcode-84/"><span>LeetCode 84.柱状图中最大的矩形</span></a></li><li><a class="link" href="/24c/leetcode-85/"><span>LeetCode 85.最大矩形</span></a></li><li><a class="link" href="/24c/leetcode-149/"><span>LeetCode 149.直线上最多的点数</span></a></li><li><a class="link" href="/24d/leetcode-282/"><span>LeetCode 282.给表达式添加运算符</span></a></li><li><a class="link" href="/24b/leetcode-312/"><span>LeetCode 312.戳气球</span></a></li><li><a class="link" href="/24b/leetcode-1373/"><span>LeetCode 1373.二叉搜索子树的最大键值和</span></a></li><li><a class="link" href="/24b/leetcode-1739/"><span>LeetCode 1739.放置盒子</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">深度学习<!-- --> (<!-- -->8<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/longtime/papers-dl/"><span>论文速记：深度学习</span></a></li><li><a class="link" href="/23d/r2plus1d/"><span>行为识别R(2+1)D网络</span></a></li><li><a class="link" href="/23d/object-detection-map/"><span>目标检测评价指标mAP</span></a></li><li><a class="link" href="/23d/learn-rnn-lstm/"><span>学习RNN和LSTM</span></a></li><li><a class="link" href="/24a/reproduce-nerf-rpn/"><span>记录：复现NeRF-RPN代码</span></a></li><li><a class="link" href="/24b/yolov5-obb-nms-rotated/"><span>解决：nms_rotated报错&quot;THC/THC.h&quot;: No such file or directory</span></a></li><li><a class="link" href="/24c/winograd/"><span>Winograd算法</span></a></li><li><a class="link" href="/24c/model-optimization/"><span>模型优化概述：量化、压缩、轻量化</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">编程语言<!-- --> (<!-- -->5<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/23c/js-array/"><span>JavaScript数组常用方法</span></a></li><li><a class="link" href="/24a/cpp-stl/"><span>C++中STL的基本使用</span></a></li><li><a class="link" href="/24a/torch-numpy-topk/"><span>在pytorch和numpy中取top-k值和索引</span></a></li><li><a class="link" href="/24a/object-oriented-programming-python/"><span>Python面向对象编程</span></a></li><li><a class="link" href="/24c/asm8086-snake/"><span>8086汇编贪吃蛇</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">前端<!-- --> (<!-- -->2<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/23d/css-auto-height-transition/"><span>CSS实现auto高度的过渡动画</span></a></li><li><a class="link" href="/24d/android-send-explicit-intent-to-dynamically-registered-receiver/"><span>不能向动态注册的广播接收器发送显式Intent</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">课程笔记<!-- --> (<!-- -->19<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/24b/rank-inequality/"><span>【线性代数】对秩不等式的理解</span></a></li><li><a class="link" href="/23c/pattern-recognition-1/"><span>【模式识别】统计决策方法</span></a></li><li><a class="link" href="/23c/pattern-recognition-2/"><span>【模式识别】参数估计</span></a></li><li><a class="link" href="/23c/pattern-recognition-3/"><span>【模式识别】非参数估计</span></a></li><li><a class="link" href="/23d/pattern-recognition-4/"><span>【模式识别】线性学习器与线性分类器</span></a></li><li><a class="link" href="/23d/protocols/"><span>【计算机网络】协议总结</span></a></li><li><a class="link" href="/24a/machine-learning-exercises/"><span>【机器学习】习题</span></a></li><li><a class="link" href="/24a/games101-01-transformation/"><span>【GAMES101】Transformation</span></a></li><li><a class="link" href="/24a/games101-02-rasterization/"><span>【GAMES101】Rasterization</span></a></li><li><a class="link" href="/24a/games101-03-shading/"><span>【GAMES101】Shading</span></a></li><li><a class="link" href="/24a/games101-04-geometry/"><span>【GAMES101】Geometry</span></a></li><li><a class="link" href="/24c/assembly-1/"><span>【汇编语言】访问寄存器和内存</span></a></li><li><a class="link" href="/24c/assembly-2/"><span>【汇编语言】汇编语言编程</span></a></li><li><a class="link" href="/24c/assembly-3/"><span>【汇编语言】内存寻址方式</span></a></li><li><a class="link" href="/24c/assembly-4/"><span>【汇编语言】流程转移与子程序</span></a></li><li><a class="link" href="/24c/assembly-5/"><span>【汇编语言】标志寄存器</span></a></li><li><a class="link" href="/24c/assembly-6/"><span>【汇编语言】中断及外部设备操作</span></a></li><li><a class="link" href="/24d/crypto-1/"><span>【密码学】流密码</span></a></li><li><a class="link" href="/24d/crypto-2/"><span>【密码学】块密码</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">杂记<!-- --> (<!-- -->4<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/24b/by-questions/"><span>专业课复习</span></a></li><li><a class="link" href="/24d/about-interactive-multimedia/"><span>关于交互式多媒体</span></a></li><li><a class="link" href="/longtime/hundred-thousand/"><span>十万</span></a></li><li><a class="link" href="/longtime/linux-commands/"><span>三开</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">交互式多媒体<!-- --> (<!-- -->3<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link active" href="/24d/about-interactive-multimedia/"><span>关于交互式多媒体</span></a></li><li><a class="link" href="/23c/pattern-recognition-1/"><span>【模式识别】统计决策方法</span></a></li><li><a class="link" href="/23d/css-auto-height-transition/"><span>CSS实现auto高度的过渡动画</span></a></li></ul></div></div></div></div><div id="sidebar-mask"></div></div><script src="/_next/static/chunks/webpack-5c07804fc0ab347d.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/cd6b648520195f61.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/251a603d14fca651.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/6504997437c32a9d.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[47690,[],\"\"]\n7:I[76842,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"551\",\"static/chunks/551-61def387671cd330.js\",\"742\",\"static/chunks/742-b5fcd35c730adf6f.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js\"],\"PostMeta\"]\n8:\"$Sreact.suspense\"\na:I[76842,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"551\",\"static/chunks/551-61def387671cd330.js\",\"742\",\"static/chunks/742-b5fcd35c730adf6f.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js\"],\"LikeButton\"]\nb:I[5613,[],\"\"]\nd:I[31778,[],\"\"]\ne:I[30389,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"551\",\"static/chunks/551-61def387671cd330.js\",\"742\",\"static/chunks/742-b5fcd35c730adf6f.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js\"],\"\"]\nf:I[25694,[\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"185\",\"static/chunks/app/layout-adcd83bc3c8eff9d.js\"],\"GlobalProvider\"]\n10:I[30397,[\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"185\",\"static/chunks/app/layout-adcd83bc3c8eff9d.js\"],\"\"]\n12:I[48955,[],\"\"]\nc:[\"slug\",\"25b/wp-nahamcon-ctf-2025\",\"c\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/cd6b648520195f61.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"9sSMTCS9p-byzmlay285O\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/25b/wp-nahamcon-ctf-2025/\",\"initialTree\":[\"\",{\"children\":[\"(posts)\",{\"children\":[[\"slug\",\"25b/wp-nahamcon-ctf-2025\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"25b\\\",\\\"wp-nahamcon-ctf-2025\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(posts)\",{\"children\":[[\"slug\",\"25b/wp-nahamcon-ctf-2025\",\"c\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",[false,[\"$\",\"h1\",null,{\"className\":\"post-title\",\"children\":\"NahamCon CTF 2025 Writeup\"}],[\"$\",\"$L7\",null,{\"path\":\"/25b/wp-nahamcon-ctf-2025/\"}],[\"$\",\"$8\",null,{\"fallback\":[\"$\",\"p\",null,{\"children\":\"Loading component...\"}],\"children\":\"$L9\"}],[\"$\",\"$La\",null,{\"path\":\"/25b/wp-nahamcon-ctf-2025/\"}]],null]]},[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(posts)\",\"children\",\"$c\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/6504997437c32a9d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[null,[\"$\",\"div\",null,{\"id\":\"post-layout\",\"children\":[[\"$\",\"div\",null,{\"id\":\"main\",\"className\":\"center-wrapper\",\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(posts)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}],[\"$\",\"$Le\",null,{}]]}],null]]},[null,[\"$\",\"html\",null,{\"lang\":\"zh-CN\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY\"}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\nwindow.dataLayer = window.dataLayer || [];\\nfunction gtag() {\\n    dataLayer.push(arguments);\\n}\\ngtag('js', new Date());\\ngtag('config', 'G-45BYSZ6WPY');\\n\"}}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"const a=z=\u003eh.getItem(z),b=(y,z)=\u003eh.setItem(y,z),c=(y,z)=\u003edocument.documentElement.setAttribute(y,z),d='theme',e='dark',f='light',g='class',h=localStorage;a(d)!==e\u0026\u0026a(d)!==f\u0026\u0026b(d,f);a(d)===e?c(g,e):c(g,f);\"}}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\nif (!Array.prototype.findLast) {\\n    Array.prototype.findLast = function (callback) {\\n        for (let i = this.length - 1; i \u003e= 0; i--) {\\n            if (callback(this[i])) return this[i];\\n        }\\n        return undefined;\\n    };\\n}\\nif (!Array.prototype.findLastIndex) {\\n    Array.prototype.findLastIndex = function (callback) {\\n        for (let i = this.length - 1; i \u003e= 0; i--) {\\n            if (callback(this[i])) return i;\\n        }\\n        return -1;\\n    };\\n}\\n\"}}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$Lf\",null,{\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"id\":\"notfound\",\"children\":[[\"$\",\"img\",null,{\"alt\":\"img\",\"src\":\"/images/cry.gif\"}],[\"$\",\"code\",null,{\"id\":\"notfound-404\",\"children\":\"404\"}],[\"$\",\"code\",null,{\"id\":\"notfound-text\",\"children\":\"Page Not Found\"}]]}],\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/98e601cf5ba3633d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/251a603d14fca651.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]}]}]]}],null]],\"initialHead\":[false,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]]\n"])</script><script>self.__next_f.push([1,"14:I[62029,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"551\",\"static/chunks/551-61def387671cd330.js\",\"742\",\"static/chunks/742-b5fcd35c730adf6f.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js\"],\"\"]\n17:I[74365,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"551\",\"static/chunks/551-61def387671cd330.js\",\"742\",\"static/chunks/742-b5fcd35c730adf6f.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-08f3716ffed0e1ed.js\"],\"\"]\n15:T54d,\u003c?php\n\nclass APICaller {\n    private $url =  'http://localhost/api/';\n    private $path_tmp = '/tmp/';\n    private $id;\n\n    public function __construct($id, $path_tmp = '/tmp/') {\n        $this-\u003eid = $id;\n        $this-\u003epath_tmp = $path_tmp;\n\n    }\n\n    public function __call($apiMethod, $data = array()) {\n        $url = $this-\u003eurl . $apiMethod;\n        $data['id'] = $this-\u003eid;\n\n        foreach ($data as $k =\u003e \u0026$v) {\n            if ( ($v) \u0026\u0026 (is_string($v)) \u0026\u0026 str_starts_with($v, '@') ) {\n                $file = substr($v, 1);\n\n                if ( str_starts_with($file, $this-\u003epath_tmp) ) {\n                    $v = file_get_contents($file);\n                }\n            }\n            if (is_array($v) || is_object($v)) {\n                $v = json_encode($v);\n            }\n        }\n\n        // Call the API server using the given configuraions\n        $ch = curl_init($url);\n        curl_setopt_array($ch, array(\n            CURLOPT_POST           =\u003e true,\n            CURLOPT_POSTFIELDS     =\u003e $data,\n            CURLOPT_RETURNTRANSFER =\u003e true,\n            CURLOPT_HTTPHEADER     =\u003e array('Accept: application/json'),\n        ));\n        $response = curl_exec($ch);\n        $error  = curl_error($ch);\n\n        curl_close($ch);\n\n        if (!empty($error)) {\n            throw"])</script><script>self.__next_f.push([1," new Exception($error);\n        }\n\n        return $response;\n    }\n}\n16:T27ee,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token php language-php\"\u003e\u003cspan class=\"token delimiter important\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name-definition class-name\"\u003eAPICaller\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$url\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e  \u003cspan class=\"token string single-quoted-string\"\u003e'http://localhost/api/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$path_tmp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string single-quoted-string\"\u003e'/tmp/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003e__construct\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$path_tmp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string single-quoted-string\"\u003e'/tmp/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$this\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003e\u003c/span\u003e\u003cspan class=\"token property\"\u003eid\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$this\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003e\u003c/span\u003e\u003cspan class=\"token property\"\u003epath_tmp\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$path_tmp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003e__call\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$apiMethod\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$data\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003earray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$url\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$this\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003e\u003c/span\u003e\u003cspan class=\"token property\"\u003eurl\u003c/span\u003e \u003cspan class=\"token operator\"\u003e.\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$apiMethod\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$data\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$this\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003e\u003c/span\u003e\u003cspan class=\"token property\"\u003eid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"token keyword\"\u003eforeach\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$data\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$k\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eis_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"token function\"\u003estr_starts_with\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string single-quoted-string\"\u003e'@'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token variable\"\u003e$file\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003esubstr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n                \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token function\"\u003estr_starts_with\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$file\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$this\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003e\u003c/span\u003e\u003cspan class=\"token property\"\u003epath_tmp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                    \u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003efile_get_contents\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$file\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n                \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eis_array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eis_object\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ejson_encode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$v\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e// Call the API server using the given configuraions\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$ch\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurl_init\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$url\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003ecurl_setopt_array\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003earray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n            \u003cspan class=\"token constant\"\u003eCURLOPT_POST\u003c/span\u003e           \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token constant boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token constant\"\u003eCURLOPT_POSTFIELDS\u003c/span\u003e     \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$data\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token constant\"\u003eCURLOPT_RETURNTRANSFER\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token constant boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token constant\"\u003eCURLOPT_HTTPHEADER\u003c/span\u003e     \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003earray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'Accept: application/json'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$response\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurl_exec\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$error\u003c/span\u003e  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurl_error\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"token function\"\u003ecurl_close\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eempty\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$error\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eException\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$error\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$response\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/span\u003e"])</script><script>self.__next_f.push([1,"18:T522,# findings\n# length: 5n -\u003e 8n\n# custom base32 alphabet: ybndrfg8ejkmcpqxot1uwisza345h769\n\n# tests\n# 00000 -\u003e gyadycbo\n# 00001 -\u003e gyadycbt\n# 11111 -\u003e grauncjt\n# aaaaa -\u003e cfosnamb\n\n# target\n# ??? -\u003e m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu\n\nimport base64\n\nb32_alphabet = \"abcdefghijklmnopqrstuvwxyz234567\"\ncustom_base32_alphabet = \"ybndrfg8ejkmcpqxot1uwisza345h769\"\ntable_enc = str.maketrans(b32_alphabet, custom_base32_alphabet)\ntable_dec = str.maketrans(custom_base32_alphabet, b32_alphabet)\n\n\ndef custom_base32_encode(data):\n    result = base64.b32encode(data)\n    result = result.decode().lower()\n    return result.translate(table_enc)\n\n\ndef custom_base32_decode(result):\n    result = result.translate(table_dec)\n    result = result.encode().upper()\n    data = base64.b32decode(result)\n    return data\n\n\nprint(custom_base32_encode(b\"00000\"))  # gyadycbo\nprint(custom_base32_encode(b\"aaaaa\"))  # cfosnamb\n\nprint(custom_base32_decode(\"gyadycbo\"))  # b'00000'\nprint(custom_base32_decode(\"cfosnamb\"))  # b'aaaaa'\n\ntarget = \"m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu\"\nprint(custom_base32_decode(target))  # __rust_begin_short_backtrace__rust_end_short_backtraces\n\n# Congratulations! flag{50768fcb270edc499750ea64dc45ee92}\n19:T146a,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token comment\"\u003e# findings\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# length: 5n -\u003e 8n\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# custom base32 alphabet: ybndrfg8ejkmcpqxot1uwisza345h769\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# tests\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 00000 -\u003e gyadycbo\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 00001 -\u003e gyadycbt\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 11111 -\u003e grauncjt\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# aaaaa -\u003e cfosnamb\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# target\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# ??? -\u003e m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e base64\n\nb32_alphabet \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"abcdefghijklmnopqrstuvwxyz234567\"\u003c/span\u003e\ncustom_base32_alphabet \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ybndrfg8ejkmcpqxot1uwisza345h769\"\u003c/span\u003e\ntable_enc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emaketrans\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eb32_alphabet\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e custom_base32_alphabet\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ntable_dec \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emaketrans\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_alphabet\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e b32_alphabet\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ecustom_base32_encode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base64\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eb32encode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edecode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elower\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etable_enc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ecustom_base32_decode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etranslate\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etable_dec\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eupper\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base64\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eb32decode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e data\n\n\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_encode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003eb\"00000\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# gyadycbo\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_encode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003eb\"aaaaa\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# cfosnamb\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_decode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"gyadycbo\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# b'00000'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_decode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"cfosnamb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# b'aaaaa'\u003c/span\u003e\n\ntarget \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"m7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu\"\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustom_base32_decode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# __rust_begin_short_backtrace__rust_end_short_backtraces\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Congratulations! flag{50768fcb270edc499750ea64dc45ee92}\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1a:T6ef,\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"flag.sh\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"rb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    content \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eread\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nsimplified \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003eb\"\"\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e ch \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e content\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token number\"\u003e32\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;=\u003c/span\u003e ch \u003cspan class=\"token operator\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"token number\"\u003e126\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        simplified \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ebytes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ech\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eopen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"flag_simplified.sh\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"wb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    f\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ewrite\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esimplified\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n1b:T11b6,"])</script><script>self.__next_f.push([1,"_bcl_verify_dec ()\n{\n    [ \"TEST-VALUE-VERIFY\" != \"$(echo \"$BCV\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"B-\\${1}-\\${UID}\" -a -A 2\u003e /dev/null)\" ] \u0026\u0026 return 255;\n    echo \"$1-\\${UID}\"\n}\n_bcl_verify() { _bcl_verify_dec \"$@\"; }\n_bcl_get ()\n{\n    [ -z \"$UID\" ] \u0026\u0026 UID=\"$(id -u 2\u003e /dev/null)\";\n    [ -f \"/etc/machine-id\" ] \u0026\u0026 _bcl_verify \"$(cat \"/etc/machine-id\" 2\u003e /dev/null)\" \u0026\u0026 return;\n    command -v dmidecode \u003e /dev/null \u0026\u0026 _bcl_verify \"$(dmidecode -t 1 2\u003e /dev/null | LANG=C perl -ne '/UUID/ \u0026\u0026 print \u0026\u0026 exit')\" \u0026\u0026 return;\n    _bcl_verify \"$({ ip l sh dev \"$(LANG=C ip route show match 1.1.1.1 | perl -ne 's/.*dev ([^ ]*) .*/\\1/ \u0026\u0026 print \u0026\u0026 exit')\" | LANG=C perl -ne 'print if /ether / \u0026\u0026 s/.*ether ([^ ]*).*/\\1/'; } 2\u003e /dev/null)\" \u0026\u0026 return;\n    _bcl_verify \"$({ blkid -o export | LANG=C perl -ne '/^UUID/ \u0026\u0026 s/[^[:alnum:]]//g \u0026\u0026 print \u0026\u0026 exit'; } 2\u003e /dev/null)\" \u0026\u0026 return;\n    _bcl_verify \"$({ fdisk -l | LANG=C perl -ne '/identifier/i \u0026\u0026 s/[^[:alnum:]]//g \u0026\u0026 print \u0026\u0026 exit'; } 2\u003e /dev/null)\" \u0026\u0026 return;\n}\n_bcl_gen_p ()\n{\n    local _k;\n    local str;\n    [ -z \"$BC_BCL_TEST_FAIL\" ] \u0026\u0026 _k=\"$(_bcl_get)\" \u0026\u0026 _P=\"$(echo \"$1\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"$_k\" -a -A 2\u003e /dev/null)\";\n    [ -n \"$_P\" ] \u0026\u0026 return 0;\n    [ -n \"$fn\" ] \u0026\u0026 {\n        unset BCL BCV _P P S fn;\n        unset -f _bcl_get _bcl_verify _bcl_verify_dec;\n        return 255\n    };\n    BCL=\"$(echo \"$BCL\" | openssl base64 -d -A 2\u003e /dev/null)\";\n    [ \"$BCL\" -eq \"$BCL\" ] 2\u003e /dev/null \u0026\u0026 exit \"$BCL\";\n    str=\"$(echo \"$BCL\" | openssl base64 -d -A 2\u003e /dev/null)\";\n    BCL=\"\\${str:-$BCL}\";\n    exec /bin/sh -c \"$BCL\";\n    exit 255\n}\nBCL='aWQgLXUK'\nBCV='93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI='\nP=llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q=\nS='lRwuwaugBEhK488I'\nC=3eOcpOICWx5iy2UuoJS9gQ==\nfor x in openssl perl gunzip; do\n    command -v \"$x\" \u003e/dev/null || { echo \u003e\u00262 \"ERROR: Command not found: $x\"; return 255; }\ndone\nunset fn _err\nif [ -n \"$ZSH_VERSION\" ]; then\n    [ \"$ZSH_EVAL_CONTEXT\" != \"\\${ZSH_EVAL_CONTEXT%\":file:\"*}\" ] \u0026\u0026 fn=\"$0\"\nelif [ -n \"$BASH_VERSION\" ]; then\n    (return 0 2\u003e/dev/null) \u0026\u0026 fn=\"\\${BASH_SOURCE[0]}\"\nfi\nfn=\"\\${BC_FN:-$fn}\"\nXS=\"\\${BASH_EXECUTION_STRING:-$ZSH_EXECUTION_STRING}\"\n[ -z \"$XS\" ] \u0026\u0026 unset XS\n[ -z \"$fn\" ] \u0026\u0026 [ -z \"$XS\" ] \u0026\u0026 [ ! -f \"$0\" ] \u0026\u0026 {\n    echo \u003e\u00262 'ERROR: Shell not supported. Try \"BC_FN=FileName source FileName\"'\n    _err=1\n}\n_bc_dec() {\n    _P=\"\\${PASSWORD:-$BC_PASSWORD}\"\n    unset _ PASSWORD\n    if [ -n \"$P\" ]; then\n        if [ -n \"$BCV\" ] \u0026\u0026 [ -n \"$BCL\" ]; then\n            _bcl_gen_p \"$P\" || return\n        else\n            _P=\"$(echo \"$P\"|openssl base64 -A -d)\"\n        fi\n    else\n        [ -z \"$_P\" ] \u0026\u0026 {\n            echo \u003e\u00262 -n \"Enter password: \"\n            read -r _P\n        }\n    fi\n    [ -n \"$C\" ] \u0026\u0026 {\n        local str\n        str=\"$(echo \"$C\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"C-\\${S}-\\${_P}\" -a -A 2\u003e/dev/null)\"\n        unset C\n        [ -z \"$str\" ] \u0026\u0026 {\n            [ -n \"$BCL\" ] \u0026\u0026 echo \u003e\u00262 \"ERROR: Decryption failed.\"\n            return 255\n        }\n        eval \"$str\"\n        unset str\n    }\n    [ -n \"$XS\" ] \u0026\u0026 {\n        exec bash -c \"$(printf %s \"$XS\" |LANG=C perl -e '\u003c\u003e;\u003c\u003e;read(STDIN,$_,1);while(\u003c\u003e){s/B3/\\n/g;s/B1/\\x00/g;s/B2/B/g;print}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"\\${S}-\\${_P}\" 2\u003e/dev/null|LANG=C perl -e \"read(STDIN,\\$_, \\${R:-0});print(\u003c\u003e)\"|gunzip)\"\n    }\n    [ -z \"$fn\" ] \u0026\u0026 [ -f \"$0\" ] \u0026\u0026 {\n        zf='read(STDIN,\\$_,1);while(\u003c\u003e){s/B3/\\n/g;s/B1/\\\\x00/g;s/B2/B/g;print}'\n        prg=\"perl -e '\u003c\u003e;\u003c\u003e;$zf'\u003c'\\${0}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k '\\${S}-\\${_P}' 2\u003e/dev/null|perl -e 'read(STDIN,\\\\\\$_, \\${R:-0});print(\u003c\u003e)'|gunzip\"\n        LANG=C exec perl '-e$^F=255;for(319,279,385,4314,4354){($f=syscall$_,$\",0)\u003e0\u0026\u0026last};open($o,\"\u003e\u0026=\".$f);open($i,\"'\"$prg\"'|\");print$o(\u003c$i\u003e);close($i)||exit($?/256);$ENV{\"LANG\"}=\"'\"$LANG\"'\";exec{\"/proc/$$/fd/$f\"}\"'\"\\${0:-python3}\"'\",@ARGV' -- \"$@\"\n    }\n    [ -f \"\\${fn}\" ] \u0026\u0026 {\n        unset -f _bcl_get _bcl_verify _bcl_verify_dec\n        unset BCL BCV _ P _err\n        eval \"unset _P S R fn;$(LANG=C perl -e '\u003c\u003e;\u003c\u003e;read(STDIN,$_,1);while(\u003c\u003e){s/B3/\\n/g;s/B1/\\x00/g;s/B2/B/g;print}'\u003c\"\\${fn}\"|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"\\${S}-\\${_P}\" 2\u003e/dev/null|LANG=C perl -e \"read(STDIN,\\$_, \\${R:-0});print(\u003c\u003e)\"|gunzip)\"\n        return\n    }\n    [ -z \"$fn\" ] \u0026\u0026 return\n    echo \u003e\u00262 \"ERROR: File not found: $fn\"\n    _err=1\n}\n[ -z \"$_err\" ] \u0026\u0026 _bc_dec \"$@\"\nunset fn\nunset -f _bc_dec\nif [ -n \"$_err\" ]; then\n    unset _err\n    false\nelse\n    true\nfi\n"])</script><script>self.__next_f.push([1,"1c:T1353,"])</script><script>self.__next_f.push([1,"_bcl_verify_dec ()\n{\n    [ \"TEST-VALUE-VERIFY\" != \"$(echo \"$BCV\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"B-\\${1}-\\${UID}\" -a -A 2\u003e /dev/null)\" ] \u0026amp;\u0026amp; return 255;\n    echo \"$1-\\${UID}\"\n}\n_bcl_verify() { _bcl_verify_dec \"$@\"; }\n_bcl_get ()\n{\n    [ -z \"$UID\" ] \u0026amp;\u0026amp; UID=\"$(id -u 2\u003e /dev/null)\";\n    [ -f \"/etc/machine-id\" ] \u0026amp;\u0026amp; _bcl_verify \"$(cat \"/etc/machine-id\" 2\u003e /dev/null)\" \u0026amp;\u0026amp; return;\n    command -v dmidecode \u003e /dev/null \u0026amp;\u0026amp; _bcl_verify \"$(dmidecode -t 1 2\u003e /dev/null | LANG=C perl -ne '/UUID/ \u0026amp;\u0026amp; print \u0026amp;\u0026amp; exit')\" \u0026amp;\u0026amp; return;\n    _bcl_verify \"$({ ip l sh dev \"$(LANG=C ip route show match 1.1.1.1 | perl -ne 's/.*dev ([^ ]*) .*/\\1/ \u0026amp;\u0026amp; print \u0026amp;\u0026amp; exit')\" | LANG=C perl -ne 'print if /ether / \u0026amp;\u0026amp; s/.*ether ([^ ]*).*/\\1/'; } 2\u003e /dev/null)\" \u0026amp;\u0026amp; return;\n    _bcl_verify \"$({ blkid -o export | LANG=C perl -ne '/^UUID/ \u0026amp;\u0026amp; s/[^[:alnum:]]//g \u0026amp;\u0026amp; print \u0026amp;\u0026amp; exit'; } 2\u003e /dev/null)\" \u0026amp;\u0026amp; return;\n    _bcl_verify \"$({ fdisk -l | LANG=C perl -ne '/identifier/i \u0026amp;\u0026amp; s/[^[:alnum:]]//g \u0026amp;\u0026amp; print \u0026amp;\u0026amp; exit'; } 2\u003e /dev/null)\" \u0026amp;\u0026amp; return;\n}\n_bcl_gen_p ()\n{\n    local _k;\n    local str;\n    [ -z \"$BC_BCL_TEST_FAIL\" ] \u0026amp;\u0026amp; _k=\"$(_bcl_get)\" \u0026amp;\u0026amp; _P=\"$(echo \"$1\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"$_k\" -a -A 2\u003e /dev/null)\";\n    [ -n \"$_P\" ] \u0026amp;\u0026amp; return 0;\n    [ -n \"$fn\" ] \u0026amp;\u0026amp; {\n        unset BCL BCV _P P S fn;\n        unset -f _bcl_get _bcl_verify _bcl_verify_dec;\n        return 255\n    };\n    BCL=\"$(echo \"$BCL\" | openssl base64 -d -A 2\u003e /dev/null)\";\n    [ \"$BCL\" -eq \"$BCL\" ] 2\u003e /dev/null \u0026amp;\u0026amp; exit \"$BCL\";\n    str=\"$(echo \"$BCL\" | openssl base64 -d -A 2\u003e /dev/null)\";\n    BCL=\"\\${str:-$BCL}\";\n    exec /bin/sh -c \"$BCL\";\n    exit 255\n}\nBCL='aWQgLXUK'\nBCV='93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI='\nP=llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q=\nS='lRwuwaugBEhK488I'\nC=3eOcpOICWx5iy2UuoJS9gQ==\nfor x in openssl perl gunzip; do\n    command -v \"$x\" \u003e/dev/null || { echo \u003e\u0026amp;2 \"ERROR: Command not found: $x\"; return 255; }\ndone\nunset fn _err\nif [ -n \"$ZSH_VERSION\" ]; then\n    [ \"$ZSH_EVAL_CONTEXT\" != \"\\${ZSH_EVAL_CONTEXT%\":file:\"*}\" ] \u0026amp;\u0026amp; fn=\"$0\"\nelif [ -n \"$BASH_VERSION\" ]; then\n    (return 0 2\u003e/dev/null) \u0026amp;\u0026amp; fn=\"\\${BASH_SOURCE[0]}\"\nfi\nfn=\"\\${BC_FN:-$fn}\"\nXS=\"\\${BASH_EXECUTION_STRING:-$ZSH_EXECUTION_STRING}\"\n[ -z \"$XS\" ] \u0026amp;\u0026amp; unset XS\n[ -z \"$fn\" ] \u0026amp;\u0026amp; [ -z \"$XS\" ] \u0026amp;\u0026amp; [ ! -f \"$0\" ] \u0026amp;\u0026amp; {\n    echo \u003e\u0026amp;2 'ERROR: Shell not supported. Try \"BC_FN=FileName source FileName\"'\n    _err=1\n}\n_bc_dec() {\n    _P=\"\\${PASSWORD:-$BC_PASSWORD}\"\n    unset _ PASSWORD\n    if [ -n \"$P\" ]; then\n        if [ -n \"$BCV\" ] \u0026amp;\u0026amp; [ -n \"$BCL\" ]; then\n            _bcl_gen_p \"$P\" || return\n        else\n            _P=\"$(echo \"$P\"|openssl base64 -A -d)\"\n        fi\n    else\n        [ -z \"$_P\" ] \u0026amp;\u0026amp; {\n            echo \u003e\u0026amp;2 -n \"Enter password: \"\n            read -r _P\n        }\n    fi\n    [ -n \"$C\" ] \u0026amp;\u0026amp; {\n        local str\n        str=\"$(echo \"$C\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"C-\\${S}-\\${_P}\" -a -A 2\u003e/dev/null)\"\n        unset C\n        [ -z \"$str\" ] \u0026amp;\u0026amp; {\n            [ -n \"$BCL\" ] \u0026amp;\u0026amp; echo \u003e\u0026amp;2 \"ERROR: Decryption failed.\"\n            return 255\n        }\n        eval \"$str\"\n        unset str\n    }\n    [ -n \"$XS\" ] \u0026amp;\u0026amp; {\n        exec bash -c \"$(printf %s \"$XS\" |LANG=C perl -e '\u0026lt;\u003e;\u0026lt;\u003e;read(STDIN,$_,1);while(\u0026lt;\u003e){s/B3/\\n/g;s/B1/\\x00/g;s/B2/B/g;print}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"\\${S}-\\${_P}\" 2\u003e/dev/null|LANG=C perl -e \"read(STDIN,\\$_, \\${R:-0});print(\u0026lt;\u003e)\"|gunzip)\"\n    }\n    [ -z \"$fn\" ] \u0026amp;\u0026amp; [ -f \"$0\" ] \u0026amp;\u0026amp; {\n        zf='read(STDIN,\\$_,1);while(\u0026lt;\u003e){s/B3/\\n/g;s/B1/\\\\x00/g;s/B2/B/g;print}'\n        prg=\"perl -e '\u0026lt;\u003e;\u0026lt;\u003e;$zf'\u0026lt;'\\${0}'|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k '\\${S}-\\${_P}' 2\u003e/dev/null|perl -e 'read(STDIN,\\\\\\$_, \\${R:-0});print(\u0026lt;\u003e)'|gunzip\"\n        LANG=C exec perl '-e$^F=255;for(319,279,385,4314,4354){($f=syscall$_,$\",0)\u003e0\u0026amp;\u0026amp;last};open($o,\"\u003e\u0026amp;=\".$f);open($i,\"'\"$prg\"'|\");print$o(\u0026lt;$i\u003e);close($i)||exit($?/256);$ENV{\"LANG\"}=\"'\"$LANG\"'\";exec{\"/proc/$$/fd/$f\"}\"'\"\\${0:-python3}\"'\",@ARGV' -- \"$@\"\n    }\n    [ -f \"\\${fn}\" ] \u0026amp;\u0026amp; {\n        unset -f _bcl_get _bcl_verify _bcl_verify_dec\n        unset BCL BCV _ P _err\n        eval \"unset _P S R fn;$(LANG=C perl -e '\u0026lt;\u003e;\u0026lt;\u003e;read(STDIN,$_,1);while(\u0026lt;\u003e){s/B3/\\n/g;s/B1/\\x00/g;s/B2/B/g;print}'\u0026lt;\"\\${fn}\"|openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"\\${S}-\\${_P}\" 2\u003e/dev/null|LANG=C perl -e \"read(STDIN,\\$_, \\${R:-0});print(\u0026lt;\u003e)\"|gunzip)\"\n        return\n    }\n    [ -z \"$fn\" ] \u0026amp;\u0026amp; return\n    echo \u003e\u0026amp;2 \"ERROR: File not found: $fn\"\n    _err=1\n}\n[ -z \"$_err\" ] \u0026amp;\u0026amp; _bc_dec \"$@\"\nunset fn\nunset -f _bc_dec\nif [ -n \"$_err\" ]; then\n    unset _err\n    false\nelse\n    true\nfi\n"])</script><script>self.__next_f.push([1,"1d:Tb3c,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e subprocess\n\nBCV \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI=\"\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e uid \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e10000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    cmd \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef'echo \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eBCV\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"B-hello-\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003euid\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" -a -A'\u003c/span\u003e\u003c/span\u003e\n    result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e subprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erun\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecmd\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e shell\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e capture_output\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e result\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereturncode \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"UID \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003euid\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e succeeded: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estdout\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# UID 83 succeeded: b'B\\x87\\xe5\\xb5\\xa5\\x1d\\xc9\\`Ww+3\\x8d\\xb8\\xa9\\x06\\x7f\\x0f\\x1dY\\xa3\\xe5\\xf3\\x080I\u0026amp;/\\x98N\\x01'\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# UID 1094 succeeded: b'\\x10CU1\\\\\\xe3E\\xbf\\x9e\\x83\\xa7\\xbb\\xf6\\xda\\xc6\\x90\\xb3\\x17O\\x9e\\xf5\\x1c\\xbe\\x92\\xad\\xbd}\\xd1\\x82\\x84H'\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# UID 1338 succeeded: b'TEST-VALUE-VERIFY\\n'\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# UID 1417 succeeded: b'\\xe0b[\\xc2.\\x08W\\xb5\\x15\\xc9?\\xf0an0W4I\\xa3+\\xdbb\\x0f\\xa8\\n\"\\xd2\\'\\x85yj'\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# ...\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1e:T5d6,\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e subprocess\n\nP \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q=\"\u003c/span\u003e\n_k \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"hello-1338\"\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# from dec-1.py\u003c/span\u003e\n\ncmd \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef'echo \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eP\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e_k\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" -a -A'\u003c/span\u003e\u003c/span\u003e\nresult \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e subprocess\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erun\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecmd\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e shell\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e capture_output\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estdout\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# b'QHh4K9JfgoACd2f4\\n'\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"Web/Outcast\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"The challenge gives part of the source code in \u003ccode class=\\\"x-inline-highlight\\\"\u003e/modules/apicaller.php.orig\u003c/code\u003e:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$15\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$16\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"By appending an extra \u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\\r\u0026#92;n\u003c/code\u003e to the \u003ccode class=\\\"x-inline-highlight\\\"\u003emethod\u003c/code\u003e parameter, the server throws an error and responds with the error message. Note that the error message reflects the value of parameters.\"}}],[\"$\",\"$L17\",null,{\"src\":\"1.jpg\",\"width\":\"100%\",\"filterDarkTheme\":true}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"This can also be used for file existence enumeration. (And found \u003ccode class=\\\"x-inline-highlight\\\"\u003e/flag.txt\u003c/code\u003e exists.)\"}}],[\"$\",\"$L17\",null,{\"src\":\"2.jpg\",\"width\":\"100%\",\"filterDarkTheme\":true}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"According to \u003ccode class=\\\"x-inline-highlight\\\"\u003eapicaller.php.orig\u003c/code\u003e, parameters like \u003ccode class=\\\"x-inline-highlight\\\"\u003e@/tmp/[file]\u003c/code\u003e will be parsed as file contents, and there is a path traversal vulnerability in both \u003ccode class=\\\"x-inline-highlight\\\"\u003emethod\u003c/code\u003e and \u003ccode class=\\\"x-inline-highlight\\\"\u003eparameters\u003c/code\u003e.\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"Make a request to the \u003ccode class=\\\"x-inline-highlight\\\"\u003e../test/\u003c/code\u003e API again, set the \u003ccode class=\\\"x-inline-highlight\\\"\u003emethod\u003c/code\u003e parameter to a value that causes the error, like \u003ccode class=\\\"x-inline-highlight\\\"\u003e1\\\\r\u0026#92;n\u003c/code\u003e, and set the \u003ccode class=\\\"x-inline-highlight\\\"\u003eparameters\u003c/code\u003e parameter to \u003ccode class=\\\"x-inline-highlight\\\"\u003e@/tmp/../flag.txt\u003c/code\u003e. The server will reflect the contents of the file, which is the flag.\"}}],[\"$\",\"$L17\",null,{\"src\":\"3.jpg\",\"width\":\"100%\",\"filterDarkTheme\":true}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"FLAG{ch41ning_bug$_1s_W0nd3rful!}\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"FLAG{ch41ning_bug$_1s_W0nd3rful!}\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"Rev/What's a base amongst friends?\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"This is a custom Base32 encoding. After some dynamic debugging, the custom alphabet is \u003ccode class=\\\"x-inline-highlight\\\"\u003eybndrfg8ejkmcpqxot1uwisza345h769\u003c/code\u003e, and the encoded flag is \u003ccode class=\\\"x-inline-highlight\\\"\u003em7xzr7muqtxsr3m8pfzf6h5ep738ez5ncftss7d1cftskz49qj4zg7n9cizgez5upbzzr7n9cjosg45wqjosg3mu\u003c/code\u003e.\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$18\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$19\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"flag{50768fcb270edc499750ea64dc45ee92}\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"flag{50768fcb270edc499750ea64dc45ee92}\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"Rev/It's Locked\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"The given \u003ccode class=\\\"x-inline-highlight\\\"\u003eflag.sh\u003c/code\u003e script contains a lot of unreadable binary or non-printable characters. But we can still barely recognize the following part:\"}}],[\"$\",\"$L17\",null,{\"src\":\"4.jpg\",\"width\":\"100%\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"Which is:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Bash\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"LANG=C perl -pe \\\"s/[^print:]//g\\\" | openssl base64 -A -d\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token assign-left variable\\\"\u003e\u003cspan class=\\\"token environment constant\\\"\u003eLANG\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003eC perl \u003cspan class=\\\"token parameter variable\\\"\u003e-pe\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"s/[^print:]//g\\\"\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e|\u003c/span\u003e openssl base64 \u003cspan class=\\\"token parameter variable\\\"\u003e-A\u003c/span\u003e \u003cspan class=\\\"token parameter variable\\\"\u003e-d\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"And \u003ccode class=\\\"x-inline-highlight\\\"\u003es/[^print:]//g\u003c/code\u003e means to remove all non-printable characters, which inspires us to extract the printable characters from the script. We use the following script:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"with open(\\\"flag.sh\\\", \\\"rb\\\") as f:\\n    content = f.read()\\n\\nsimplified = b\\\"\\\"\\n\\nfor ch in content:\\n    if 32 \u003c= ch \u003c= 126:\\n        simplified += bytes([ch])\\n\\nwith open(\\\"flag_simplified.sh\\\", \\\"wb\\\") as f:\\n    f.write(simplified)\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1a\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"And get \u003ccode class=\\\"x-inline-highlight\\\"\u003eflag_simplified.sh\u003c/code\u003e which includes a long Base64 string. We can decode it into the following content:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$1b\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1c\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e_bcl_get\u003c/code\u003e function tries a series of machine-unique identifiers to generate a key, and then decrypts the \u003ccode class=\\\"x-inline-highlight\\\"\u003eBCV\u003c/code\u003e variable using the key. And this challenge gives us an important hint:\"}}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-gray\",\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"All I know is that this came from a machine with a cryptic ID of just 'hello'.\"}}]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"So we then try to brute force the \u003ccode class=\\\"x-inline-highlight\\\"\u003eUID\u003c/code\u003e:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"import subprocess\\n\\nBCV = \\\"93iNKe0zcKfgfSwQoHYdJbWGu4Dfnw5ZZ5a3ld5UEqI=\\\"\\n\\nfor uid in range(0, 10000):\\n    cmd = f'echo \\\"{BCV}\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"B-hello-{uid}\\\" -a -A'\\n    result = subprocess.run(cmd, shell=True, capture_output=True)\\n    if result.returncode == 0:\\n        print(f\\\"UID {uid} succeeded: {result.stdout}\\\")\\n\\n# UID 83 succeeded: b'B\\\\x87\\\\xe5\\\\xb5\\\\xa5\\\\x1d\\\\xc9\\\\`Ww+3\\\\x8d\\\\xb8\\\\xa9\\\\x06\\\\x7f\\\\x0f\\\\x1dY\\\\xa3\\\\xe5\\\\xf3\\\\x080I\u0026/\\\\x98N\\\\x01'\\n# UID 1094 succeeded: b'\\\\x10CU1\\\\\\\\\\\\xe3E\\\\xbf\\\\x9e\\\\x83\\\\xa7\\\\xbb\\\\xf6\\\\xda\\\\xc6\\\\x90\\\\xb3\\\\x17O\\\\x9e\\\\xf5\\\\x1c\\\\xbe\\\\x92\\\\xad\\\\xbd}\\\\xd1\\\\x82\\\\x84H'\\n# UID 1338 succeeded: b'TEST-VALUE-VERIFY\\\\n'\\n# UID 1417 succeeded: b'\\\\xe0b[\\\\xc2.\\\\x08W\\\\xb5\\\\x15\\\\xc9?\\\\xf0an0W4I\\\\xa3+\\\\xdbb\\\\x0f\\\\xa8\\\\n\\\"\\\\xd2\\\\'\\\\x85yj'\\n# ...\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1d\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"And get the first key: \u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\"B-hello-1338\\\"\u003c/code\u003e.\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e_bcl_get\u003c/code\u003e function returns the second key \u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\"hello-1338\\\"\u003c/code\u003e by \u003ccode class=\\\"x-inline-highlight\\\"\u003eecho\u003c/code\u003e, which is \u003ccode class=\\\"x-inline-highlight\\\"\u003e_k\u003c/code\u003e used in:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"_k=\\\"$(_bcl_get)\\\" \u0026\u0026 _P=\\\"$(echo \\\"$1\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"$_k\\\" -a -A 2\u003e /dev/null)\\\";\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"_k=\\\"$(_bcl_get)\\\" \u0026amp;\u0026amp; _P=\\\"$(echo \\\"$1\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"$_k\\\" -a -A 2\u003e /dev/null)\\\";\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"import subprocess\\n\\nP = \\\"llLvO8+J6gmLlp964bcJG3I3mY27I9ACsJTvXYCZv2Q=\\\"\\n_k = \\\"hello-1338\\\"  # from dec-1.py\\n\\ncmd = f'echo \\\"{P}\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"{_k}\\\" -a -A'\\nresult = subprocess.run(cmd, shell=True, capture_output=True)\\n\\nprint(result.stdout)  # b'QHh4K9JfgoACd2f4\\\\n'\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"Then we can get the string \u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\"QHh4K9JfgoACd2f4\\\"\u003c/code\u003e by running the above command, which is \u003ccode class=\\\"x-inline-highlight\\\"\u003e_P\u003c/code\u003e used in the third key:\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"str=\\\"$(echo \\\"$C\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"C-${S}-${_P}\\\" -a -A 2\u003e/dev/null)\\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"str=\\\"$(echo \\\"$C\\\" | openssl enc -d -aes-256-cbc -md sha256 -nosalt -k \\\"C-${S}-${_P}\\\" -a -A 2\u003e/dev/null)\\\"\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"Here \u003ccode class=\\\"x-inline-highlight\\\"\u003estr\u003c/code\u003e turns out to be \u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\"R=2105\u0026#92;n\u0026#92;n\\\"\u003c/code\u003e.\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"...\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L14\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"flag{f2ea4caf879bde891f0174f528c20682}\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"flag{f2ea4caf879bde891f0174f528c20682}\"}}]}]]}]]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"NahamCon CTF 2025 Writeup - 铃木的网络日记\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://1kuzus.github.io/25b/wp-nahamcon-ctf-2025/\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>