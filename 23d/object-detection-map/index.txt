2:I[4365,["202","static/chunks/202-fbcb7cc54bf4f9f2.js","452","static/chunks/452-25327cca6690da96.js","666","static/chunks/app/(blogs)/23d/object-detection-map/page-83ed125716d3e843.js"],""]
3:I[4500,["202","static/chunks/202-fbcb7cc54bf4f9f2.js","452","static/chunks/452-25327cca6690da96.js","666","static/chunks/app/(blogs)/23d/object-detection-map/page-83ed125716d3e843.js"],""]
4:I[5613,[],""]
5:I[1778,[],""]
6:I[9806,["792","static/chunks/792-a494ddef3d40c017.js","135","static/chunks/app/(blogs)/layout-c2ed809937fec3d8.js"],""]
7:I[3393,["792","static/chunks/792-a494ddef3d40c017.js","135","static/chunks/app/(blogs)/layout-c2ed809937fec3d8.js"],""]
8:I[5694,["792","static/chunks/792-a494ddef3d40c017.js","185","static/chunks/app/layout-fee515b4ccc2d098.js"],"GlobalProvider"]
9:I[397,["792","static/chunks/792-a494ddef3d40c017.js","185","static/chunks/app/layout-fee515b4ccc2d098.js"],""]
0:["6fR_4UqCdtahxiXgtOcEq",[[["",{"children":["(blogs)",{"children":["23d",{"children":["object-detection-map",{"children":["__PAGE__",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["(blogs)",{"children":["23d",{"children":["object-detection-map",{"children":["__PAGE__",{},["$L1",[["$","h1",null,{"className":"x-title","children":"目标检测评价指标mAP"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<span class=\"x-inline-strong\">全类平均精度</span><code class=\"x-inline-highlight\">(mean Average Precision, mAP)</code>用于评估目标检测模型性能。"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"接下来围绕下面的例子逐步介绍<code class=\"x-inline-highlight\">mAP</code>的计算。在下面的<code class=\"x-inline-highlight\">7</code>张图片中共有<code class=\"x-inline-highlight\">15</code>个目标，用绿色框标出；并且有<code class=\"x-inline-highlight\">24</code>个检测框，用红色框标出，百分比数值表示置信度。"}}],["$","$L2",null,{"src":"fig1.png","width":"600px"}],["$","h2",null,{"className":"x-h1","children":["$","$L3",null,{"excludeFromContents":"$undefined","children":"交并比"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<span class=\"x-inline-strong\">交并比</span><code class=\"x-inline-highlight\">(Intersection over Union, IoU)</code>是产生的检测框与真实检测框的交集与并集的比值。"}}],["$","$L2",null,{"src":"fig2.jpg","width":"300px","invertInDarkTheme":true}],["$","h2",null,{"className":"x-h1","children":["$","$L3",null,{"excludeFromContents":"$undefined","children":"查准率和查全率"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"对于一组图像的目标检测结果来说，假如规定<code class=\"x-inline-highlight\">IoU</code>大于某一阈值就把检测结果视为真正例<code class=\"x-inline-highlight\">TP</code>，否则视为假正例<code class=\"x-inline-highlight\">FP</code>；并且如果出现多个检测重叠一个真值的情况，只有最高置信度的检测框被视为<code class=\"x-inline-highlight\">TP</code>，其他则视为<code class=\"x-inline-highlight\">FP</code>。"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"接下来计算两个指标：<span class=\"x-inline-strong\">查准率</span>或<span class=\"x-inline-strong\">精确率</span><code class=\"x-inline-highlight\">Precision</code>，即预测为正的样本中的正确率<code class=\"x-inline-highlight\">TP/All Detections</code>；<span class=\"x-inline-strong\">查全率</span>或<span class=\"x-inline-strong\">召回率</span><code class=\"x-inline-highlight\">Recall</code>，即正确检测出的正样本占所有正样本的比例<code class=\"x-inline-highlight\">TP/All Ground Truths</code>。"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"对于上面的例子，按照置信度由高到低做出如下表格："}}],["$","$L2",null,{"src":"fig3.png","width":"80%"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"表格的前三列分别是图片编号、检测框编号和置信度；<br/><code class=\"x-inline-highlight\">TP</code><code class=\"x-inline-highlight\">FP</code>列标识出这个检测框是否为一个真正例；<br/><code class=\"x-inline-highlight\">Acc TP</code><code class=\"x-inline-highlight\">Acc FP</code>列是截至此行累计的<code class=\"x-inline-highlight\">TP</code>和<code class=\"x-inline-highlight\">FP</code>个数，用于<code class=\"x-inline-highlight\">Precision</code>和<code class=\"x-inline-highlight\">Recall</code>的计算；<br/><code class=\"x-inline-highlight\">Precision</code>列由<code class=\"x-inline-highlight\">Acc TP/(Acc TP + Acc FP)</code>得到；<br/><code class=\"x-inline-highlight\">Recall</code>列由<code class=\"x-inline-highlight\">Acc TP/15</code>得到（共有<code class=\"x-inline-highlight\">15</code>个目标，因此<code class=\"x-inline-highlight\">All Ground Truths</code>=<code class=\"x-inline-highlight\">15</code>）。"}}],["$","h2",null,{"className":"x-h1","children":["$","$L3",null,{"excludeFromContents":"$undefined","children":"平均精度AP"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<span class=\"x-inline-strong\">平均精度</span><code class=\"x-inline-highlight\">(Average Precision, AP)</code>由近似计算<code class=\"x-inline-highlight\">Precision</code>-<code class=\"x-inline-highlight\">Recall</code>曲线下面积得出。"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"通常的计算方法是取曲线<code class=\"x-inline-highlight\">11</code>点插值，不过无论如何计算，最后的含义都是希望得到近似的曲线下面积。因此在这里不展开介绍计算过程，而是讨论“曲线下面积”是如何与“平均精度”建立起联系的。"}}],["$","div",null,{"className":"x-highlightblock highlight-background-gray","children":[["$","h4",null,{"className":"x-h3","children":"个人理解"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"当我们说模型在一个类别上预测精度是<code class=\"x-inline-highlight\">80%</code>时，直观上的体会是“模型的<code class=\"x-inline-highlight\">10</code>个预测框中，大约有<code class=\"x-inline-highlight\">8</code>个是对目标的正确预测”。然而这并不能与<code class=\"x-inline-highlight\">Precision</code>-<code class=\"x-inline-highlight\">Recall</code>曲线下的面积建立起直观的联系。但注意到曲线的纵坐标的含义就是精度，从这个角度出发，以下是对<code class=\"x-inline-highlight\">AP</code>指标的个人理解："}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"下面是一个常见的<code class=\"x-inline-highlight\">Precision</code>-<code class=\"x-inline-highlight\">Recall</code>曲线示意图。尽管现实任务中的曲线通常是不平滑、不单调的，但大致可以用图中的较为理想的曲线走势描述。我们通常用<span class=\"x-inline-strong\">平衡点</span>去衡量一个模型的好坏，也就是曲线上<code class=\"x-inline-highlight\">Precision</code>=<code class=\"x-inline-highlight\">Recall</code>的点。"}}],["$","$L2",null,{"src":"fig4.jpg","width":"40%","invertInDarkTheme":true}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"模型在平衡点处的精度与曲线下面积有没有联系呢？下图的蓝色折线<code class=\"x-inline-highlight\">D</code>将曲线<code class=\"x-inline-highlight\">A</code>的平衡点两侧的两段单调递减的曲线近似为直线，如果以折线<code class=\"x-inline-highlight\">D</code>下面积近似曲线<code class=\"x-inline-highlight\">A</code>下面积，将黄色三角形补到右侧后，可以发现蓝色折线<code class=\"x-inline-highlight\">D</code>下的面积恰好反映了平衡点处的精度。"}}],["$","$L2",null,{"src":"fig5.jpg","width":"85%","invertInDarkTheme":true}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"因此可以认为，平均精度<code class=\"x-inline-highlight\">AP</code>某种意义上是用<code class=\"x-inline-highlight\">Precision</code>-<code class=\"x-inline-highlight\">Recall</code>曲线下面积近似反映了平衡点处的<code class=\"x-inline-highlight\">Precision</code>值。"}}]]}],["$","h2",null,{"className":"x-h1","children":["$","$L3",null,{"excludeFromContents":"$undefined","children":"全类平均精度mAP"}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"上述步骤算出的是针对一个类别的平均精度<code class=\"x-inline-highlight\">AP</code>，而全类平均精度<code class=\"x-inline-highlight\">mAP</code>是所有检测到的类别的<code class=\"x-inline-highlight\">AP</code>均值。"}}],["$","h4",null,{"className":"x-h3","children":"为什么要分类计算AP，再取均值？"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"评估模型在目标检测任务上的性能时，通常用所有类别的<code class=\"x-inline-highlight\">AP</code>的平均值，而不是将所有类别的检测结果混在一起，直接计算出一个数值，其中一个原因是：<br/>当类别数量不平衡时，可能某个少样本类别的检测效果很差。如果混在一起计算，由于该类别样本数量较少，因此并不会对最终的结果产生很大的影响。此时对模型的性能评估是不准确的。因此需要逐类测量<code class=\"x-inline-highlight\">AP</code>再取均值，作为最终的<code class=\"x-inline-highlight\">mAP</code>检测结果。"}}],["$","h2",null,{"className":"x-h1","children":["$","$L3",null,{"excludeFromContents":"$undefined","children":"参考资料"}]}],["$","p",null,{"className":"x-p no-margin-bottom","dangerouslySetInnerHTML":{"__html":"本文的部分内容、图片来源于："}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://zh-v2.d2l.ai/chapter_computer-vision\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">动手学深度学习 - 计算机视觉</a>"}}]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://www.zhihu.com/question/53405779/answer/2481182203\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">目标检测中的mAP是什么含义？</a>"}}]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<a href=\"https://baijiahao.baidu.com/s?id=1767101899839497831\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">深入了解平均精度(mAP)：通过精确率-召回率曲线评估目标检测性能</a>"}}]}]]}]],null]]},["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children","23d","children","object-detection-map","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/2ca3ce358f319fca.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children","23d","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","div",null,{"id":"blog-layout","children":[["$","div",null,{"id":"main","children":["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","(blogs)","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]}],["$","$L6",null,{}],["$","$L7",null,{}]]}],null]]},[null,["$","html",null,{"lang":"zh-CN","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","href":"favicon.ico"}],["$","script",null,{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"}],["$","script",null,{"async":true,"src":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag() {\n    dataLayer.push(arguments);\n}\ngtag('js', new Date());\ngtag('config', 'G-45BYSZ6WPY');\nif (!localStorage.getItem('theme')) localStorage.setItem('theme', 'light');\ndocument.documentElement.setAttribute('class', localStorage.getItem('theme'));\n"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"const a=z=>h.getItem(z),b=(y,z)=>h.setItem(y,z),c=(y,z)=>document.documentElement.setAttribute(y,z),d='theme',e='dark',f='light',g='class',h=localStorage;a(d)!==e&&a(d)!==f&&b(d,f);a(d)===e?c(g,e):c(g,f);"}}]]}],["$","body",null,{"children":["$","$L8",null,{"children":[["$","$L9",null,{}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"id":"notfound","children":[["$","img",null,{"alt":"img","src":"/images/cry.gif"}],["$","div",null,{"id":"notfound-404","children":"404"}],["$","div",null,{"id":"notfound-text","children":"Page Not Found"}]]}],"notFoundStyles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/eccd2e7a1149e571.css","precedence":"next","crossOrigin":""}]],"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/803fe687e7e31b6c.css","precedence":"next","crossOrigin":""}]]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/e43a733539111c31.css","precedence":"next","crossOrigin":""}]],"$La"]]]]
a:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"目标检测评价指标mAP - 铃木的网络日记"}],["$","link","3",{"rel":"canonical","href":"https://1kuzus.github.io/23d/object-detection-map/"}]]
1:null
