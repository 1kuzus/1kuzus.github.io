<!DOCTYPE html><html class="light" lang="zh-CN"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="铃木的网络日记" name="description"><meta content="1kuzus" name="author"><script src="https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY" async></script><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-45BYSZ6WPY"),localStorage.getItem("theme")||localStorage.setItem("theme","light"),document.documentElement.setAttribute("class",localStorage.getItem("theme"))</script><title>Python面向对象编程</title><script src="/static/js/main.b44d1f03.js" defer></script><link href="/static/css/main.83ace1da.css" rel="stylesheet"><link href="https://www.googletagmanager.com" rel="preconnect"><link href="https://busuanzi.ibruce.info" rel="preconnect"><meta content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9" http-equiv="origin-trial"><link href="http://busuanzi.ibruce.info" rel="preconnect"></head><body><div id="root"><div class="" id="header"><div id="header-left-wrapper"><div id="header-logo-bg"><svg height="36px" viewBox="0 0 1560 1560" width="36px" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="M644 97h272.529L1189 780H916.471z" fill="#00A8C4"></path><path d="M98 97h272.84L780 1120.73 1189.162 97H1462L916.438 1462H643.562z" fill="#30303C"></path><path d="M98 1462L643.3 97H916L370.7 1462z" fill="#00F8FF"></path></g></svg></div><div id="header-archive"><h3 id="header-archive-text">归档</h3><div class="header-archive-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div></div><div id="header-right-wrapper"><div id="header-theme-bg"><svg height="20px" viewBox="0 0 1024 1024" width="20px" xmlns="http://www.w3.org/2000/svg"><path d="M512 61.44c13.312 0 25.252 7.639 29.942 19.17l27.566 67.972c11.92 29.348-4.178 62.075-35.943 73.094A65.946 65.946 0 01512 225.28c-33.935 0-61.44-25.416-61.44-56.77 0-6.8 1.331-13.558 3.912-19.928l27.586-67.973C486.728 69.08 498.647 61.44 512 61.44zm0 901.12c-13.332 0-25.272-7.639-29.942-19.17l-27.586-67.972a52.961 52.961 0 01-3.912-19.927c0-31.335 27.505-56.771 61.44-56.771a66.28 66.28 0 0121.565 3.604c31.765 11.019 47.862 43.746 35.943 73.114l-27.566 67.953c-4.69 11.53-16.63 19.169-29.942 19.169zM962.56 512c0 13.312-7.639 25.252-19.17 29.942l-67.972 27.566c-29.348 11.92-62.075-4.178-73.094-35.943A65.946 65.946 0 01798.72 512c0-33.935 25.416-61.44 56.77-61.44 6.8 0 13.558 1.331 19.928 3.912l67.973 27.586c11.53 4.67 19.169 16.589 19.169 29.942zm-901.12 0c0-13.332 7.639-25.272 19.17-29.942l67.972-27.586a52.9 52.9 0 0119.927-3.912c31.335 0 56.771 27.505 56.771 61.44a66.28 66.28 0 01-3.604 21.565c-11.019 31.765-43.746 47.862-73.114 35.943l-67.953-27.566C69.08 537.252 61.44 525.312 61.44 512zm131.953-318.587c9.42-9.42 23.265-12.452 34.734-7.618l67.563 28.549c29.184 12.35 40.94 46.858 26.256 77.107a65.946 65.946 0 01-12.698 17.817c-23.982 23.983-61.399 25.457-83.558 3.277a52.961 52.961 0 01-11.346-16.855l-28.55-67.543c-4.853-11.469-1.822-25.313 7.599-34.734zm637.194 637.194c-9.42 9.421-23.265 12.452-34.734 7.598l-67.543-28.549a52.961 52.961 0 01-16.876-11.325c-22.16-22.18-20.685-59.597 3.298-83.579a65.946 65.946 0 0117.817-12.698c30.25-14.684 64.758-2.928 77.107 26.256l28.55 67.563c4.833 11.47 1.802 25.293-7.62 34.734zm0-637.214c9.42 9.42 12.452 23.265 7.618 34.734l-28.549 67.563c-12.35 29.184-46.858 40.94-77.107 26.256a65.946 65.946 0 01-17.817-12.698c-23.983-23.982-25.457-61.399-3.277-83.558 4.792-4.834 10.506-8.663 16.855-11.346l67.543-28.55c11.469-4.853 25.313-1.822 34.734 7.599zM193.393 830.587c-9.421-9.42-12.452-23.265-7.598-34.734l28.549-67.543a52.618 52.618 0 0111.325-16.876c22.18-22.16 59.597-20.685 83.579 3.298a65.842 65.842 0 0112.698 17.817c14.684 30.25 2.928 64.758-26.256 77.107l-67.563 28.55c-11.47 4.833-25.293 1.802-34.734-7.62zM512 737.28c-124.416 0-225.28-100.864-225.28-225.28S387.584 286.72 512 286.72 737.28 387.584 737.28 512 636.416 737.28 512 737.28z" fill="#FCFCFC"></path></svg></div><a href="https://github.com/1kuzus/1kuzus.github.io" rel="noreferrer" target="_blank"><div id="header-github-bg"><svg height="36px" viewBox="0 0 1024 1024" width="36px" xmlns="http://www.w3.org/2000/svg"><path d="M411.306667 831.146667c3.413333-5.12 6.826667-10.24 6.826666-11.946667v-69.973333c-105.813333 22.186667-128-44.373333-128-44.373334-17.066667-44.373333-42.666667-56.32-42.666666-56.32-34.133333-23.893333 3.413333-23.893333 3.413333-23.893333 37.546667 3.413333 58.026667 39.253333 58.026667 39.253333 34.133333 58.026667 88.746667 40.96 110.933333 32.426667 3.413333-23.893333 13.653333-40.96 23.893333-51.2-85.333333-10.24-174.08-42.666667-174.08-187.733333 0-40.96 15.36-75.093333 39.253334-102.4-3.413333-10.24-17.066667-47.786667 3.413333-100.693334 0 0 32.426667-10.24 104.106667 39.253334 30.72-8.533333 63.146667-11.946667 95.573333-11.946667 32.426667 0 64.853333 5.12 95.573333 11.946667 73.386667-49.493333 104.106667-39.253333 104.106667-39.253334 20.48 52.906667 8.533333 90.453333 3.413333 100.693334 23.893333 27.306667 39.253333 59.733333 39.253334 102.4 0 145.066667-88.746667 177.493333-174.08 187.733333 13.653333 11.946667 25.6 34.133333 25.6 69.973333v104.106667c0 3.413333 1.706667 6.826667 6.826666 11.946667 5.12 6.826667 3.413333 18.773333-3.413333 23.893333-3.413333 1.706667-6.826667 3.413333-10.24 3.413333h-174.08c-10.24 0-17.066667-6.826667-17.066667-17.066666 0-5.12 1.706667-8.533333 3.413334-10.24z" fill="#FCFCFC"></path></svg></div></a></div></div><div id="blog-layout"><div id="main"><h1 class="x-title">Python面向对象编程</h1><p class="x-p">本文对面向对象的基本理论（为什么要有类、什么是属性、什么是方法等）不多做解释，重点在Python中的编程实现。</p><h2 class="x-h1">基本操作</h2><h3 class="x-h2">定义一个类</h3><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 48px,var(--bg-transparent-golden) 48px 168px,transparent 168px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token comment"># 初始化方法/构造函数</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 实例属性</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token comment"># 实例方法</span>
    <span class="token keyword">def</span> <span class="token function">sayhi</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"hi, I'm </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u2 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u2"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

u1<span class="token punctuation">.</span>sayhi<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># Hi, I'm u1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>hp<span class="token punctuation">)</span>  <span class="token comment"># 100</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>damage<span class="token punctuation">)</span>  <span class="token comment"># 20</span>
</code></pre></div><p class="x-p">上面的代码定义了一个<code class="x-inline-highlight">Unit</code>类，这个例子中暂且理解为一个游戏中的作战单位，每个单位具有名字<code class="x-inline-highlight">name</code>、生命值<code class="x-inline-highlight">hp</code>、攻击力<code class="x-inline-highlight">damage</code>这些属性。</p><p class="x-p"><code class="x-inline-highlight">__init__</code>方法称作类的<span class="x-inline-strong">初始化方法</span>/<span class="x-inline-strong">构造函数</span>，实例本身会作为函数的第一个参数<code class="x-inline-highlight">self</code>被传入。从这个角度理解，实际上<code class="x-inline-highlight">__init__</code>方法是将传入的参数“绑定”到新创建的实例上。</p><h3 class="x-h2">类属性和实例属性</h3><p class="x-p">我们在类下直接定义了一个属性<code class="x-inline-highlight">utype</code>，它是一个<code class="x-inline-highlight">类属性</code>；与之对应的是<code class="x-inline-highlight">__init__</code>方法为实例创建的属性，我们称之为<code class="x-inline-highlight">实例属性</code>。</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 48px,var(--bg-transparent-golden) 48px 72px,transparent 72px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token comment"># 类属性，占用同一块地址</span>
    utype <span class="token operator">=</span> <span class="token string">"unit"</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 实例属性，独属于每个实例</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token keyword">def</span> <span class="token function">sayhi</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hi, I'm %s"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u2 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u2"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">访问实例属性时，把它们当作普通变量就好了；实例属性也可以在<code class="x-inline-highlight">__init__</code>方法之外动态的添加。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>hp<span class="token punctuation">)</span>  <span class="token comment"># 100</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>damage<span class="token punctuation">)</span>  <span class="token comment"># 20</span>
u1<span class="token punctuation">.</span>level <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>level<span class="token punctuation">)</span>  <span class="token comment"># 1</span>
</code></pre></div><p class="x-p">类属性可以在类上取得，也可以在实例上取得。类属性共享内存地址。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>Unit<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u1<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u2<span class="token punctuation">.</span>utype<span class="token punctuation">)</span>  <span class="token comment"># unit unit unit</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>Unit<span class="token punctuation">.</span>utype<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2197356757808</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>utype<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 2197356757808</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>u2<span class="token punctuation">.</span>utype<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 2197356757808</span>
</code></pre></div><p class="x-p">由于共享内存地址，因此修改类属性具有全局性：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">Unit<span class="token punctuation">.</span>utype <span class="token operator">=</span> <span class="token string">"spell"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Unit<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u1<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u2<span class="token punctuation">.</span>utype<span class="token punctuation">)</span>  <span class="token comment"># spell spell spell</span>
</code></pre></div><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">注意</h4><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">u1<span class="token punctuation">.</span>utype <span class="token operator">=</span> <span class="token string">"hero"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Unit<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u1<span class="token punctuation">.</span>utype<span class="token punctuation">,</span> u2<span class="token punctuation">.</span>utype<span class="token punctuation">)</span>  <span class="token comment"># spell hero spell</span>
</code></pre></div><p class="x-p">如果同样的属性名称同时出现在实例和类中，则属性查找会优先选择实例属性。上面的例子相当于给<code class="x-inline-highlight">u1</code>添加了一个与类属性同名实例属性，<code class="x-inline-highlight">u1.utype</code>访问到的不是类属性。</p><p class="x-p">要想访问<code class="x-inline-highlight">u1</code>的类属性，可以通过<code class="x-inline-highlight">__class__</code>访问：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>utype<span class="token punctuation">)</span>  <span class="token comment"># spell</span></code></pre></div></div><h2 class="x-h1">继承</h2><h3 class="x-h2">实现一个子类</h3><p class="x-p">我们还是定义一个<code class="x-inline-highlight">Unit</code>类，并实现两个方法：<code class="x-inline-highlight">info</code>用于输出自身基本信息，<code class="x-inline-highlight">attack</code>模拟攻击另一个单位。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"name: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, hp: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>hp<span class="token punctuation">}</span></span><span class="token string">, damage: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>damage<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
        unit<span class="token punctuation">.</span>hp <span class="token operator">-=</span> self<span class="token punctuation">.</span>damage
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> attacks </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">.hp = </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>hp<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">现在我们希望实现一个<code class="x-inline-highlight">GroundUnit</code>类，表示地面单位，并且地面单位具有特有的伤害加成，用属性<code class="x-inline-highlight">buff</code>定义。显然，会有大量的逻辑与<code class="x-inline-highlight">Unit</code>类是重复的。这时可以通过继承来实现：</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 48px,var(--bg-transparent-golden) 48px 72px,transparent 72px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">GroundUnit</span><span class="token punctuation">(</span>Unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">,</span> buff<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span>
        <span class="token comment"># 子类新增的实例属性</span>
        self<span class="token punctuation">.</span>buff <span class="token operator">=</span> buff

    <span class="token comment"># 重写父类方法</span>
    <span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
        unit<span class="token punctuation">.</span>hp <span class="token operator">-=</span> self<span class="token punctuation">.</span>damage <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>buff<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> attacks </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">.hp = </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>hp<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

gu1 <span class="token operator">=</span> GroundUnit<span class="token punctuation">(</span><span class="token string">"gu1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span>
gu2 <span class="token operator">=</span> GroundUnit<span class="token punctuation">(</span><span class="token string">"gu2"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span>

gu2<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># name: gu2, hp: 200, damage: 10</span>
gu1<span class="token punctuation">.</span>attack<span class="token punctuation">(</span>gu2<span class="token punctuation">)</span>  <span class="token comment"># gu1 attacks gu2, gu2.hp = 176.0</span>
gu2<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># name: gu2, hp: 176.0, damage: 10</span>
</code></pre></div><p class="x-p">定义类时，用<code class="x-inline-highlight">class 子类(父类):</code>表示继承。如果子类有自己的构造函数，会覆盖父类的构造函数；否则会继承父类的构造函数。</p><p class="x-p">代码中<code class="x-inline-highlight">super()</code>函数可以找到父类，高亮的代码等价于<code class="x-inline-highlight">Unit.__init__(self, name, hp, damage)</code>。</p><p class="x-p">如果子类需要对父类的方法进行重写，只需要在子类下定义同名方法，然后重写逻辑。其他父类的方法会被继承到子类中，例如这个例子中的<code class="x-inline-highlight">info()</code>。</p><h3 class="x-h2">isinstance函数</h3><p class="x-p"><code class="x-inline-highlight">isinstance(实例,类)</code>可以判断一个实例是否属于给定的类。<span class="x-inline-strong">子类的实例同时也是父类的实例</span>。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
gu1 <span class="token operator">=</span> GroundUnit<span class="token punctuation">(</span><span class="token string">"gu1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>u1<span class="token punctuation">,</span> Unit<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>u1<span class="token punctuation">,</span> GroundUnit<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>gu1<span class="token punctuation">,</span> Unit<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>gu1<span class="token punctuation">,</span> GroundUnit<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><h3 class="x-h2">多继承</h3><p class="x-p">假设我们的游戏复杂起来，引入了稀有度系统，每个单位有一个所属的稀有度，例如普通、稀有、史诗、传奇等等。以史诗级为例，假设对于这些不同稀有度的单位有着其他独特的机制，以至于我们不得不新创建一个<code class="x-inline-highlight">EpicRarity</code>类：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EpicRarity</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> level<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>level <span class="token operator">=</span> level

    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"This is a lv.</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>level<span class="token punctuation">}</span></span><span class="token string"> epic unit"</span></span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">当然，为了便于演示，我们只定义了一个<code class="x-inline-highlight">level</code>属性和<code class="x-inline-highlight">info</code>方法。</p><p class="x-p">现在，我们想实现<code class="x-inline-highlight">EpicGroundUnit</code>子类，表示史诗级地面单位。显然它需要同时继承父类<code class="x-inline-highlight">EpicRarity</code>和<code class="x-inline-highlight">GroundUnit</code>，这就是<span class="x-inline-strong">多继承</span>。</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 48px,var(--bg-transparent-golden) 48px 96px,transparent 96px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EpicGroundUnit</span><span class="token punctuation">(</span>EpicRarity<span class="token punctuation">,</span> GroundUnit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">,</span> buff<span class="token punctuation">,</span> level<span class="token punctuation">)</span><span class="token punctuation">:</span>
        GroundUnit<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">,</span> buff<span class="token punctuation">)</span>
        EpicRarity<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> level<span class="token punctuation">)</span>

egu1 <span class="token operator">=</span> EpicGroundUnit<span class="token punctuation">(</span><span class="token string">"egu1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

egu1<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># This is a lv.1 epic unit</span>
</code></pre></div><p class="x-p">在构造函数中我们需要分别对父类进行初始化。</p><p class="x-p">注意到两个父类都实现了<code class="x-inline-highlight">info</code>方法并且没有被子类重写。调用之后我们发现，子类继承的是<code class="x-inline-highlight">EpicRarity</code>的<code class="x-inline-highlight">info</code>方法。如果代码改写为：</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 0,var(--bg-transparent-golden) 0 24px,transparent 24px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">EpicGroundUnit</span><span class="token punctuation">(</span>GroundUnit<span class="token punctuation">,</span> EpicRarity<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">,</span> buff<span class="token punctuation">,</span> level<span class="token punctuation">)</span><span class="token punctuation">:</span>
        GroundUnit<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">,</span> buff<span class="token punctuation">)</span>
        EpicRarity<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> level<span class="token punctuation">)</span>

egu1 <span class="token operator">=</span> EpicGroundUnit<span class="token punctuation">(</span><span class="token string">"egu1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

egu1<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># name: egu1, hp: 100, damage: 20</span>
</code></pre></div><p class="x-p">就会发现，调换父类的顺序后，现在子类继承的是<code class="x-inline-highlight">GroundUnit</code>的<code class="x-inline-highlight">info</code>方法。这就引出了下一节的内容：<span class="x-inline-strong">方法解析顺序</span>。</p><h3 class="x-h2">方法解析顺序MRO</h3><p class="x-p">对于多继承情况下的同名方法，如何从父类中找应该优先使用哪个父类的方法就叫<span class="x-inline-strong">方法解析顺序</span><code class="x-inline-highlight">(Method Resolution Order, MRO)</code>。 Python采用<a href="https://zh.wikipedia.org/zh-cn/C3%E7%BA%BF%E6%80%A7%E5%8C%96" class="x-inline-link" rel="noreferrer" target="_blank">C3线性化</a>算法来计算线性化列表，保证继承顺序列表中每个类只出现一次。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">D</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

obj <span class="token operator">=</span> D<span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>test<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># A</span>
</code></pre></div><p class="x-p">上述代码描述了一个如下图所示的复杂继承关系：</p><div class="x-image-wrapper x-image-invert"><img alt="img" loading="lazy" src="/static/media/mro.bb5e770ac228aa1402f6.jpg" width="300px"></div><p class="x-p">可以通过<code class="x-inline-highlight">mro()</code>函数得到类的方法解析顺序：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># 注意是类名，不是实例名</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>D<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [&lt;class '__main__.D'>, &lt;class '__main__.C'>, &lt;class '__main__.A'>, &lt;class '__main__.B'>, &lt;class 'object'>]</span>
</code></pre></div><p class="x-p">输出的列表中，从左到右的顺序为查找方法的顺序。上述例子中，<code class="x-inline-highlight">D</code>和<code class="x-inline-highlight">C</code>类都没有定义<code class="x-inline-highlight">test</code>方法，因此顺次使用了<code class="x-inline-highlight">A</code>类的<code class="x-inline-highlight">test</code>方法。</p><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">注意</h4><p class="x-p">MRO顺序不是简单的深度优先或广度优先！</p></div><h2 class="x-h1">封装</h2><p class="x-p">在前面<code class="x-inline-highlight">Unit</code>类的例子中，我们可以通过直接访问<code class="x-inline-highlight">u1.hp</code>修改其值，这样并不安全（这岂不是像外挂一样）！<span class="x-inline-strong">封装</span>的目的是为了保护数据，不让外部直接访问和修改。在Python中，约定通过在属性名称前加两个下划线<code class="x-inline-highlight">__</code>来将属性私有化。这种命名约定会使Python解释器修改变量名为<code class="x-inline-highlight">_类名__属性名</code>的形式，使其在类外部变得难以访问。</p><h3 class="x-h2">将实例属性私有化</h3><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 96px,var(--bg-transparent-golden) 96px 144px,transparent 144px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token comment"># 私有属性</span>
        self<span class="token punctuation">.</span>__hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>__damage <span class="token operator">=</span> damage

    <span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
        unit<span class="token punctuation">.</span>__hp <span class="token operator">-=</span> self<span class="token punctuation">.</span>__damage
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> attacks </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">.__hp = </span><span class="token interpolation"><span class="token punctuation">{</span>unit<span class="token punctuation">.</span>__hp<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># 通过公有方法访问私有属性</span>
    <span class="token keyword">def</span> <span class="token function">get_hp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__hp
</code></pre></div><p class="x-p">在定义私有属性后，对外开放一个公有方法<code class="x-inline-highlight">get_hp</code>，通过这个公有方法可以间接的访问到<code class="x-inline-highlight">__hp</code>属性。这样相当于让此属性对外部“只读”。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>get_hp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 100</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>__hp<span class="token punctuation">)</span>  <span class="token comment"># AttributeError: 'Unit' object has no attribute '__hp'</span>
</code></pre></div><p class="x-p">通过<code class="x-inline-highlight">_类名__属性名</code>的形式可以强制访问私有属性：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>_Unit__hp<span class="token punctuation">)</span>  <span class="token comment"># 100</span></code></pre></div><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">注意</h4><p class="x-p">在类外绑定的双下划线变量是公有的。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">u1<span class="token punctuation">.</span>__var <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>__var<span class="token punctuation">)</span>  <span class="token comment"># 1</span>
</code></pre></div></div><h3 class="x-h2">类比于C++</h3><p class="x-p no-margin-bottom">C++中的封装有三种：<code class="x-inline-highlight">public</code>、<code class="x-inline-highlight">protected</code>、<code class="x-inline-highlight">private</code>；Python中没有这些关键字，但是可以通过属性名命名约定来实现。</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">public</code>：公有变量，可以在<span class="x-inline-strong">类的内部和外部</span>访问，正常命名即可。</p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">protected</code>：保护变量，只能在<span class="x-inline-strong">类内和子类</span>访问，属性名前加单下划线<code class="x-inline-highlight">_</code>。这只是一种命名约定，实际上是可以访问的。</p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">private</code>：私有变量，只能在<span class="x-inline-strong">类的内部</span>访问，属性名前加双下划线<code class="x-inline-highlight">__</code>，这样会使Python解释器修改变量名为<code class="x-inline-highlight">_类名__属性名</code>的形式。</p></div></div><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 公有变量</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        <span class="token comment"># 保护变量</span>
        self<span class="token punctuation">.</span>_y <span class="token operator">=</span> y
        <span class="token comment"># 私有变量</span>
        self<span class="token punctuation">.</span>__z <span class="token operator">=</span> z

<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">info_x</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"x: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">info_y</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"y: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>_y<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">info_z</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"z: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>__z<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

b <span class="token operator">=</span> B<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
b<span class="token punctuation">.</span>info_x<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># x: 1</span>
b<span class="token punctuation">.</span>info_y<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># y: 2</span>
b<span class="token punctuation">.</span>info_z<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># AttributeError: 'B' object has no attribute '_B__z'. Did you mean: '_A__z'?</span>
</code></pre></div><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">注意</h4><p class="x-p">C++中的<code class="x-inline-highlight">protected</code>关键字是一种严格的访问控制机制，而Python中的单下划线变量只是一种命名约定，不具有强制性，实际上是可以访问的。只不过有时违反了这样的约定时，有些代码编辑器会给出警告。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>_y<span class="token punctuation">)</span>  <span class="token comment"># 2</span></code></pre></div></div><h2 class="x-h1">多态</h2><h3 class="x-h2">举个例子</h3><p class="x-p">多态是当一个类继承自另一个类并重写了其方法时，可以在不改变原有接口的情况下，根据对象的实际类型来调用不同的方法实现。这听起来有些复杂，我们来举一个具体的例子：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"name: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, hp: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>hp<span class="token punctuation">}</span></span><span class="token string">, damage: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>damage<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">GroundUnit</span><span class="token punctuation">(</span>Unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is a ground unit."</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">AirUnit</span><span class="token punctuation">(</span>Unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is an air unit."</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">show_info</span><span class="token punctuation">(</span>unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    unit<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>

gu1 <span class="token operator">=</span> GroundUnit<span class="token punctuation">(</span><span class="token string">"gu1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
au1 <span class="token operator">=</span> AirUnit<span class="token punctuation">(</span><span class="token string">"au1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
show_info<span class="token punctuation">(</span>gu1<span class="token punctuation">)</span>  <span class="token comment"># This is a ground unit.</span>
show_info<span class="token punctuation">(</span>au1<span class="token punctuation">)</span>  <span class="token comment"># This is an air unit.</span>
</code></pre></div><p class="x-p">这个例子中，<code class="x-inline-highlight">show_info</code>函数接受一个<code class="x-inline-highlight">Unit</code>类型的参数，但是我们传入的是其子类<code class="x-inline-highlight">GroundUnit</code>和<code class="x-inline-highlight">AirUnit</code>类型的实例。子类重写了父类的<code class="x-inline-highlight">info</code>方法，相当于共用了父类的接口，但是子类又通过继承重写了接口，从而实现了不同的功能。</p><h3 class="x-h2">通过抽象类实现多态</h3><p class="x-p"><span class="x-inline-strong">抽象类</span>是指包含<span class="x-inline-strong">抽象方法</span>的类；抽象类只能被继承，不能被实例化。<br>抽象方法是指只有声明，没有实现的方法，它存在的意义是让子类重写这个方法。</p><p class="x-p">上面的例子中，如果我们将<code class="x-inline-highlight">Unit</code>类的<code class="x-inline-highlight">info</code>方法定义为：</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 168px,var(--bg-transparent-golden) 168px 216px,transparent 216px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token comment"># 这是一个抽象方法，子类必须重写这个方法，否则在调用时会报错</span>
    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> NotImplementedError<span class="token punctuation">(</span><span class="token string">"Subclasses must implement abstract method."</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">这时子类如果没有重写<code class="x-inline-highlight">info</code>方法，就会继承父类中的方法，在调用的时候就会报错。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">UnitWithoutInfo</span><span class="token punctuation">(</span>Unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

u <span class="token operator">=</span> UnitWithoutInfo<span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># NotImplementedError: Subclasses must implement abstract method.</span>
</code></pre></div><h3 class="x-h2">Python中的abc模块</h3><p class="x-p">Python的<code class="x-inline-highlight">abc</code>模块中定义了<span class="x-inline-strong">抽象基类</span><code class="x-inline-highlight">ABC (Abstract Base Classes)</code>，可以强制其子类必须实现某些方法。</p><p class="x-p">上面的例子使用<code class="x-inline-highlight">abc</code>模块可以改写为：</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 0,var(--bg-transparent-golden) 0 24px,transparent 24px,transparent 48px,var(--bg-transparent-golden) 48px 72px,transparent 72px,transparent 192px,var(--bg-transparent-golden) 192px 264px,transparent 264px)"><code class="language-python"><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABC<span class="token punctuation">,</span> abstractmethod

<span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
</code></pre></div><p class="x-p">这时子类如果没有重写<code class="x-inline-highlight">info</code>方法，在实例化时就会报错！</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">UnitWithoutInfo</span><span class="token punctuation">(</span>Unit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># 在实例化时就会报错</span>
u <span class="token operator">=</span> UnitWithoutInfo<span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># TypeError: Can't instantiate abstract class UnitWithoutInfo with abstract method info</span>
</code></pre></div><h2 class="x-h1">三大方法</h2><h3 class="x-h2">类方法</h3><p class="x-p">类方法用修饰器<code class="x-inline-highlight">@classmethod</code>定义，传入的第一个参数是类本身而不是实例，通常命名为<code class="x-inline-highlight">cls</code>。通过它可以访问到类属性。</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 192px,var(--bg-transparent-golden) 192px 288px,transparent 288px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    utype <span class="token operator">=</span> <span class="token string">"unit"</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">show_type</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 可以访问到类属性</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"This is a </span><span class="token interpolation"><span class="token punctuation">{</span>cls<span class="token punctuation">.</span>utype<span class="token punctuation">}</span></span><span class="token string">."</span></span><span class="token punctuation">)</span>

u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u1<span class="token punctuation">.</span>show_type<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># This is a unit.</span>
</code></pre></div><h4 class="x-h3">类方法的应用：自动计算实例数</h4><p class="x-p">假如我们希望每创建一个类时，都可以自动计数当前类的实例数量。这个功能可以由类方法实现。</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 192px,var(--bg-transparent-golden) 192px 216px,transparent 216px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">"unit"</span>
    __unit_num <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># 声明为私有类属性</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage
        self<span class="token punctuation">.</span>add_unit_num<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">add_unit_num</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cls<span class="token punctuation">.</span>__unit_num <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">get_unit_num</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>__unit_num

u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u2 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u2"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>get_unit_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u2<span class="token punctuation">.</span>get_unit_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>

u3 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u3"</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u3<span class="token punctuation">.</span>get_unit_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Unit<span class="token punctuation">.</span>get_unit_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre></div><p class="x-p">我们在<code class="x-inline-highlight">__init__</code>方法中调用一次类方法<code class="x-inline-highlight">add_unit_num()</code>，就可以把总实例数统计到类属性<code class="x-inline-highlight">__unit_num</code>中。</p><h3 class="x-h2">静态方法</h3><p class="x-p">静态方法用修饰器<code class="x-inline-highlight">@staticmethod</code>定义。静态方法不能访问类属性，也不能访问实例属性。静态方法可以在类的命名空间内定义一些功能性代码，通常用于实现一些与类相关的工具函数。</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 192px,var(--bg-transparent-golden) 192px 264px,transparent 264px)"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Unit</span><span class="token punctuation">:</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> <span class="token string">"unit"</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>hp <span class="token operator">=</span> hp
        self<span class="token punctuation">.</span>damage <span class="token operator">=</span> damage

    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">calc_hp_after_attack</span><span class="token punctuation">(</span>hp<span class="token punctuation">,</span> damage<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 没有隐式的第一参数</span>
        <span class="token keyword">return</span> hp <span class="token operator">-</span> damage

u1 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u1"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
u2 <span class="token operator">=</span> Unit<span class="token punctuation">(</span><span class="token string">"u2"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>u1<span class="token punctuation">.</span>calc_hp_after_attack<span class="token punctuation">(</span>u1<span class="token punctuation">.</span>hp<span class="token punctuation">,</span> u2<span class="token punctuation">.</span>damage<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 90</span>
</code></pre></div><h3 class="x-h2">属性方法</h3><p class="x-p">属性方法以方法的形式定义，但是可以像属性一样进行访问，其作用是支持对属性的灵活操作。</p><p class="x-p">属性方法相当于允许更细致的设置一个属性的<span class="x-inline-strong">访问</span>、<span class="x-inline-strong">更改</span>、<span class="x-inline-strong">删除</span>操作，具体的做法是：实现属性的<code class="x-inline-highlight">getter</code>、<code class="x-inline-highlight">setter</code>、<code class="x-inline-highlight">deleter</code>方法。</p><p class="x-p">假设我们有这样的需求：定义一个<code class="x-inline-highlight">Circle</code>类，它具有直径<code class="x-inline-highlight">diameter</code>和半径<code class="x-inline-highlight">radius</code>两个属性。我们希望修改其中一个属性时，另外一个属性也随之变化。也就是：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python">circle <span class="token operator">=</span> Circle<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>radius<span class="token punctuation">)</span>  <span class="token comment"># 5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>diameter<span class="token punctuation">)</span>  <span class="token comment"># 10</span>

circle<span class="token punctuation">.</span>diameter <span class="token operator">=</span> <span class="token number">14</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>radius<span class="token punctuation">)</span>  <span class="token comment"># 7.0</span>

circle<span class="token punctuation">.</span>radius <span class="token operator">=</span> <span class="token number">12</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>diameter<span class="token punctuation">)</span>  <span class="token comment"># 24</span>
</code></pre></div><p class="x-p">用此前的知识似乎无法实现这样的功能，但属性方法可以解决：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Circle</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> radius<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>__radius <span class="token operator">=</span> radius
        self<span class="token punctuation">.</span>__diameter <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> radius

    <span class="token comment"># 属性的getter方法</span>
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">radius</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__radius

    <span class="token comment"># 属性的setter方法</span>
    <span class="token decorator annotation punctuation">@radius<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">radius</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>__radius <span class="token operator">=</span> value
        self<span class="token punctuation">.</span>__diameter <span class="token operator">=</span> value <span class="token operator">*</span> <span class="token number">2</span>

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">diameter</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__diameter

    <span class="token decorator annotation punctuation">@diameter<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">diameter</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>__diameter <span class="token operator">=</span> value
        self<span class="token punctuation">.</span>__radius <span class="token operator">=</span> value <span class="token operator">*</span> <span class="token number">0.5</span>
</code></pre></div><p class="x-p">将访问、修改属性的操作定义为函数，就允许了我们除了获取、修改变量本身之外，还可以做一些其他的手脚。</p><p class="x-p">上面的例子没有体现属性的<code class="x-inline-highlight">deleter</code>方法。它的一般实现可以是：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Circle</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment"># 属性的deleter方法</span>
    <span class="token decorator annotation punctuation">@radius<span class="token punctuation">.</span>deleter</span>
    <span class="token keyword">def</span> <span class="token function">radius</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"delete radius"</span><span class="token punctuation">)</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>__radius

    <span class="token decorator annotation punctuation">@diameter<span class="token punctuation">.</span>deleter</span>
    <span class="token keyword">def</span> <span class="token function">diameter</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"delete diameter"</span><span class="token punctuation">)</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>__diameter

<span class="token keyword">del</span> circle<span class="token punctuation">.</span>diameter  <span class="token comment"># delete diameter</span>
<span class="token comment"># print(circle.diameter)  # AttributeError: 'Circle' object has no attribute '_Circle__diameter'</span>
</code></pre></div><h2 class="x-h1">反射</h2><h3 class="x-h2">Python中的反射</h3><p class="x-p">在计算机科学中<span class="x-inline-strong">反射</span><code class="x-inline-highlight">(reflection)</code>是指计算机程序在运行时可以检查、访问、和修改它本身状态或行为的一种能力。表现在Python面向对象编程中有四个内置函数：<code class="x-inline-highlight">getattr()</code>、<code class="x-inline-highlight">setattr()</code>、<code class="x-inline-highlight">hasattr()</code>和<code class="x-inline-highlight">delattr()</code>，可以通过字符串的形式操作对象的属性和方法。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>z <span class="token operator">=</span> z

    <span class="token keyword">def</span> <span class="token function">info_x</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"x: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">info_y</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"y: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">info_z</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"z: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>z<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">hasattr()</code>函数用于判断对象是否包含对应的属性或方法：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hasattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hasattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"info_x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hasattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"info_w"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">getattr()</code>函数用于获取对象的属性或方法：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 10</span>
info_x <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"info_x"</span><span class="token punctuation">)</span>
info_x<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># x: 10</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">setattr()</code>函数用于设置对象的属性或方法：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token builtin">setattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 100</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">delattr()</code>函数用于删除对象的属性或方法：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token builtin">delattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># AttributeError: 'A' object has no attribute 'y'</span>
</code></pre></div><h3 class="x-h2">反射的应用</h3><p class="x-p">假如我们现在想创建一个类<code class="x-inline-highlight">A2Z</code>，它具有<code class="x-inline-highlight">a</code>-<code class="x-inline-highlight">z</code><code class="x-inline-highlight">26</code>个属性与<code class="x-inline-highlight">info_a()</code>到<code class="x-inline-highlight">info_z()</code><code class="x-inline-highlight">26</code>个方法，手动创建这些属性和方法是非常繁琐的。这时我们可以利用反射来动态的创建它们：</p><div class="x-codeblock"><pre class="language-python" tabindex="0" style="background:linear-gradient(180deg,transparent 216px,var(--bg-transparent-golden) 216px 240px,transparent 240px,transparent 360px,var(--bg-transparent-golden) 360px 384px,transparent 384px)"><code class="language-python">a_to_z <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span>

<span class="token keyword">class</span> <span class="token class-name">A2Z</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

a2z <span class="token operator">=</span> A2Z<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> ch <span class="token keyword">in</span> a_to_z<span class="token punctuation">:</span>
    <span class="token comment"># 动态的创建属性</span>
    <span class="token builtin">setattr</span><span class="token punctuation">(</span>a2z<span class="token punctuation">,</span> ch<span class="token punctuation">,</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 动态的创建方法</span>
    <span class="token keyword">def</span> <span class="token function">info_ch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>ch<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>a2z<span class="token punctuation">,</span> ch<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token builtin">setattr</span><span class="token punctuation">(</span>a2z<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"info_</span><span class="token interpolation"><span class="token punctuation">{</span>ch<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> info_ch<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>a2z<span class="token punctuation">.</span>d<span class="token punctuation">)</span>  <span class="token comment"># 4</span>
a2z<span class="token punctuation">.</span>info_z<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># z: 26</span>
</code></pre></div><h2 class="x-h1">魔术方法</h2><p class="x-p">魔术方法通常以双下划线包围，用于实现类的特殊行为。下面以一个<code class="x-inline-highlight">Vector3d</code>类为例，介绍一些常用的魔术方法。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>z <span class="token operator">=</span> z

v1 <span class="token operator">=</span> Vector3d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
v2 <span class="token operator">=</span> Vector3d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">__len__</h3><p class="x-p"><code class="x-inline-highlight">len(obj)</code>时调用。<code class="x-inline-highlight">__len__</code>方法的返回值只能是整数。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">3</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre></div><h3 class="x-h2">__repr__和__str__</h3><p class="x-p"><code class="x-inline-highlight">__repr__</code>方法的返回值应该是一个<span class="x-inline-strong">可以用来重新创建对象</span>的字符串。<br><code class="x-inline-highlight">__str__</code>方法在<code class="x-inline-highlight">str(obj)</code>时调用，应当返回实例格式良好、可读性强的字符串表示。</p><p class="x-p">在<code class="x-inline-highlight">print(obj)</code>时会优先使用<code class="x-inline-highlight">__str__</code>方法的返回值，如果没有定义<code class="x-inline-highlight">__str__</code>方法，则会使用<code class="x-inline-highlight">__repr__</code>方法。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Vector3d(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>z<span class="token punctuation">}</span></span><span class="token string">)"</span></span>

    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>z<span class="token punctuation">}</span></span><span class="token string">)"</span></span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># (3, 4, 5)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Vector3d(3, 4, 5)</span>
<span class="token comment"># 会优先调用__str__方法</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span>  <span class="token comment"># (3, 4, 5)</span>
</code></pre></div><h3 class="x-h2">__call__</h3><p class="x-p"><code class="x-inline-highlight">__call__</code>方法使得实例可以像函数一样被调用。</p><p class="x-p">这个例子中我们约定，调用<code class="x-inline-highlight">obj(x, y, z)</code>时设置向量的<code class="x-inline-highlight">x</code>，<code class="x-inline-highlight">y</code>，<code class="x-inline-highlight">z</code>分量。</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>z <span class="token operator">=</span> z

v2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span>  <span class="token comment"># (2, -2, 1)</span>
</code></pre></div><h3 class="x-h2">运算符重载</h3><p class="x-p no-margin-bottom">我们为<code class="x-inline-highlight">Vector3d</code>类定义加法、减法、乘法操作。这个例子中我们约定，加减法就是普通的按元素加减，而乘法满足：</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">obj*常数</code>时返回缩放后的向量</p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">obj1*obj2</code>时返回点乘数值</p></div></div><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment"># 重载加号运算符，obj1+obj2时调用</span>
    <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Vector3d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>z <span class="token operator">+</span> other<span class="token punctuation">.</span>z<span class="token punctuation">)</span>

    <span class="token comment"># 重载减号运算符，obj1-obj2时调用</span>
    <span class="token keyword">def</span> <span class="token function">__sub__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Vector3d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>z <span class="token operator">-</span> other<span class="token punctuation">.</span>z<span class="token punctuation">)</span>

    <span class="token comment"># 重载乘号运算符</span>
    <span class="token keyword">def</span> <span class="token function">__mul__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Vector3d<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">*</span> other<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> other<span class="token punctuation">,</span> self<span class="token punctuation">.</span>z <span class="token operator">*</span> other<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>x <span class="token operator">*</span> other<span class="token punctuation">.</span>x <span class="token operator">+</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> other<span class="token punctuation">.</span>y <span class="token operator">+</span> self<span class="token punctuation">.</span>z <span class="token operator">*</span> other<span class="token punctuation">.</span>z

<span class="token keyword">print</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span>  <span class="token comment"># (3, 4, 5)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span>  <span class="token comment"># (2, -2, 1)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1 <span class="token operator">+</span> v2<span class="token punctuation">)</span>  <span class="token comment"># (5, 2, 6)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1 <span class="token operator">-</span> v2<span class="token punctuation">)</span>  <span class="token comment"># (1, 6, 4)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1 <span class="token operator">*</span> v2<span class="token punctuation">)</span>  <span class="token comment"># 3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>v1 <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># (6, 8, 10)</span>
</code></pre></div><h3 class="x-h2">反运算</h3><p class="x-p">如果只有上述运算符重载，下面的代码会报错：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> v1<span class="token punctuation">)</span>  <span class="token comment"># TypeError: unsupported operand type(s) for *: 'int' and 'Vector3d'</span></code></pre></div><p class="x-p">解决这个问题需要定义乘法的反运算<code class="x-inline-highlight">__rmul__</code>：</p><div class="x-codeblock"><pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Vector3d</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">__rmul__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__mul__<span class="token punctuation">(</span>other<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> v1<span class="token punctuation">)</span>  <span class="token comment"># (6, 8, 10)</span>
</code></pre></div></div><div id="sidebar"><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">网络杂识 (4)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/23d/database-3nf/" class="sidebar-list-link"><span class="sidebar-list-title">数据库设计三大范式</span></a></li><li class="sidebar-list-li"><a href="/23d/github-linguist-vendored/" class="sidebar-list-link"><span class="sidebar-list-title">不统计Github仓库某个目录下的语言</span></a></li><li class="sidebar-list-li"><a href="/24a/deepl-shortcut-setting/" class="sidebar-list-link"><span class="sidebar-list-title">解决：DeepL该快捷键已被使用</span></a></li><li class="sidebar-list-li"><a href="/24a/git-merge-allow-unrelated-histories/" class="sidebar-list-link"><span class="sidebar-list-title">记录：使用--allow-unrelated-histories</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">深度学习 (5)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/longtime/papers/" class="sidebar-list-link"><span class="sidebar-list-title">论文速记</span></a></li><li class="sidebar-list-li"><a href="/23d/r2plus1d/" class="sidebar-list-link"><span class="sidebar-list-title">行为识别R(2+1)D网络</span></a></li><li class="sidebar-list-li"><a href="/23d/object-detection-map/" class="sidebar-list-link"><span class="sidebar-list-title">目标检测评价指标mAP</span></a></li><li class="sidebar-list-li"><a href="/23d/learn-rnn-lstm/" class="sidebar-list-link"><span class="sidebar-list-title">学习RNN和LSTM</span></a></li><li class="sidebar-list-li"><a href="/24a/reproduce-nerf-rpn/" class="sidebar-list-link"><span class="sidebar-list-title">记录：复现NeRF-RPN代码</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">Python学习 (2)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/24a/torch-numpy-topk/" class="sidebar-list-link"><span class="sidebar-list-title">在pytorch和numpy中取top-k值和索引</span></a></li><li class="sidebar-list-li active"><a href="/24a/object-oriented-programming-python/" class="sidebar-list-link"><span class="sidebar-list-title">Python面向对象编程</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">前端与JavaScript (2)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/23c/js-array/" class="sidebar-list-link"><span class="sidebar-list-title">JavaScript数组常用方法</span></a></li><li class="sidebar-list-li"><a href="/23d/css-auto-height-transition/" class="sidebar-list-link"><span class="sidebar-list-title">CSS实现auto高度的过渡动画</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">课程 (10)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/23c/pattern-recognition-1/" class="sidebar-list-link"><span class="sidebar-list-title">【模式识别】统计决策方法</span></a></li><li class="sidebar-list-li"><a href="/23c/pattern-recognition-2/" class="sidebar-list-link"><span class="sidebar-list-title">【模式识别】参数估计</span></a></li><li class="sidebar-list-li"><a href="/23c/pattern-recognition-3/" class="sidebar-list-link"><span class="sidebar-list-title">【模式识别】非参数估计</span></a></li><li class="sidebar-list-li"><a href="/23d/pattern-recognition-4/" class="sidebar-list-link"><span class="sidebar-list-title">【模式识别】线性学习器与线性分类器</span></a></li><li class="sidebar-list-li"><a href="/23d/protocols/" class="sidebar-list-link"><span class="sidebar-list-title">【计算机网络】协议总结</span></a></li><li class="sidebar-list-li"><a href="/24a/machine-learning-exercises/" class="sidebar-list-link"><span class="sidebar-list-title">【机器学习】习题</span></a></li><li class="sidebar-list-li"><a href="/24a/games101-01-transformation/" class="sidebar-list-link"><span class="sidebar-list-title">【GAMES101】Transformation</span></a></li><li class="sidebar-list-li"><a href="/24a/games101-02-rasterization/" class="sidebar-list-link"><span class="sidebar-list-title">【GAMES101】Rasterization</span></a></li><li class="sidebar-list-li"><a href="/24a/games101-03-shading/" class="sidebar-list-link"><span class="sidebar-list-title">【GAMES101】Shading</span></a></li><li class="sidebar-list-li"><a href="/24a/games101-04-geometry/" class="sidebar-list-link"><span class="sidebar-list-title">【GAMES101】Geometry</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">其他 (2)</h3><div class="sidebar-list-category-rightarrow"><svg height="16px" viewBox="0 0 1024 1024" width="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a href="/longtime/demo/" class="sidebar-list-link"><span class="sidebar-list-title">示例</span></a></li><li class="sidebar-list-li"><a href="/longtime/updates/" class="sidebar-list-link"><span class="sidebar-list-title">更新日志</span></a></li></ul></div></div></div><div id="sidebar-mask"></div><div id="contents"><h4 id="contents-header">本页目录</h4><ul><li class="titletype-x-h1 active">基本操作</li><li class="titletype-x-h2">定义一个类</li><li class="titletype-x-h2">类属性和实例属性</li><li class="titletype-x-h1">继承</li><li class="titletype-x-h2">实现一个子类</li><li class="titletype-x-h2">isinstance函数</li><li class="titletype-x-h2">多继承</li><li class="titletype-x-h2">方法解析顺序MRO</li><li class="titletype-x-h1">封装</li><li class="titletype-x-h2">将实例属性私有化</li><li class="titletype-x-h2">类比于C++</li><li class="titletype-x-h1">多态</li><li class="titletype-x-h2">举个例子</li><li class="titletype-x-h2">通过抽象类实现多态</li><li class="titletype-x-h2">Python中的abc模块</li><li class="titletype-x-h1">三大方法</li><li class="titletype-x-h2">类方法</li><li class="titletype-x-h2">静态方法</li><li class="titletype-x-h2">属性方法</li><li class="titletype-x-h1">反射</li><li class="titletype-x-h2">Python中的反射</li><li class="titletype-x-h2">反射的应用</li><li class="titletype-x-h1">魔术方法</li><li class="titletype-x-h2">__len__</li><li class="titletype-x-h2">__repr__和__str__</li><li class="titletype-x-h2">__call__</li><li class="titletype-x-h2">运算符重载</li><li class="titletype-x-h2">反运算</li></ul></div></div></div></body></html>