<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/8ac0b0e7f508d966.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/c84b60895b980f14.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/f70c26425a044d6b.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-18ff650738e257e6.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-317889f780d115a2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/472-d5046572d4bcdf16.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-cfdfd0e1c1afc4e3.js" async="" crossorigin=""></script><script src="/_next/static/chunks/app/layout-e12e822557cc964c.js" async=""></script><script src="/_next/static/chunks/176-6509553bec92a789.js" async=""></script><script src="/_next/static/chunks/app/(blogs)/layout-5b0a8ec95aac1a42.js" async=""></script><script src="/_next/static/chunks/d3ac728e-1e5d8b71e3d43fec.js" async=""></script><script src="/_next/static/chunks/202-7b9f876bcb1bf7b4.js" async=""></script><script src="/_next/static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js" async=""></script><title>Create Next App</title><meta name="description" content="Generated by create next app"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div id="header" class=""><div id="header-left-wrapper"><div id="header-logo-bg"><svg viewBox="0 0 1560 1560" width="36px" height="36px" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="M644 97h272.529L1189 780H916.471z" fill="#00A8C4"></path><path d="M98 97h272.84L780 1120.73 1189.162 97H1462L916.438 1462H643.562z" fill="#30303C"></path><path d="M98 1462L643.3 97H916L370.7 1462z" fill="#00F8FF"></path></g></svg></div><div id="header-archive"><h3 id="header-archive-text">归档</h3><div class="header-archive-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div></div><div id="header-right-wrapper"><div id="header-theme-bg"><svg viewBox="0 0 1024 1024" width="20px" height="20px" xmlns="http://www.w3.org/2000/svg"><path fill="#FCFCFC" d="M524.8 938.667h-4.267a439.893 439.893 0 01-313.173-134.4 446.293 446.293 0 01-11.093-597.334A432.213 432.213 0 01366.933 90.027a42.667 42.667 0 0145.227 9.386 42.667 42.667 0 0110.24 42.667 358.4 358.4 0 0082.773 375.893 361.387 361.387 0 00376.747 82.774 42.667 42.667 0 0154.187 55.04 433.493 433.493 0 01-99.84 154.88 438.613 438.613 0 01-311.467 128z"></path></svg></div><a href="https://github.com/1kuzus/1kuzus.github.io" target="_blank" rel="noreferrer"><div id="header-github-bg"><svg viewBox="0 0 1024 1024" width="36px" height="36px" xmlns="http://www.w3.org/2000/svg"><path d="M411.306667 831.146667c3.413333-5.12 6.826667-10.24 6.826666-11.946667v-69.973333c-105.813333 22.186667-128-44.373333-128-44.373334-17.066667-44.373333-42.666667-56.32-42.666666-56.32-34.133333-23.893333 3.413333-23.893333 3.413333-23.893333 37.546667 3.413333 58.026667 39.253333 58.026667 39.253333 34.133333 58.026667 88.746667 40.96 110.933333 32.426667 3.413333-23.893333 13.653333-40.96 23.893333-51.2-85.333333-10.24-174.08-42.666667-174.08-187.733333 0-40.96 15.36-75.093333 39.253334-102.4-3.413333-10.24-17.066667-47.786667 3.413333-100.693334 0 0 32.426667-10.24 104.106667 39.253334 30.72-8.533333 63.146667-11.946667 95.573333-11.946667 32.426667 0 64.853333 5.12 95.573333 11.946667 73.386667-49.493333 104.106667-39.253333 104.106667-39.253334 20.48 52.906667 8.533333 90.453333 3.413333 100.693334 23.893333 27.306667 39.253333 59.733333 39.253334 102.4 0 145.066667-88.746667 177.493333-174.08 187.733333 13.653333 11.946667 25.6 34.133333 25.6 69.973333v104.106667c0 3.413333 1.706667 6.826667 6.826666 11.946667 5.12 6.826667 3.413333 18.773333-3.413333 23.893333-3.413333 1.706667-6.826667 3.413333-10.24 3.413333h-174.08c-10.24 0-17.066667-6.826667-17.066667-17.066666 0-5.12 1.706667-8.533333 3.413334-10.24z" fill="#FCFCFC"></path></svg></div></a></div></div><div id="blog-layout"><div id="main"><h1 class="x-title"></h1><h2 class="x-h1">说明</h2><p class="x-p">复现仓库：<a href="https://github.com/lyclyc52/NeRF_RPN" target="_blank" rel="noreferrer" class="x-inline-link">https://github.com/lyclyc52/NeRF_RPN</a></p><p class="x-p">这项研究在NeRF中引入RPN，用于3D物体检测和相关任务。作者提供了改写的Instant-NGP以供可视化3D提议框。我自己在尝试复现的时候绕了一些弯子，因此借这篇博客复盘一下当时的过程。仓库提供的脚本多为适用于linux系统的<code class="x-inline-highlight">.sh</code>文件，而我自己的设备是windows系统，因此示例中会给出适用于windows系统的相应指令。</p><h2 class="x-h1">环境相关</h2><h3 class="x-h2">克隆仓库</h3><div class="x-codeblock"><pre><code class="lang-bash">git clone https://github.com/lyclyc52/NeRF_RPN.git NeRFrpn</code></pre></div><p class="x-p">环境配置参照<a href="https://github.com/lyclyc52/NeRF_RPN" target="_blank" rel="noreferrer" class="x-inline-link">官方仓库说明文档</a>即可。</p><h3 class="x-h2">配置Instant-NGP Fork for NeRF Feature Extraction</h3><p class="x-p">作者修改了Instant-NGP的仓库，添加了一些包括可视化bbox在内的功能。说明文档在<a href="https://github.com/zymk9/instant-ngp/tree/master/scripts" target="_blank" rel="noreferrer" class="x-inline-link">这里</a>。</p><div class="x-codeblock"><pre><code class="lang-bash">git clone --recursive https://github.com/zymk9/instant-ngp.git InstantNGPforked</code></pre></div><p class="x-p">这是Instant-NGP一个早期版本，执行下面的命令运行<code class="x-inline-highlight">build</code>过程。更多细节可以参考<a href="https://github.com/zymk9/instant-ngp" target="_blank" rel="noreferrer" class="x-inline-link">这里</a>。</p><div class="x-codeblock"><pre><code class="lang-bash">cd InstantNGPforked
cmake . -B build
cmake --build build --config RelWithDebInfo -j
</code></pre></div><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">遇到问题</h4><h4 class="x-h3">git clone 失败，报错 fatal: early EOF</h4><p class="x-p">报错：</p><div class="x-codeblock"><pre><code class="lang-none">error: xxxx bytes of body are still expected
fetch-pack: unexpected disconnect while reading sideband packet
fatal: early EOF
fatal: fetch-pack: invalid index-pack output
</code></pre></div><p class="x-p">解决：增大缓冲区(<code class="x-inline-highlight">1048576000</code>是<code class="x-inline-highlight">1G</code>)</p><div class="x-codeblock"><pre><code class="lang-bash">git config --global http.postBuffer 1048576000</code></pre></div><h4 class="x-h3">子模块没有一次性下载成功</h4><p class="x-p">解决：进入目录手动重新下载</p><div class="x-codeblock"><pre><code class="lang-bash">cd InstantNGPforked
git submodule update --init --recursive
</code></pre></div></div><h3 class="x-h2">下载数据集</h3><p class="x-p">作者提供了数据集的<a href="https://hkustconnect-my.sharepoint.com/:f:/g/personal/bhuai_connect_ust_hk/Ekjf3YC0W9BMsc-jHWXI4xEBy5s_OJBLEbebNVIprd4zMg?e=FgbN9S" target="_blank" rel="noreferrer" class="x-inline-link">OneDrive链接</a>，这里以<code class="x-inline-highlight">3D-FRONT</code>数据集作为例子，需要从作者提供的链接中下载<code class="x-inline-highlight">front3d_nerf_data.zip</code>和<code class="x-inline-highlight">front3d_rpn_data.zip</code>。</p><p class="x-p">假设数据集解压的路径为<code class="x-inline-highlight">E:\front3d_nerf_data</code>和<code class="x-inline-highlight">E:\front3d_rpn_data</code>。</p><h3 class="x-h2">可视化数据集</h3><p class="x-p">在完成上面步骤后，就可以先利用Instant-NGP的UI可视化数据集中标注的<code class="x-inline-highlight">ground truth</code>了，这里以场景<code class="x-inline-highlight">3dfront_0004_00</code>为例：</p><div class="x-codeblock"><pre><code class="lang-bash">cd InstantNGPforked
.\build\testbed --scene E:\front3d_nerf_data\3dfront_0004_00\train
</code></pre></div><p class="x-p">执行上述命令后，勾选UI<code class="x-inline-highlight">Debug visualization</code>下的<code class="x-inline-highlight">Visualize object bounding boxes</code>就可以看到如下结果：</p><div class="x-image-wrapper"><img alt="img" decoding="async" data-nimg="1" style="color:transparent;width:100%" src=""/></div><h3 class="x-h2">下载预训练的权重</h3><p class="x-p">本博客给出的示例需要在上面的OneDrive链接中下载<code class="x-inline-highlight">nerf_rpn_model_release\front3d_anchor_resnet50.pt</code>。</p><p class="x-p">假设预训练权重保存的路径为<code class="x-inline-highlight">NeRFrpn&#92;nerf_rpn\weights\front3d_anchor_resnet50.pt</code>。</p><h2 class="x-h1">生成proposals</h2><p class="x-p">接下来，利用预训练的权重，写一个<code class="x-inline-highlight">test</code>脚本生成提议框。</p><div class="x-codeblock"><pre><code class="lang-bash"># NeRFrpn\nerf_rpn\test.bat

set DATA_ROOT=E:\front3d_rpn_data
cd NeRFrpn\nerf_rpn

python -u run_rpn.py ^
    --mode &quot;eval&quot; ^
    --dataset_name front3d ^
    --resolution 160 ^
    --backbone_type resnet ^
    --features_path %DATA_ROOT%\features ^
    --boxes_path %DATA_ROOT%\obb ^
    --dataset_split %DATA_ROOT%\3dfront_split.npz ^
    --save_path .\results\front3d_test ^
    --checkpoint .\weights\front3d_anchor_resnet50.pt ^
    --rpn_nms_thresh 0.3 ^
    --normalize_density ^
    --rotated_bbox ^
    --batch_size 1 ^
    --gpus 0 ^
    --output_proposals
</code></pre></div><p class="x-p">由于我的设备显存小，所以把<code class="x-inline-highlight">batch_size</code>改为了<code class="x-inline-highlight">1</code>。原始的参数是<code class="x-inline-highlight">2</code>。</p><p class="x-p">运行后会在<code class="x-inline-highlight">NeRFrpn&#92;nerf_rpn&#92;results&#92;front3d_test</code>中得到<code class="x-inline-highlight">eval.json</code>文件和储存了<code class="x-inline-highlight">17</code>个测试场景的提议框的<code class="x-inline-highlight">proposals</code>目录。</p><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">遇到问题</h4><h4 class="x-h3">CUDA device 不匹配</h4><p class="x-p">报错：<br/>RuntimeError: Attempting to deserialize object on CUDA device 4 but torch.cuda.device_count() is 1. Please use torch.load with map_location to map your storages to an existing device.</p><p class="x-p">解决：在<code class="x-inline-highlight">run_rpn.py</code>找到下面这行代码：</p><div class="x-codeblock"><pre><code class="lang-python">checkpoint = torch.load(args.checkpoint)</code></pre></div><p class="x-p">我的设备上只有一个GPU，因此修改为：</p><div class="x-codeblock"><pre><code class="lang-python">checkpoint = torch.load(args.checkpoint, map_location={&#x27;cuda:4&#x27;:&#x27;cuda:0&#x27;})</code></pre></div></div><h2 class="x-h1">运行proposals2ngp.py</h2><p class="x-p">下一步是生成Instant-NGP所需的<code class="x-inline-highlight">transform.json</code>。</p><div class="x-codeblock"><pre><code class="lang-bash"># NeRFrpn\nerf_rpn\proposals2ngp.bat

set DATA_DIR=E:\
cd NeRFrpn\nerf_rpn

python scripts\proposals2ngp.py ^
    --bbox_format obb ^
    --dataset front3d ^
    --dataset_path %DATA_DIR%\front3d_nerf_data ^
    --features_path %DATA_DIR%\front3d_rpn_data\features ^
    --proposals_path .\results\front3d_test\proposals ^
    --output_dir .\results\proposals_to_ngp
</code></pre></div><p class="x-p">运行后会在<code class="x-inline-highlight">NeRFrpn&#92;nerf_rpn&#92;results&#92;proposals_to_ngp</code>中得到<code class="x-inline-highlight">17</code>个测试场景的<code class="x-inline-highlight">3dfront_xxxx_xx.json</code>文件。</p><p class="x-p">接下来，把文件<code class="x-inline-highlight">3dfront_0004_00.json</code>复制到路径<code class="x-inline-highlight">E:&#92;front3d_nerf_data&#92;3dfront_0004_00&#92;train</code>下，然后启动Instant-NGP的UI并指定这个新的<code class="x-inline-highlight">json</code>文件：</p><div class="x-codeblock"><pre><code class="lang-bash">cd InstantNGPforked
.\build\testbed --scene E:\front3d_nerf_data\3dfront_0004_00\train\3dfront_0004_00.json
</code></pre></div><p class="x-p">可以看到如下结果：</p><div class="x-image-wrapper"><img alt="img" decoding="async" data-nimg="1" style="color:transparent;width:100%" src=""/></div><h2 class="x-h1">文件结构参考</h2><p class="x-p">这里展示了前面我们生成、或需要用到的各个文件的路径示意。注意这并不是仓库中的全部内容，而是只展示了前面提及的文件。</p><div class="x-codeblock"><pre><code class="lang-bash">&lt;work_dir&gt;
├── InstantNGPforked
└── NeRFrpn
    └── nerf_rpn
        ├── results
            ├── front3d_test
                └── proposals
                        3dfront_0004_00.npz
                        3dfront_0019_00.npz
                        ...
                        3dfront_1006_02.npz
                        3dfront_1014_02.npz
                    eval.json
            └── proposals_to_ngp
                    3dfront_0004_00.json
                    3dfront_0019_00.json
                    ...
                    3dfront_1006_02.json
                    3dfront_1014_02.json
        ├── scripts
                proposals2ngp.py
        └── weights
                front3d_anchor_resnet50.pt
            proposals2ngp.bat
            test.bat

E:\
├── front3d_nerf_data
    ├── 3dfront_0000_00
    ├── 3dfront_0000_01
    ├── ...
    ├── 3dfront_0004_01
        ├── overview
        └── train
            └── images
                model.msgpack
                transforms.json
                3dfront_0004_00.json (copied from NeRFrpn\nerf_rpn\results\proposals_to_ngp)
    ├── ...
    ├── 3dfront_1015_02
    └── 3dfront_1015_04
└── front3d_rpn_data
</code></pre></div></div><div id="sidebar"><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">网络杂识 (4)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/database-3nf/"><span class="sidebar-list-title">数据库设计三大范式</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/github-linguist-vendored/"><span class="sidebar-list-title">不统计Github仓库某个目录下的语言</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/deepl-shortcut-setting/"><span class="sidebar-list-title">解决：DeepL该快捷键已被使用</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/git-merge-allow-unrelated-histories/"><span class="sidebar-list-title">记录：使用--allow-unrelated-histories</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">深度学习 (5)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/longtime/papers/"><span class="sidebar-list-title">论文速记</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/r2plus1d/"><span class="sidebar-list-title">行为识别R(2+1)D网络</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/object-detection-map/"><span class="sidebar-list-title">目标检测评价指标mAP</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/learn-rnn-lstm/"><span class="sidebar-list-title">学习RNN和LSTM</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/reproduce-nerf-rpn/"><span class="sidebar-list-title">记录：复现NeRF-RPN代码</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">Python学习 (2)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/torch-numpy-topk/"><span class="sidebar-list-title">在pytorch和numpy中取top-k值和索引</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/object-oriented-programming-python/"><span class="sidebar-list-title">Python面向对象编程</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">前端与JavaScript (2)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23c/js-array/"><span class="sidebar-list-title">JavaScript数组常用方法</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/css-auto-height-transition/"><span class="sidebar-list-title">CSS实现auto高度的过渡动画</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">课程 (10)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23c/pattern-recognition-1/"><span class="sidebar-list-title">【模式识别】统计决策方法</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23c/pattern-recognition-2/"><span class="sidebar-list-title">【模式识别】参数估计</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23c/pattern-recognition-3/"><span class="sidebar-list-title">【模式识别】非参数估计</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/pattern-recognition-4/"><span class="sidebar-list-title">【模式识别】线性学习器与线性分类器</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/23d/protocols/"><span class="sidebar-list-title">【计算机网络】协议总结</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/machine-learning-exercises/"><span class="sidebar-list-title">【机器学习】习题</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/games101-01-transformation/"><span class="sidebar-list-title">【GAMES101】Transformation</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/games101-02-rasterization/"><span class="sidebar-list-title">【GAMES101】Rasterization</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/games101-03-shading/"><span class="sidebar-list-title">【GAMES101】Shading</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/24a/games101-04-geometry/"><span class="sidebar-list-title">【GAMES101】Geometry</span></a></li></ul></div></div><div class="sidebar-list show-list"><div class="sidebar-list-head"><h3 class="sidebar-list-category">其他 (2)</h3><div class="sidebar-list-category-rightarrow"><svg viewBox="0 0 1024 1024" width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"><path d="M761.056 532.128c.512-.992 1.344-1.824 1.792-2.848 8.8-18.304 5.92-40.704-9.664-55.424L399.936 139.744c-19.264-18.208-49.632-17.344-67.872 1.888-18.208 19.264-17.376 49.632 1.888 67.872l316.96 299.84L335.2 813.632c-19.072 18.4-19.648 48.768-1.248 67.872 9.408 9.792 21.984 14.688 34.56 14.688 12 0 24-4.48 33.312-13.44l350.048-337.376c.672-.672.928-1.6 1.6-2.304.512-.48 1.056-.832 1.568-1.344 2.72-2.848 4.16-6.336 6.016-9.6z" fill="#50505c"></path></svg></div></div><div class="sidebar-list-ul-wrapper"><ul class="sidebar-list-ul"><li class="sidebar-list-li"><a class="sidebar-list-link" href="/longtime/demo/"><span class="sidebar-list-title">示例</span></a></li><li class="sidebar-list-li"><a class="sidebar-list-link" href="/longtime/updates/"><span class="sidebar-list-title">更新日志</span></a></li></ul></div></div></div><div id="sidebar-mask"></div></div><script src="/_next/static/chunks/webpack-18ff650738e257e6.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/8ac0b0e7f508d966.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/c84b60895b980f14.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/f70c26425a044d6b.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[3728,[],\"\"]\n7:I[9928,[],\"\"]\n8:I[9226,[\"185\",\"static/chunks/app/layout-e12e822557cc964c.js\"],\"GlobalProvider\"]\n9:I[9330,[\"185\",\"static/chunks/app/layout-e12e822557cc964c.js\"],\"\"]\na:I[6954,[],\"\"]\nb:I[7264,[],\"\"]\nc:I[5285,[\"176\",\"static/chunks/176-6509553bec92a789.js\",\"135\",\"static/chunks/app/(blogs)/layout-5b0a8ec95aac1a42.js\"],\"\"]\ne:I[4484,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bcb1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70"])</script><script>self.__next_f.push([1,"f54d6f0e.js\"],\"Title\"]\nf:I[4484,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bcb1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js\"],\"H1\"]\n10:I[4484,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bcb1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js\"],\"H2\"]\n11:I[9708,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bc"])</script><script>self.__next_f.push([1,"b1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js\"],\"\"]\n12:I[4484,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bcb1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js\"],\"H3\"]\n13:I[8411,[\"954\",\"static/chunks/d3ac728e-1e5d8b71e3d43fec.js\",\"202\",\"static/chunks/202-7b9f876bcb1bf7b4.js\",\"367\",\"static/chunks/app/(blogs)/24a/reproduce-nerf-rpn/page-f980ba70f54d6f0e.js\"],\"\"]\n14:T7b2,"])</script><script>self.__next_f.push([1,"\n                \u003cwork_dir\u003e\n                ├── InstantNGPforked\n                └── NeRFrpn\n                    └── nerf_rpn\n                        ├── results\n                            ├── front3d_test\n                                └── proposals\n                                        3dfront_0004_00.npz\n                                        3dfront_0019_00.npz\n                                        ...\n                                        3dfront_1006_02.npz\n                                        3dfront_1014_02.npz\n                                    eval.json\n                            └── proposals_to_ngp\n                                    3dfront_0004_00.json\n                                    3dfront_0019_00.json\n                                    ...\n                                    3dfront_1006_02.json\n                                    3dfront_1014_02.json\n                        ├── scripts\n                                proposals2ngp.py\n                        └── weights\n                                front3d_anchor_resnet50.pt\n                            proposals2ngp.bat\n                            test.bat\n\n                E:\\\n                ├── front3d_nerf_data\n                    ├── 3dfront_0000_00\n                    ├── 3dfront_0000_01\n                    ├── ...\n                    ├── 3dfront_0004_01\n                        ├── overview\n                        └── train\n                            └── images\n                                model.msgpack\n                                transforms.json\n                                3dfront_0004_00.json (copied from NeRFrpn\\nerf_rpn\\results\\proposals_to_ngp)\n                    ├── ...\n                    ├── 3dfront_1015_02\n                    └── 3dfront_1015_04\n                └── front3d_rpn_data\n                "])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8ac0b0e7f508d966.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"uyc5_iRvBwFlLlmfGcK6i\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/24a/reproduce-nerf-rpn/\",\"initialTree\":[\"\",{\"children\":[\"(blogs)\",{\"children\":[\"24a\",{\"children\":[\"reproduce-nerf-rpn\",{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L6\"],\"globalErrorComponent\":\"$7\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L8\",null,{\"children\":[[\"$\",\"$L9\",null,{}],[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[null,[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blogs)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blogs)\",\"children\",\"24a\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blogs)\",\"children\",\"24a\",\"children\",\"reproduce-nerf-rpn\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Ld\",[[\"$\",\"$Le\",null,{\"children\":\"$undefined\"}],[\"$\",\"$Lf\",null,{\"children\":\"说明\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"复现仓库：\u003ca href=\\\"https://github.com/lyclyc52/NeRF_RPN\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003ehttps://github.com/lyclyc52/NeRF_RPN\u003c/a\u003e\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这项研究在NeRF中引入RPN，用于3D物体检测和相关任务。作者提供了改写的Instant-NGP以供可视化3D提议框。我自己在尝试复现的时候绕了一些弯子，因此借这篇博客复盘一下当时的过程。仓库提供的脚本多为适用于linux系统的\u003ccode class=\\\"x-inline-highlight\\\"\u003e.sh\u003c/code\u003e文件，而我自己的设备是windows系统，因此示例中会给出适用于windows系统的相应指令。\"}}],[\"$\",\"$Lf\",null,{\"children\":\"环境相关\"}],[\"$\",\"$L10\",null,{\"children\":\"克隆仓库\"}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"git clone https://github.com/lyclyc52/NeRF_RPN.git NeRFrpn\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"环境配置参照\u003ca href=\\\"https://github.com/lyclyc52/NeRF_RPN\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003e官方仓库说明文档\u003c/a\u003e即可。\"}}],[\"$\",\"$L10\",null,{\"children\":\"配置Instant-NGP Fork for NeRF Feature Extraction\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"作者修改了Instant-NGP的仓库，添加了一些包括可视化bbox在内的功能。说明文档在\u003ca href=\\\"https://github.com/zymk9/instant-ngp/tree/master/scripts\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003e这里\u003c/a\u003e。\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"git clone --recursive https://github.com/zymk9/instant-ngp.git InstantNGPforked\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这是Instant-NGP一个早期版本，执行下面的命令运行\u003ccode class=\\\"x-inline-highlight\\\"\u003ebuild\u003c/code\u003e过程。更多细节可以参考\u003ca href=\\\"https://github.com/zymk9/instant-ngp\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003e这里\u003c/a\u003e。\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                cd InstantNGPforked\\n                cmake . -B build\\n                cmake --build build --config RelWithDebInfo -j\\n                \"}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[[\"$\",\"$L12\",null,{\"children\":\"遇到问题\"}],[\"$\",\"$L12\",null,{\"children\":\"git clone 失败，报错 fatal: early EOF\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错：\"}}],[\"$\",\"$L11\",null,{\"language\":\"none\",\"code\":\"\\n                    error: xxxx bytes of body are still expected\\n                    fetch-pack: unexpected disconnect while reading sideband packet\\n                    fatal: early EOF\\n                    fatal: fetch-pack: invalid index-pack output\\n                    \"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"解决：增大缓冲区(\u003ccode class=\\\"x-inline-highlight\\\"\u003e1048576000\u003c/code\u003e是\u003ccode class=\\\"x-inline-highlight\\\"\u003e1G\u003c/code\u003e)\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"git config --global http.postBuffer 1048576000\"}],[\"$\",\"$L12\",null,{\"children\":\"子模块没有一次性下载成功\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"解决：进入目录手动重新下载\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                    cd InstantNGPforked\\n                    git submodule update --init --recursive\\n                    \"}]]}],[\"$\",\"$L10\",null,{\"children\":\"下载数据集\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"作者提供了数据集的\u003ca href=\\\"https://hkustconnect-my.sharepoint.com/:f:/g/personal/bhuai_connect_ust_hk/Ekjf3YC0W9BMsc-jHWXI4xEBy5s_OJBLEbebNVIprd4zMg?e=FgbN9S\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003eOneDrive链接\u003c/a\u003e，这里以\u003ccode class=\\\"x-inline-highlight\\\"\u003e3D-FRONT\u003c/code\u003e数据集作为例子，需要从作者提供的链接中下载\u003ccode class=\\\"x-inline-highlight\\\"\u003efront3d_nerf_data.zip\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003efront3d_rpn_data.zip\u003c/code\u003e。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"假设数据集解压的路径为\u003ccode class=\\\"x-inline-highlight\\\"\u003eE:\\\\front3d_nerf_data\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003eE:\\\\front3d_rpn_data\u003c/code\u003e。\"}}],[\"$\",\"$L10\",null,{\"children\":\"可视化数据集\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"在完成上面步骤后，就可以先利用Instant-NGP的UI可视化数据集中标注的\u003ccode class=\\\"x-inline-highlight\\\"\u003eground truth\u003c/code\u003e了，这里以场景\u003ccode class=\\\"x-inline-highlight\\\"\u003e3dfront_0004_00\u003c/code\u003e为例：\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                cd InstantNGPforked\\n                .\\\\build\\\\testbed --scene E:\\\\front3d_nerf_data\\\\3dfront_0004_00\\\\train\\n                \"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"执行上述命令后，勾选UI\u003ccode class=\\\"x-inline-highlight\\\"\u003eDebug visualization\u003c/code\u003e下的\u003ccode class=\\\"x-inline-highlight\\\"\u003eVisualize object bounding boxes\u003c/code\u003e就可以看到如下结果：\"}}],[\"$\",\"$L13\",null,{\"src\":{\"default\":{\"src\":\"/_next/static/media/fig1.0188d7f3.jpg\",\"height\":1066,\"width\":2559,\"blurDataURL\":\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAMACAMBIgACEQEDEQH/xAAnAAEBAAAAAAAAAAAAAAAAAAAABgEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAAnQn/xAAZEAEBAQADAAAAAAAAAAAAAAABAwIABaH/2gAIAQEAAT8A7KtKTTW1Ez5z/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAECMv/aAAgBAgEBPwCMI//EABYRAAMAAAAAAAAAAAAAAAAAAAACMf/aAAgBAwEBPwBqf//Z\",\"blurWidth\":8,\"blurHeight\":3}},\"width\":\"100%\"}],[\"$\",\"$L10\",null,{\"children\":\"下载预训练的权重\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"本博客给出的示例需要在上面的OneDrive链接中下载\u003ccode class=\\\"x-inline-highlight\\\"\u003enerf_rpn_model_release\\\\front3d_anchor_resnet50.pt\u003c/code\u003e。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"假设预训练权重保存的路径为\u003ccode class=\\\"x-inline-highlight\\\"\u003eNeRFrpn\u0026#92;nerf_rpn\\\\weights\\\\front3d_anchor_resnet50.pt\u003c/code\u003e。\"}}],[\"$\",\"$Lf\",null,{\"children\":\"生成proposals\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"接下来，利用预训练的权重，写一个\u003ccode class=\\\"x-inline-highlight\\\"\u003etest\u003c/code\u003e脚本生成提议框。\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                # NeRFrpn\\\\nerf_rpn\\\\test.bat\\n\\n                set DATA_ROOT=E:\\\\front3d_rpn_data\\n                cd NeRFrpn\\\\nerf_rpn\\n\\n                python -u run_rpn.py ^\\n                    --mode \\\"eval\\\" ^\\n                    --dataset_name front3d ^\\n                    --resolution 160 ^\\n                    --backbone_type resnet ^\\n                    --features_path %DATA_ROOT%\\\\features ^\\n                    --boxes_path %DATA_ROOT%\\\\obb ^\\n                    --dataset_split %DATA_ROOT%\\\\3dfront_split.npz ^\\n                    --save_path .\\\\results\\\\front3d_test ^\\n                    --checkpoint .\\\\weights\\\\front3d_anchor_resnet50.pt ^\\n                    --rpn_nms_thresh 0.3 ^\\n                    --normalize_density ^\\n                    --rotated_bbox ^\\n                    --batch_size 1 ^\\n                    --gpus 0 ^\\n                    --output_proposals                \\n                \"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"由于我的设备显存小，所以把\u003ccode class=\\\"x-inline-highlight\\\"\u003ebatch_size\u003c/code\u003e改为了\u003ccode class=\\\"x-inline-highlight\\\"\u003e1\u003c/code\u003e。原始的参数是\u003ccode class=\\\"x-inline-highlight\\\"\u003e2\u003c/code\u003e。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"运行后会在\u003ccode class=\\\"x-inline-highlight\\\"\u003eNeRFrpn\u0026#92;nerf_rpn\u0026#92;results\u0026#92;front3d_test\u003c/code\u003e中得到\u003ccode class=\\\"x-inline-highlight\\\"\u003eeval.json\u003c/code\u003e文件和储存了\u003ccode class=\\\"x-inline-highlight\\\"\u003e17\u003c/code\u003e个测试场景的提议框的\u003ccode class=\\\"x-inline-highlight\\\"\u003eproposals\u003c/code\u003e目录。\"}}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[[\"$\",\"$L12\",null,{\"children\":\"遇到问题\"}],[\"$\",\"$L12\",null,{\"children\":\"CUDA device 不匹配\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错：\u003cbr/\u003eRuntimeError: Attempting to deserialize object on CUDA device 4 but torch.cuda.device_count() is 1. Please use torch.load with map_location to map your storages to an existing device.\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"解决：在\u003ccode class=\\\"x-inline-highlight\\\"\u003erun_rpn.py\u003c/code\u003e找到下面这行代码：\"}}],[\"$\",\"$L11\",null,{\"language\":\"python\",\"code\":\"checkpoint = torch.load(args.checkpoint)\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"我的设备上只有一个GPU，因此修改为：\"}}],[\"$\",\"$L11\",null,{\"language\":\"python\",\"code\":\"checkpoint = torch.load(args.checkpoint, map_location={'cuda:4':'cuda:0'})\"}]]}],[\"$\",\"$Lf\",null,{\"children\":\"运行proposals2ngp.py\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"下一步是生成Instant-NGP所需的\u003ccode class=\\\"x-inline-highlight\\\"\u003etransform.json\u003c/code\u003e。\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                # NeRFrpn\\\\nerf_rpn\\\\proposals2ngp.bat\\n\\n                set DATA_DIR=E:\\\\\\n                cd NeRFrpn\\\\nerf_rpn\\n\\n                python scripts\\\\proposals2ngp.py ^\\n                    --bbox_format obb ^\\n                    --dataset front3d ^\\n                    --dataset_path %DATA_DIR%\\\\front3d_nerf_data ^\\n                    --features_path %DATA_DIR%\\\\front3d_rpn_data\\\\features ^\\n                    --proposals_path .\\\\results\\\\front3d_test\\\\proposals ^\\n                    --output_dir .\\\\results\\\\proposals_to_ngp\\n                \"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"运行后会在\u003ccode class=\\\"x-inline-highlight\\\"\u003eNeRFrpn\u0026#92;nerf_rpn\u0026#92;results\u0026#92;proposals_to_ngp\u003c/code\u003e中得到\u003ccode class=\\\"x-inline-highlight\\\"\u003e17\u003c/code\u003e个测试场景的\u003ccode class=\\\"x-inline-highlight\\\"\u003e3dfront_xxxx_xx.json\u003c/code\u003e文件。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"接下来，把文件\u003ccode class=\\\"x-inline-highlight\\\"\u003e3dfront_0004_00.json\u003c/code\u003e复制到路径\u003ccode class=\\\"x-inline-highlight\\\"\u003eE:\u0026#92;front3d_nerf_data\u0026#92;3dfront_0004_00\u0026#92;train\u003c/code\u003e下，然后启动Instant-NGP的UI并指定这个新的\u003ccode class=\\\"x-inline-highlight\\\"\u003ejson\u003c/code\u003e文件：\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"\\n                cd InstantNGPforked\\n                .\\\\build\\\\testbed --scene E:\\\\front3d_nerf_data\\\\3dfront_0004_00\\\\train\\\\3dfront_0004_00.json\\n                \"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"可以看到如下结果：\"}}],[\"$\",\"$L13\",null,{\"src\":{\"default\":{\"src\":\"/_next/static/media/fig2.11ebdb93.jpg\",\"height\":1079,\"width\":2552,\"blurDataURL\":\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIAAMACAMBIgACEQEDEQH/xAAnAAEBAAAAAAAAAAAAAAAAAAAABQEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAAkg//xAAcEAABAwUAAAAAAAAAAAAAAAADAAECBAUSIrL/2gAIAQEAAT8AuhJkoj5yd9h9L//EABcRAAMBAAAAAAAAAAAAAAAAAAADMoH/2gAIAQIBAT8AXGn/xAAWEQADAAAAAAAAAAAAAAAAAAAAAjL/2gAIAQMBAT8Aej//2Q==\",\"blurWidth\":8,\"blurHeight\":3}},\"width\":\"100%\"}],[\"$\",\"$Lf\",null,{\"children\":\"文件结构参考\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这里展示了前面我们生成、或需要用到的各个文件的路径示意。注意这并不是仓库中的全部内容，而是只展示了前面提及的文件。\"}}],[\"$\",\"$L11\",null,{\"language\":\"bash\",\"code\":\"$14\"}]],null],\"segment\":\"__PAGE__\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f70c26425a044d6b.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],\"segment\":\"reproduce-nerf-rpn\"},\"styles\":[]}],\"segment\":\"24a\"},\"styles\":[]}],\"params\":{}}],null],\"segment\":\"(blogs)\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c84b60895b980f14.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"6:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\nd:null\n"])</script></body></html>